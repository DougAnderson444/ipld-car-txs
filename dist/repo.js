var E1=Object.create;var Rs=Object.defineProperty;var x1=Object.getOwnPropertyDescriptor;var v1=Object.getOwnPropertyNames;var _1=Object.getPrototypeOf,D1=Object.prototype.hasOwnProperty;var $=(r,e)=>()=>(r&&(e=r(r=0)),e);var b=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),H=(r,e)=>{for(var t in e)Rs(r,t,{get:e[t],enumerable:!0})},Td=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of v1(e))!D1.call(r,i)&&i!==t&&Rs(r,i,{get:()=>e[i],enumerable:!(n=x1(e,i))||n.enumerable});return r};var x=(r,e,t)=>(t=r!=null?E1(_1(r)):{},Td(e||!r||!r.__esModule?Rs(t,"default",{value:r,enumerable:!0}):t,r)),Oe=r=>Td(Rs({},"__esModule",{value:!0}),r);var Od=b(Ns=>{"use strict";a();Ns.byteLength=A1;Ns.toByteArray=C1;Ns.fromByteArray=B1;var Lt=[],et=[],S1=typeof Uint8Array<"u"?Uint8Array:Array,cu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(hn=0,Cd=cu.length;hn<Cd;++hn)Lt[hn]=cu[hn],et[cu.charCodeAt(hn)]=hn;var hn,Cd;et["-".charCodeAt(0)]=62;et["_".charCodeAt(0)]=63;function Id(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var n=t===e?0:4-t%4;return[t,n]}function A1(r){var e=Id(r),t=e[0],n=e[1];return(t+n)*3/4-n}function T1(r,e,t){return(e+t)*3/4-t}function C1(r){var e,t=Id(r),n=t[0],i=t[1],o=new S1(T1(r,n,i)),s=0,c=i>0?n-4:n,u;for(u=0;u<c;u+=4)e=et[r.charCodeAt(u)]<<18|et[r.charCodeAt(u+1)]<<12|et[r.charCodeAt(u+2)]<<6|et[r.charCodeAt(u+3)],o[s++]=e>>16&255,o[s++]=e>>8&255,o[s++]=e&255;return i===2&&(e=et[r.charCodeAt(u)]<<2|et[r.charCodeAt(u+1)]>>4,o[s++]=e&255),i===1&&(e=et[r.charCodeAt(u)]<<10|et[r.charCodeAt(u+1)]<<4|et[r.charCodeAt(u+2)]>>2,o[s++]=e>>8&255,o[s++]=e&255),o}function I1(r){return Lt[r>>18&63]+Lt[r>>12&63]+Lt[r>>6&63]+Lt[r&63]}function O1(r,e,t){for(var n,i=[],o=e;o<t;o+=3)n=(r[o]<<16&16711680)+(r[o+1]<<8&65280)+(r[o+2]&255),i.push(I1(n));return i.join("")}function B1(r){for(var e,t=r.length,n=t%3,i=[],o=16383,s=0,c=t-n;s<c;s+=o)i.push(O1(r,s,s+o>c?c:s+o));return n===1?(e=r[t-1],i.push(Lt[e>>2]+Lt[e<<4&63]+"==")):n===2&&(e=(r[t-2]<<8)+r[t-1],i.push(Lt[e>>10]+Lt[e>>4&63]+Lt[e<<2&63]+"=")),i.join("")}});var Bd=b(uu=>{a();uu.read=function(r,e,t,n,i){var o,s,c=i*8-n-1,u=(1<<c)-1,f=u>>1,l=-7,h=t?i-1:0,d=t?-1:1,w=r[e+h];for(h+=d,o=w&(1<<-l)-1,w>>=-l,l+=c;l>0;o=o*256+r[e+h],h+=d,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=n;l>0;s=s*256+r[e+h],h+=d,l-=8);if(o===0)o=1-f;else{if(o===u)return s?NaN:(w?-1:1)*(1/0);s=s+Math.pow(2,n),o=o-f}return(w?-1:1)*s*Math.pow(2,o-n)};uu.write=function(r,e,t,n,i,o){var s,c,u,f=o*8-i-1,l=(1<<f)-1,h=l>>1,d=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,w=n?0:o-1,g=n?1:-1,m=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(c=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),s+h>=1?e+=d/u:e+=d*Math.pow(2,1-h),e*u>=2&&(s++,u/=2),s+h>=l?(c=0,s=l):s+h>=1?(c=(e*u-1)*Math.pow(2,i),s=s+h):(c=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;r[t+w]=c&255,w+=g,c/=256,i-=8);for(s=s<<i|c,f+=i;f>0;r[t+w]=s&255,w+=g,s/=256,f-=8);r[t+w-g]|=m*128}});var so=b(ri=>{"use strict";a();var fu=Od(),ei=Bd(),kd=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;ri.Buffer=y;ri.SlowBuffer=F1;ri.INSPECT_MAX_BYTES=50;var Ps=2147483647;ri.kMaxLength=Ps;y.TYPED_ARRAY_SUPPORT=k1();!y.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function k1(){try{let r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch{return!1}}Object.defineProperty(y.prototype,"parent",{enumerable:!0,get:function(){if(!!y.isBuffer(this))return this.buffer}});Object.defineProperty(y.prototype,"offset",{enumerable:!0,get:function(){if(!!y.isBuffer(this))return this.byteOffset}});function Yt(r){if(r>Ps)throw new RangeError('The value "'+r+'" is invalid for option "size"');let e=new Uint8Array(r);return Object.setPrototypeOf(e,y.prototype),e}function y(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return pu(r)}return Pd(r,e,t)}y.poolSize=8192;function Pd(r,e,t){if(typeof r=="string")return R1(r,e);if(ArrayBuffer.isView(r))return N1(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(Rt(r,ArrayBuffer)||r&&Rt(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Rt(r,SharedArrayBuffer)||r&&Rt(r.buffer,SharedArrayBuffer)))return hu(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let n=r.valueOf&&r.valueOf();if(n!=null&&n!==r)return y.from(n,e,t);let i=P1(r);if(i)return i;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return y.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}y.from=function(r,e,t){return Pd(r,e,t)};Object.setPrototypeOf(y.prototype,Uint8Array.prototype);Object.setPrototypeOf(y,Uint8Array);function Fd(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function L1(r,e,t){return Fd(r),r<=0?Yt(r):e!==void 0?typeof t=="string"?Yt(r).fill(e,t):Yt(r).fill(e):Yt(r)}y.alloc=function(r,e,t){return L1(r,e,t)};function pu(r){return Fd(r),Yt(r<0?0:yu(r)|0)}y.allocUnsafe=function(r){return pu(r)};y.allocUnsafeSlow=function(r){return pu(r)};function R1(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!y.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let t=Ud(r,e)|0,n=Yt(t),i=n.write(r,e);return i!==t&&(n=n.slice(0,i)),n}function lu(r){let e=r.length<0?0:yu(r.length)|0,t=Yt(e);for(let n=0;n<e;n+=1)t[n]=r[n]&255;return t}function N1(r){if(Rt(r,Uint8Array)){let e=new Uint8Array(r);return hu(e.buffer,e.byteOffset,e.byteLength)}return lu(r)}function hu(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let n;return e===void 0&&t===void 0?n=new Uint8Array(r):t===void 0?n=new Uint8Array(r,e):n=new Uint8Array(r,e,t),Object.setPrototypeOf(n,y.prototype),n}function P1(r){if(y.isBuffer(r)){let e=yu(r.length)|0,t=Yt(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||gu(r.length)?Yt(0):lu(r);if(r.type==="Buffer"&&Array.isArray(r.data))return lu(r.data)}function yu(r){if(r>=Ps)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Ps.toString(16)+" bytes");return r|0}function F1(r){return+r!=r&&(r=0),y.alloc(+r)}y.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==y.prototype};y.compare=function(e,t){if(Rt(e,Uint8Array)&&(e=y.from(e,e.offset,e.byteLength)),Rt(t,Uint8Array)&&(t=y.from(t,t.offset,t.byteLength)),!y.isBuffer(e)||!y.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,i=t.length;for(let o=0,s=Math.min(n,i);o<s;++o)if(e[o]!==t[o]){n=e[o],i=t[o];break}return n<i?-1:i<n?1:0};y.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};y.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return y.alloc(0);let n;if(t===void 0)for(t=0,n=0;n<e.length;++n)t+=e[n].length;let i=y.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){let s=e[n];if(Rt(s,Uint8Array))o+s.length>i.length?(y.isBuffer(s)||(s=y.from(s)),s.copy(i,o)):Uint8Array.prototype.set.call(i,s,o);else if(y.isBuffer(s))s.copy(i,o);else throw new TypeError('"list" argument must be an Array of Buffers');o+=s.length}return i};function Ud(r,e){if(y.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||Rt(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);let t=r.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&t===0)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return du(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return Hd(r).length;default:if(i)return n?-1:du(r).length;e=(""+e).toLowerCase(),i=!0}}y.byteLength=Ud;function U1(r,e,t){let n=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return G1(this,e,t);case"utf8":case"utf-8":return Md(this,e,t);case"ascii":return W1(this,e,t);case"latin1":case"binary":return H1(this,e,t);case"base64":return V1(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return J1(this,e,t);default:if(n)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),n=!0}}y.prototype._isBuffer=!0;function dn(r,e,t){let n=r[e];r[e]=r[t],r[t]=n}y.prototype.swap16=function(){let e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)dn(this,t,t+1);return this};y.prototype.swap32=function(){let e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)dn(this,t,t+3),dn(this,t+1,t+2);return this};y.prototype.swap64=function(){let e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)dn(this,t,t+7),dn(this,t+1,t+6),dn(this,t+2,t+5),dn(this,t+3,t+4);return this};y.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?Md(this,0,e):U1.apply(this,arguments)};y.prototype.toLocaleString=y.prototype.toString;y.prototype.equals=function(e){if(!y.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:y.compare(this,e)===0};y.prototype.inspect=function(){let e="",t=ri.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"};kd&&(y.prototype[kd]=y.prototype.inspect);y.prototype.compare=function(e,t,n,i,o){if(Rt(e,Uint8Array)&&(e=y.from(e,e.offset,e.byteLength)),!y.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),n===void 0&&(n=e?e.length:0),i===void 0&&(i=0),o===void 0&&(o=this.length),t<0||n>e.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&t>=n)return 0;if(i>=o)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,i>>>=0,o>>>=0,this===e)return 0;let s=o-i,c=n-t,u=Math.min(s,c),f=this.slice(i,o),l=e.slice(t,n);for(let h=0;h<u;++h)if(f[h]!==l[h]){s=f[h],c=l[h];break}return s<c?-1:c<s?1:0};function $d(r,e,t,n,i){if(r.length===0)return-1;if(typeof t=="string"?(n=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,gu(t)&&(t=i?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(i)return-1;t=r.length-1}else if(t<0)if(i)t=0;else return-1;if(typeof e=="string"&&(e=y.from(e,n)),y.isBuffer(e))return e.length===0?-1:Ld(r,e,t,n,i);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):Ld(r,[e],t,n,i);throw new TypeError("val must be string, number or Buffer")}function Ld(r,e,t,n,i){let o=1,s=r.length,c=e.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(r.length<2||e.length<2)return-1;o=2,s/=2,c/=2,t/=2}function u(l,h){return o===1?l[h]:l.readUInt16BE(h*o)}let f;if(i){let l=-1;for(f=t;f<s;f++)if(u(r,f)===u(e,l===-1?0:f-l)){if(l===-1&&(l=f),f-l+1===c)return l*o}else l!==-1&&(f-=f-l),l=-1}else for(t+c>s&&(t=s-c),f=t;f>=0;f--){let l=!0;for(let h=0;h<c;h++)if(u(r,f+h)!==u(e,h)){l=!1;break}if(l)return f}return-1}y.prototype.includes=function(e,t,n){return this.indexOf(e,t,n)!==-1};y.prototype.indexOf=function(e,t,n){return $d(this,e,t,n,!0)};y.prototype.lastIndexOf=function(e,t,n){return $d(this,e,t,n,!1)};function $1(r,e,t,n){t=Number(t)||0;let i=r.length-t;n?(n=Number(n),n>i&&(n=i)):n=i;let o=e.length;n>o/2&&(n=o/2);let s;for(s=0;s<n;++s){let c=parseInt(e.substr(s*2,2),16);if(gu(c))return s;r[t+s]=c}return s}function M1(r,e,t,n){return Fs(du(e,r.length-t),r,t,n)}function j1(r,e,t,n){return Fs(Z1(e),r,t,n)}function z1(r,e,t,n){return Fs(Hd(e),r,t,n)}function q1(r,e,t,n){return Fs(ev(e,r.length-t),r,t,n)}y.prototype.write=function(e,t,n,i){if(t===void 0)i="utf8",n=this.length,t=0;else if(n===void 0&&typeof t=="string")i=t,n=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let o=this.length-t;if((n===void 0||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let s=!1;for(;;)switch(i){case"hex":return $1(this,e,t,n);case"utf8":case"utf-8":return M1(this,e,t,n);case"ascii":case"latin1":case"binary":return j1(this,e,t,n);case"base64":return z1(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q1(this,e,t,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}};y.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function V1(r,e,t){return e===0&&t===r.length?fu.fromByteArray(r):fu.fromByteArray(r.slice(e,t))}function Md(r,e,t){t=Math.min(r.length,t);let n=[],i=e;for(;i<t;){let o=r[i],s=null,c=o>239?4:o>223?3:o>191?2:1;if(i+c<=t){let u,f,l,h;switch(c){case 1:o<128&&(s=o);break;case 2:u=r[i+1],(u&192)===128&&(h=(o&31)<<6|u&63,h>127&&(s=h));break;case 3:u=r[i+1],f=r[i+2],(u&192)===128&&(f&192)===128&&(h=(o&15)<<12|(u&63)<<6|f&63,h>2047&&(h<55296||h>57343)&&(s=h));break;case 4:u=r[i+1],f=r[i+2],l=r[i+3],(u&192)===128&&(f&192)===128&&(l&192)===128&&(h=(o&15)<<18|(u&63)<<12|(f&63)<<6|l&63,h>65535&&h<1114112&&(s=h))}}s===null?(s=65533,c=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|s&1023),n.push(s),i+=c}return K1(n)}var Rd=4096;function K1(r){let e=r.length;if(e<=Rd)return String.fromCharCode.apply(String,r);let t="",n=0;for(;n<e;)t+=String.fromCharCode.apply(String,r.slice(n,n+=Rd));return t}function W1(r,e,t){let n="";t=Math.min(r.length,t);for(let i=e;i<t;++i)n+=String.fromCharCode(r[i]&127);return n}function H1(r,e,t){let n="";t=Math.min(r.length,t);for(let i=e;i<t;++i)n+=String.fromCharCode(r[i]);return n}function G1(r,e,t){let n=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>n)&&(t=n);let i="";for(let o=e;o<t;++o)i+=tv[r[o]];return i}function J1(r,e,t){let n=r.slice(e,t),i="";for(let o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+n[o+1]*256);return i}y.prototype.slice=function(e,t){let n=this.length;e=~~e,t=t===void 0?n:~~t,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),t<e&&(t=e);let i=this.subarray(e,t);return Object.setPrototypeOf(i,y.prototype),i};function le(r,e,t){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}y.prototype.readUintLE=y.prototype.readUIntLE=function(e,t,n){e=e>>>0,t=t>>>0,n||le(e,t,this.length);let i=this[e],o=1,s=0;for(;++s<t&&(o*=256);)i+=this[e+s]*o;return i};y.prototype.readUintBE=y.prototype.readUIntBE=function(e,t,n){e=e>>>0,t=t>>>0,n||le(e,t,this.length);let i=this[e+--t],o=1;for(;t>0&&(o*=256);)i+=this[e+--t]*o;return i};y.prototype.readUint8=y.prototype.readUInt8=function(e,t){return e=e>>>0,t||le(e,1,this.length),this[e]};y.prototype.readUint16LE=y.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||le(e,2,this.length),this[e]|this[e+1]<<8};y.prototype.readUint16BE=y.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||le(e,2,this.length),this[e]<<8|this[e+1]};y.prototype.readUint32LE=y.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||le(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};y.prototype.readUint32BE=y.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||le(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};y.prototype.readBigUInt64LE=vr(function(e){e=e>>>0,ti(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&oo(e,this.length-8);let i=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,o=this[++e]+this[++e]*2**8+this[++e]*2**16+n*2**24;return BigInt(i)+(BigInt(o)<<BigInt(32))});y.prototype.readBigUInt64BE=vr(function(e){e=e>>>0,ti(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&oo(e,this.length-8);let i=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],o=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n;return(BigInt(i)<<BigInt(32))+BigInt(o)});y.prototype.readIntLE=function(e,t,n){e=e>>>0,t=t>>>0,n||le(e,t,this.length);let i=this[e],o=1,s=0;for(;++s<t&&(o*=256);)i+=this[e+s]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*t)),i};y.prototype.readIntBE=function(e,t,n){e=e>>>0,t=t>>>0,n||le(e,t,this.length);let i=t,o=1,s=this[e+--i];for(;i>0&&(o*=256);)s+=this[e+--i]*o;return o*=128,s>=o&&(s-=Math.pow(2,8*t)),s};y.prototype.readInt8=function(e,t){return e=e>>>0,t||le(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};y.prototype.readInt16LE=function(e,t){e=e>>>0,t||le(e,2,this.length);let n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n};y.prototype.readInt16BE=function(e,t){e=e>>>0,t||le(e,2,this.length);let n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n};y.prototype.readInt32LE=function(e,t){return e=e>>>0,t||le(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};y.prototype.readInt32BE=function(e,t){return e=e>>>0,t||le(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};y.prototype.readBigInt64LE=vr(function(e){e=e>>>0,ti(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&oo(e,this.length-8);let i=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});y.prototype.readBigInt64BE=vr(function(e){e=e>>>0,ti(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&oo(e,this.length-8);let i=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(i)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n)});y.prototype.readFloatLE=function(e,t){return e=e>>>0,t||le(e,4,this.length),ei.read(this,e,!0,23,4)};y.prototype.readFloatBE=function(e,t){return e=e>>>0,t||le(e,4,this.length),ei.read(this,e,!1,23,4)};y.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||le(e,8,this.length),ei.read(this,e,!0,52,8)};y.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||le(e,8,this.length),ei.read(this,e,!1,52,8)};function Be(r,e,t,n,i,o){if(!y.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(t+n>r.length)throw new RangeError("Index out of range")}y.prototype.writeUintLE=y.prototype.writeUIntLE=function(e,t,n,i){if(e=+e,t=t>>>0,n=n>>>0,!i){let c=Math.pow(2,8*n)-1;Be(this,e,t,n,c,0)}let o=1,s=0;for(this[t]=e&255;++s<n&&(o*=256);)this[t+s]=e/o&255;return t+n};y.prototype.writeUintBE=y.prototype.writeUIntBE=function(e,t,n,i){if(e=+e,t=t>>>0,n=n>>>0,!i){let c=Math.pow(2,8*n)-1;Be(this,e,t,n,c,0)}let o=n-1,s=1;for(this[t+o]=e&255;--o>=0&&(s*=256);)this[t+o]=e/s&255;return t+n};y.prototype.writeUint8=y.prototype.writeUInt8=function(e,t,n){return e=+e,t=t>>>0,n||Be(this,e,t,1,255,0),this[t]=e&255,t+1};y.prototype.writeUint16LE=y.prototype.writeUInt16LE=function(e,t,n){return e=+e,t=t>>>0,n||Be(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2};y.prototype.writeUint16BE=y.prototype.writeUInt16BE=function(e,t,n){return e=+e,t=t>>>0,n||Be(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2};y.prototype.writeUint32LE=y.prototype.writeUInt32LE=function(e,t,n){return e=+e,t=t>>>0,n||Be(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4};y.prototype.writeUint32BE=y.prototype.writeUInt32BE=function(e,t,n){return e=+e,t=t>>>0,n||Be(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function jd(r,e,t,n,i){Wd(e,n,i,r,t,7);let o=Number(e&BigInt(4294967295));r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,t}function zd(r,e,t,n,i){Wd(e,n,i,r,t,7);let o=Number(e&BigInt(4294967295));r[t+7]=o,o=o>>8,r[t+6]=o,o=o>>8,r[t+5]=o,o=o>>8,r[t+4]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=s,s=s>>8,r[t+2]=s,s=s>>8,r[t+1]=s,s=s>>8,r[t]=s,t+8}y.prototype.writeBigUInt64LE=vr(function(e,t=0){return jd(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});y.prototype.writeBigUInt64BE=vr(function(e,t=0){return zd(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});y.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t=t>>>0,!i){let u=Math.pow(2,8*n-1);Be(this,e,t,n,u-1,-u)}let o=0,s=1,c=0;for(this[t]=e&255;++o<n&&(s*=256);)e<0&&c===0&&this[t+o-1]!==0&&(c=1),this[t+o]=(e/s>>0)-c&255;return t+n};y.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t=t>>>0,!i){let u=Math.pow(2,8*n-1);Be(this,e,t,n,u-1,-u)}let o=n-1,s=1,c=0;for(this[t+o]=e&255;--o>=0&&(s*=256);)e<0&&c===0&&this[t+o+1]!==0&&(c=1),this[t+o]=(e/s>>0)-c&255;return t+n};y.prototype.writeInt8=function(e,t,n){return e=+e,t=t>>>0,n||Be(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1};y.prototype.writeInt16LE=function(e,t,n){return e=+e,t=t>>>0,n||Be(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2};y.prototype.writeInt16BE=function(e,t,n){return e=+e,t=t>>>0,n||Be(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2};y.prototype.writeInt32LE=function(e,t,n){return e=+e,t=t>>>0,n||Be(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4};y.prototype.writeInt32BE=function(e,t,n){return e=+e,t=t>>>0,n||Be(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};y.prototype.writeBigInt64LE=vr(function(e,t=0){return jd(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});y.prototype.writeBigInt64BE=vr(function(e,t=0){return zd(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function qd(r,e,t,n,i,o){if(t+n>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function Vd(r,e,t,n,i){return e=+e,t=t>>>0,i||qd(r,e,t,4,34028234663852886e22,-34028234663852886e22),ei.write(r,e,t,n,23,4),t+4}y.prototype.writeFloatLE=function(e,t,n){return Vd(this,e,t,!0,n)};y.prototype.writeFloatBE=function(e,t,n){return Vd(this,e,t,!1,n)};function Kd(r,e,t,n,i){return e=+e,t=t>>>0,i||qd(r,e,t,8,17976931348623157e292,-17976931348623157e292),ei.write(r,e,t,n,52,8),t+8}y.prototype.writeDoubleLE=function(e,t,n){return Kd(this,e,t,!0,n)};y.prototype.writeDoubleBE=function(e,t,n){return Kd(this,e,t,!1,n)};y.prototype.copy=function(e,t,n,i){if(!y.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);let o=i-n;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),t),o};y.prototype.fill=function(e,t,n,i){if(typeof e=="string"){if(typeof t=="string"?(i=t,t=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!y.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(e.length===1){let s=e.charCodeAt(0);(i==="utf8"&&s<128||i==="latin1")&&(e=s)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t=t>>>0,n=n===void 0?this.length:n>>>0,e||(e=0);let o;if(typeof e=="number")for(o=t;o<n;++o)this[o]=e;else{let s=y.isBuffer(e)?e:y.from(e,i),c=s.length;if(c===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-t;++o)this[o+t]=s[o%c]}return this};var Zn={};function mu(r,e,t){Zn[r]=class extends t{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}mu("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);mu("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError);mu("ERR_OUT_OF_RANGE",function(r,e,t){let n=`The value of "${r}" is out of range.`,i=t;return Number.isInteger(t)&&Math.abs(t)>2**32?i=Nd(String(t)):typeof t=="bigint"&&(i=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(i=Nd(i)),i+="n"),n+=` It must be ${e}. Received ${i}`,n},RangeError);function Nd(r){let e="",t=r.length,n=r[0]==="-"?1:0;for(;t>=n+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function Q1(r,e,t){ti(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&oo(e,r.length-(t+1))}function Wd(r,e,t,n,i,o){if(r>t||r<e){let s=typeof e=="bigint"?"n":"",c;throw o>3?e===0||e===BigInt(0)?c=`>= 0${s} and < 2${s} ** ${(o+1)*8}${s}`:c=`>= -(2${s} ** ${(o+1)*8-1}${s}) and < 2 ** ${(o+1)*8-1}${s}`:c=`>= ${e}${s} and <= ${t}${s}`,new Zn.ERR_OUT_OF_RANGE("value",c,r)}Q1(n,i,o)}function ti(r,e){if(typeof r!="number")throw new Zn.ERR_INVALID_ARG_TYPE(e,"number",r)}function oo(r,e,t){throw Math.floor(r)!==r?(ti(r,t),new Zn.ERR_OUT_OF_RANGE(t||"offset","an integer",r)):e<0?new Zn.ERR_BUFFER_OUT_OF_BOUNDS:new Zn.ERR_OUT_OF_RANGE(t||"offset",`>= ${t?1:0} and <= ${e}`,r)}var Y1=/[^+/0-9A-Za-z-_]/g;function X1(r){if(r=r.split("=")[0],r=r.trim().replace(Y1,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function du(r,e){e=e||1/0;let t,n=r.length,i=null,o=[];for(let s=0;s<n;++s){if(t=r.charCodeAt(s),t>55295&&t<57344){if(!i){if(t>56319){(e-=3)>-1&&o.push(239,191,189);continue}else if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=t;continue}if(t<56320){(e-=3)>-1&&o.push(239,191,189),i=t;continue}t=(i-55296<<10|t-56320)+65536}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,t<128){if((e-=1)<0)break;o.push(t)}else if(t<2048){if((e-=2)<0)break;o.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;o.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;o.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return o}function Z1(r){let e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function ev(r,e){let t,n,i,o=[];for(let s=0;s<r.length&&!((e-=2)<0);++s)t=r.charCodeAt(s),n=t>>8,i=t%256,o.push(i),o.push(n);return o}function Hd(r){return fu.toByteArray(X1(r))}function Fs(r,e,t,n){let i;for(i=0;i<n&&!(i+t>=e.length||i>=r.length);++i)e[i+t]=r[i];return i}function Rt(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function gu(r){return r!==r}var tv=function(){let r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){let n=t*16;for(let i=0;i<16;++i)e[n+i]=r[t]+r[i]}return e}();function vr(r){return typeof BigInt>"u"?rv:r}function rv(){throw new Error("BigInt not supported")}});var Xd=b((PT,Yd)=>{a();var te=Yd.exports={},Nt,Pt;function wu(){throw new Error("setTimeout has not been defined")}function bu(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Nt=setTimeout:Nt=wu}catch{Nt=wu}try{typeof clearTimeout=="function"?Pt=clearTimeout:Pt=bu}catch{Pt=bu}})();function Gd(r){if(Nt===setTimeout)return setTimeout(r,0);if((Nt===wu||!Nt)&&setTimeout)return Nt=setTimeout,setTimeout(r,0);try{return Nt(r,0)}catch{try{return Nt.call(null,r,0)}catch{return Nt.call(this,r,0)}}}function nv(r){if(Pt===clearTimeout)return clearTimeout(r);if((Pt===bu||!Pt)&&clearTimeout)return Pt=clearTimeout,clearTimeout(r);try{return Pt(r)}catch{try{return Pt.call(null,r)}catch{return Pt.call(this,r)}}}var Xt=[],ni=!1,pn,Us=-1;function iv(){!ni||!pn||(ni=!1,pn.length?Xt=pn.concat(Xt):Us=-1,Xt.length&&Jd())}function Jd(){if(!ni){var r=Gd(iv);ni=!0;for(var e=Xt.length;e;){for(pn=Xt,Xt=[];++Us<e;)pn&&pn[Us].run();Us=-1,e=Xt.length}pn=null,ni=!1,nv(r)}}te.nextTick=function(r){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];Xt.push(new Qd(r,e)),Xt.length===1&&!ni&&Gd(Jd)};function Qd(r,e){this.fun=r,this.array=e}Qd.prototype.run=function(){this.fun.apply(null,this.array)};te.title="browser";te.browser=!0;te.env={};te.argv=[];te.version="";te.versions={};function Zt(){}te.on=Zt;te.addListener=Zt;te.once=Zt;te.off=Zt;te.removeListener=Zt;te.removeAllListeners=Zt;te.emit=Zt;te.prependListener=Zt;te.prependOnceListener=Zt;te.listeners=function(r){return[]};te.binding=function(r){throw new Error("process.binding is not supported")};te.cwd=function(){return"/"};te.chdir=function(r){throw new Error("process.chdir is not supported")};te.umask=function(){return 0}});var Buffer,process,global,self,a=$(()=>{"use strict";Buffer=so().Buffer,process=Xd(),global=typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:{},self=globalThis;globalThis&&globalThis.process&&globalThis.process.env&&(globalThis.process.env.LIBP2P_FORCE_PNET=!1)});var ep=b((jT,Zd)=>{a();var ii=1e3,oi=ii*60,si=oi*60,yn=si*24,sv=yn*7,av=yn*365.25;Zd.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return cv(r);if(t==="number"&&isFinite(r))return e.long?fv(r):uv(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function cv(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(!!e){var t=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*av;case"weeks":case"week":case"w":return t*sv;case"days":case"day":case"d":return t*yn;case"hours":case"hour":case"hrs":case"hr":case"h":return t*si;case"minutes":case"minute":case"mins":case"min":case"m":return t*oi;case"seconds":case"second":case"secs":case"sec":case"s":return t*ii;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function uv(r){var e=Math.abs(r);return e>=yn?Math.round(r/yn)+"d":e>=si?Math.round(r/si)+"h":e>=oi?Math.round(r/oi)+"m":e>=ii?Math.round(r/ii)+"s":r+"ms"}function fv(r){var e=Math.abs(r);return e>=yn?$s(r,e,yn,"day"):e>=si?$s(r,e,si,"hour"):e>=oi?$s(r,e,oi,"minute"):e>=ii?$s(r,e,ii,"second"):r+" ms"}function $s(r,e,t,n){var i=e>=t*1.5;return Math.round(r/t)+" "+n+(i?"s":"")}});var rp=b((qT,tp)=>{a();function lv(r){t.debug=t,t.default=t,t.coerce=u,t.disable=o,t.enable=i,t.enabled=s,t.humanize=ep(),t.destroy=f,Object.keys(r).forEach(l=>{t[l]=r[l]}),t.names=[],t.skips=[],t.formatters={};function e(l){let h=0;for(let d=0;d<l.length;d++)h=(h<<5)-h+l.charCodeAt(d),h|=0;return t.colors[Math.abs(h)%t.colors.length]}t.selectColor=e;function t(l){let h,d=null,w,g;function m(...I){if(!m.enabled)return;let U=m,ee=Number(new Date),Ye=ee-(h||ee);U.diff=Ye,U.prev=h,U.curr=ee,h=ee,I[0]=t.coerce(I[0]),typeof I[0]!="string"&&I.unshift("%O");let me=0;I[0]=I[0].replace(/%([a-zA-Z%])/g,(Xe,$e)=>{if(Xe==="%%")return"%";me++;let Ze=t.formatters[$e];if(typeof Ze=="function"){let Xn=I[me];Xe=Ze.call(U,Xn),I.splice(me,1),me--}return Xe}),t.formatArgs.call(U,I),(U.log||t.log).apply(U,I)}return m.namespace=l,m.useColors=t.useColors(),m.color=t.selectColor(l),m.extend=n,m.destroy=t.destroy,Object.defineProperty(m,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(w!==t.namespaces&&(w=t.namespaces,g=t.enabled(l)),g),set:I=>{d=I}}),typeof t.init=="function"&&t.init(m),m}function n(l,h){let d=t(this.namespace+(typeof h>"u"?":":h)+l);return d.log=this.log,d}function i(l){t.save(l),t.namespaces=l,t.names=[],t.skips=[];let h,d=(typeof l=="string"?l:"").split(/[\s,]+/),w=d.length;for(h=0;h<w;h++)!d[h]||(l=d[h].replace(/\*/g,".*?"),l[0]==="-"?t.skips.push(new RegExp("^"+l.slice(1)+"$")):t.names.push(new RegExp("^"+l+"$")))}function o(){let l=[...t.names.map(c),...t.skips.map(c).map(h=>"-"+h)].join(",");return t.enable(""),l}function s(l){if(l[l.length-1]==="*")return!0;let h,d;for(h=0,d=t.skips.length;h<d;h++)if(t.skips[h].test(l))return!1;for(h=0,d=t.names.length;h<d;h++)if(t.names[h].test(l))return!0;return!1}function c(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}function u(l){return l instanceof Error?l.stack||l.message:l}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}tp.exports=lv});var tt=b((Me,Ms)=>{a();Me.formatArgs=dv;Me.save=pv;Me.load=yv;Me.useColors=hv;Me.storage=mv();Me.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();Me.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function hv(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function dv(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+Ms.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,n=0;r[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(t++,i==="%c"&&(n=t))}),r.splice(n,0,e)}Me.log=console.debug||console.log||(()=>{});function pv(r){try{r?Me.storage.setItem("debug",r):Me.storage.removeItem("debug")}catch{}}function yv(){let r;try{r=Me.storage.getItem("debug")}catch{}return!r&&typeof process<"u"&&"env"in process&&(r=process.env.DEBUG),r}function mv(){try{return localStorage}catch{}}Ms.exports=rp()(Me);var{formatters:gv}=Ms.exports;gv.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var Se=b((WT,ip)=>{"use strict";a();function np(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function wv(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return np(r,t)}catch{t.message=r.message,t.stack=r.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(r)),np(new i,t)}}ip.exports=wv});function ap(r,e,t){e=e||[],t=t||0;for(var n=t;r>=vv;)e[t++]=r&255|op,r/=128;for(;r&xv;)e[t++]=r&255|op,r>>>=7;return e[t]=r|0,ap.bytes=t-n+1,e}function Eu(r,n){var t=0,n=n||0,i=0,o=n,s,c=r.length;do{if(o>=c)throw Eu.bytes=0,new RangeError("Could not decode varint");s=r[o++],t+=i<28?(s&sp)<<i:(s&sp)*Math.pow(2,i),i+=7}while(s>=Dv);return Eu.bytes=o-n,t}var bv,op,Ev,xv,vv,_v,Dv,sp,Sv,Av,Tv,Cv,Iv,Ov,Bv,kv,Lv,Rv,Nv,Pv,co,cp=$(()=>{a();bv=ap,op=128,Ev=127,xv=~Ev,vv=Math.pow(2,31);_v=Eu,Dv=128,sp=127;Sv=Math.pow(2,7),Av=Math.pow(2,14),Tv=Math.pow(2,21),Cv=Math.pow(2,28),Iv=Math.pow(2,35),Ov=Math.pow(2,42),Bv=Math.pow(2,49),kv=Math.pow(2,56),Lv=Math.pow(2,63),Rv=function(r){return r<Sv?1:r<Av?2:r<Tv?3:r<Cv?4:r<Iv?5:r<Ov?6:r<Bv?7:r<kv?8:r<Lv?9:10},Nv={encode:bv,decode:_v,encodingLength:Rv},Pv=Nv,co=Pv});var uo,ai,ci,zs=$(()=>{a();cp();uo=(r,e=0)=>[co.decode(r,e),co.decode.bytes],ai=(r,e,t=0)=>(co.encode(r,e,t),e),ci=r=>co.encodingLength(r)});var mn={};H(mn,{coerce:()=>rt,empty:()=>up,equals:()=>xu,fromHex:()=>Uv,fromString:()=>vu,isBinary:()=>$v,toHex:()=>Fv,toString:()=>_u});var up,Fv,Uv,xu,rt,$v,vu,_u,_r=$(()=>{a();up=new Uint8Array(0),Fv=r=>r.reduce((e,t)=>e+t.toString(16).padStart(2,"0"),""),Uv=r=>{let e=r.match(/../g);return e?new Uint8Array(e.map(t=>parseInt(t,16))):up},xu=(r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0},rt=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},$v=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),vu=r=>new TextEncoder().encode(r),_u=r=>new TextDecoder().decode(r)});var Ae={};H(Ae,{Digest:()=>gn,create:()=>Dr,decode:()=>re,equals:()=>Du});var Dr,re,Du,gn,Te=$(()=>{a();_r();zs();Dr=(r,e)=>{let t=e.byteLength,n=ci(r),i=n+ci(t),o=new Uint8Array(i+t);return ai(r,o,0),ai(t,o,n),o.set(e,i),new gn(r,t,e,o)},re=r=>{let e=rt(r),[t,n]=uo(e),[i,o]=uo(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new gn(t,i,s,e)},Du=(r,e)=>r===e?!0:r.code===e.code&&r.size===e.size&&xu(r.bytes,e.bytes),gn=class{constructor(e,t,n,i){this.code=e,this.size=t,this.digest=n,this.bytes=i}}});function Mv(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var i=0;i<r.length;i++){var o=r.charAt(i),s=o.charCodeAt(0);if(t[s]!==255)throw new TypeError(o+" is ambiguous");t[s]=i}var c=r.length,u=r.charAt(0),f=Math.log(c)/Math.log(256),l=Math.log(256)/Math.log(c);function h(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var m=0,I=0,U=0,ee=g.length;U!==ee&&g[U]===0;)U++,m++;for(var Ye=(ee-U)*l+1>>>0,me=new Uint8Array(Ye);U!==ee;){for(var yt=g[U],Xe=0,$e=Ye-1;(yt!==0||Xe<I)&&$e!==-1;$e--,Xe++)yt+=256*me[$e]>>>0,me[$e]=yt%c>>>0,yt=yt/c>>>0;if(yt!==0)throw new Error("Non-zero carry");I=Xe,U++}for(var Ze=Ye-I;Ze!==Ye&&me[Ze]===0;)Ze++;for(var Xn=u.repeat(m);Ze<Ye;++Ze)Xn+=r.charAt(me[Ze]);return Xn}function d(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var m=0;if(g[m]!==" "){for(var I=0,U=0;g[m]===u;)I++,m++;for(var ee=(g.length-m)*f+1>>>0,Ye=new Uint8Array(ee);g[m];){var me=t[g.charCodeAt(m)];if(me===255)return;for(var yt=0,Xe=ee-1;(me!==0||yt<U)&&Xe!==-1;Xe--,yt++)me+=c*Ye[Xe]>>>0,Ye[Xe]=me%256>>>0,me=me/256>>>0;if(me!==0)throw new Error("Non-zero carry");U=yt,m++}if(g[m]!==" "){for(var $e=ee-U;$e!==ee&&Ye[$e]===0;)$e++;for(var Ze=new Uint8Array(I+(ee-$e)),Xn=I;$e!==ee;)Ze[Xn++]=Ye[$e++];return Ze}}}function w(g){var m=d(g);if(m)return m;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:d,decode:w}}var jv,zv,fp,lp=$(()=>{a();jv=Mv,zv=jv,fp=zv});var Su,Au,Tu,hp,Cu,ui,Sr,qv,Vv,X,mt=$(()=>{a();lp();_r();Su=class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Au=class{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return hp(this,e)}},Tu=class{constructor(e){this.decoders=e}or(e){return hp(this,e)}decode(e){let t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},hp=(r,e)=>new Tu({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}}),Cu=class{constructor(e,t,n,i){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=i,this.encoder=new Su(e,t,n),this.decoder=new Au(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},ui=({name:r,prefix:e,encode:t,decode:n})=>new Cu(r,e,t,n),Sr=({prefix:r,name:e,alphabet:t})=>{let{encode:n,decode:i}=fp(t,e);return ui({prefix:r,name:e,encode:n,decode:o=>rt(i(o))})},qv=(r,e,t,n)=>{let i={};for(let l=0;l<e.length;++l)i[e[l]]=l;let o=r.length;for(;r[o-1]==="=";)--o;let s=new Uint8Array(o*t/8|0),c=0,u=0,f=0;for(let l=0;l<o;++l){let h=i[r[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);u=u<<t|h,c+=t,c>=8&&(c-=8,s[f++]=255&u>>c)}if(c>=t||255&u<<8-c)throw new SyntaxError("Unexpected end of data");return s},Vv=(r,e,t)=>{let n=e[e.length-1]==="=",i=(1<<t)-1,o="",s=0,c=0;for(let u=0;u<r.length;++u)for(c=c<<8|r[u],s+=8;s>t;)s-=t,o+=e[i&c>>s];if(s&&(o+=e[i&c<<t-s]),n)for(;o.length*t&7;)o+="=";return o},X=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>ui({prefix:e,name:r,encode(i){return Vv(i,n,t)},decode(i){return qv(i,n,t,r)}})});var fo={};H(fo,{base58btc:()=>z,base58flickr:()=>Kv});var z,Kv,ke=$(()=>{a();mt();z=Sr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Kv=Sr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var qs={};H(qs,{base32:()=>k,base32hex:()=>Gv,base32hexpad:()=>Qv,base32hexpadupper:()=>Yv,base32hexupper:()=>Jv,base32pad:()=>Iu,base32padupper:()=>Hv,base32upper:()=>Wv,base32z:()=>Xv});var k,Wv,Iu,Hv,Gv,Jv,Qv,Yv,Xv,Ce=$(()=>{a();mt();k=X({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Wv=X({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Iu=X({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Hv=X({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Gv=X({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Jv=X({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Qv=X({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Yv=X({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Xv=X({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var Ou={};H(Ou,{CID:()=>E});var E,Zv,e2,t2,lo,r2,dp,pp,Vs,Ks,n2,i2,o2,V=$(()=>{a();zs();Te();ke();Ce();_r();E=class{constructor(e,t,n,i){this.code=t,this.version=e,this.multihash=n,this.bytes=i,this.byteOffset=i.byteOffset,this.byteLength=i.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:Ks,byteLength:Ks,code:Vs,version:Vs,multihash:Vs,bytes:Vs,_baseCache:Ks,asCID:Ks})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:t}=this;if(e!==lo)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==r2)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return E.createV0(t)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,n=Dr(e,t);return E.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&Du(this.multihash,e.multihash)}toString(e){let{bytes:t,version:n,_baseCache:i}=this;switch(n){case 0:return e2(t,i,e||z.encoder);default:return t2(t,i,e||k.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return i2(/^0\.0/,o2),!!(e&&(e[pp]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof E)return e;if(e!=null&&e.asCID===e){let{version:t,code:n,multihash:i,bytes:o}=e;return new E(t,n,i,o||dp(t,n,i.bytes))}else if(e!=null&&e[pp]===!0){let{version:t,multihash:n,code:i}=e,o=re(n);return E.create(t,i,o)}else return null}static create(e,t,n){if(typeof t!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(t!==lo)throw new Error(`Version 0 CID must use dag-pb (code: ${lo}) block encoding`);return new E(e,t,n,n.bytes)}case 1:{let i=dp(e,t,n.bytes);return new E(e,t,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return E.create(0,lo,e)}static createV1(e,t){return E.create(1,e,t)}static decode(e){let[t,n]=E.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=E.inspectBytes(e),n=t.size-t.multihashSize,i=rt(e.subarray(n,n+t.multihashSize));if(i.byteLength!==t.multihashSize)throw new Error("Incorrect length");let o=i.subarray(t.multihashSize-t.digestSize),s=new gn(t.multihashCode,t.digestSize,o,i);return[t.version===0?E.createV0(s):E.createV1(t.codec,s),e.subarray(t.size)]}static inspectBytes(e){let t=0,n=()=>{let[h,d]=uo(e.subarray(t));return t+=d,h},i=n(),o=lo;if(i===18?(i=0,t=0):i===1&&(o=n()),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=t,c=n(),u=n(),f=t+u,l=f-s;return{version:i,codec:o,multihashCode:c,digestSize:u,multihashSize:l,size:f}}static parse(e,t){let[n,i]=Zv(e,t),o=E.decode(i);return o._baseCache.set(n,e),o}},Zv=(r,e)=>{switch(r[0]){case"Q":{let t=e||z;return[z.prefix,t.decode(`${z.prefix}${r}`)]}case z.prefix:{let t=e||z;return[z.prefix,t.decode(r)]}case k.prefix:{let t=e||k;return[k.prefix,t.decode(r)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}}},e2=(r,e,t)=>{let{prefix:n}=t;if(n!==z.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);let i=e.get(n);if(i==null){let o=t.encode(r).slice(1);return e.set(n,o),o}else return i},t2=(r,e,t)=>{let{prefix:n}=t,i=e.get(n);if(i==null){let o=t.encode(r);return e.set(n,o),o}else return i},lo=112,r2=18,dp=(r,e,t)=>{let n=ci(r),i=n+ci(e),o=new Uint8Array(i+t.byteLength);return ai(r,o,0),ai(e,o,n),o.set(t,i),o},pp=Symbol.for("@ipld/js-cid/CID"),Vs={writable:!1,configurable:!1,enumerable:!0},Ks={writable:!1,enumerable:!1,configurable:!1},n2="0.0.0-dev",i2=(r,e)=>{if(r.test(n2))console.warn(e);else throw new Error(e)},o2=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});var Bu={};H(Bu,{identity:()=>s2});var s2,yp=$(()=>{a();mt();_r();s2=ui({prefix:"\0",name:"identity",encode:r=>_u(r),decode:r=>vu(r)})});var ku={};H(ku,{base2:()=>a2});var a2,mp=$(()=>{a();mt();a2=X({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var Lu={};H(Lu,{base8:()=>c2});var c2,gp=$(()=>{a();mt();c2=X({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var Ru={};H(Ru,{base10:()=>u2});var u2,wp=$(()=>{a();mt();u2=Sr({prefix:"9",name:"base10",alphabet:"0123456789"})});var Nu={};H(Nu,{base16:()=>f2,base16upper:()=>l2});var f2,l2,bp=$(()=>{a();mt();f2=X({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),l2=X({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var Pu={};H(Pu,{base36:()=>h2,base36upper:()=>d2});var h2,d2,Ep=$(()=>{a();mt();h2=Sr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),d2=Sr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var Fu={};H(Fu,{base64:()=>ho,base64pad:()=>p2,base64url:()=>Ws,base64urlpad:()=>y2});var ho,p2,Ws,y2,po=$(()=>{a();mt();ho=X({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),p2=X({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ws=X({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),y2=X({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});var Uu={};H(Uu,{base256emoji:()=>E2});function w2(r){return r.reduce((e,t)=>(e+=m2[t],e),"")}function b2(r){let e=[];for(let t of r){let n=g2[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}var xp,m2,g2,E2,vp=$(()=>{a();mt();xp=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),m2=xp.reduce((r,e,t)=>(r[t]=e,r),[]),g2=xp.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);E2=ui({prefix:"\u{1F680}",name:"base256emoji",encode:w2,decode:b2})});var Mu,$u,ju=$(()=>{a();Te();Mu=({name:r,code:e,encode:t})=>new $u(r,e,t),$u=class{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?Dr(this.code,t):t.then(n=>Dr(this.code,n))}else throw Error("Unknown type, must be binary type")}}});var zu={};H(zu,{sha256:()=>Ft,sha512:()=>x2});var Dp,Ft,x2,fi=$(()=>{a();ju();Dp=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),Ft=Mu({name:"sha2-256",code:18,encode:Dp("SHA-256")}),x2=Mu({name:"sha2-512",code:19,encode:Dp("SHA-512")})});var qu={};H(qu,{identity:()=>li});var Sp,v2,Ap,_2,li,Hs=$(()=>{a();_r();Te();Sp=0,v2="identity",Ap=rt,_2=r=>Dr(Sp,Ap(r)),li={code:Sp,name:v2,encode:Ap,digest:_2}});var gt={};H(gt,{code:()=>er,decode:()=>S2,encode:()=>D2,name:()=>Tp});var Tp,er,D2,S2,Ar=$(()=>{a();_r();Tp="raw",er=85,D2=r=>rt(r),S2=r=>rt(r)});var Gs={};H(Gs,{code:()=>Vu,decode:()=>O2,encode:()=>I2,name:()=>C2});var A2,T2,C2,Vu,I2,O2,Ku=$(()=>{a();A2=new TextEncoder,T2=new TextDecoder,C2="json",Vu=512,I2=r=>A2.encode(JSON.stringify(r)),O2=r=>JSON.parse(T2.decode(r))});var hi=$(()=>{a();V();zs();_r();ju();Te()});var wn,Cp,Ip,yo=$(()=>{a();yp();mp();gp();wp();bp();Ce();Ep();ke();po();vp();fi();Hs();Ar();Ku();hi();wn={...Bu,...ku,...Lu,...Ru,...Nu,...qs,...Pu,...fo,...Fu,...Uu},Cp={...zu,...qu},Ip={raw:gt,json:Gs}});function Js(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}var Wu=$(()=>{a()});function Bp(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}var Op,Hu,B2,Qs,Gu=$(()=>{a();yo();Wu();Op=Bp("utf8","u",r=>{let e=new TextDecoder("utf8");return"u"+e.decode(r)},r=>new TextEncoder().encode(r.substring(1))),Hu=Bp("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);let e=Js(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),B2={utf8:Op,"utf-8":Op,hex:wn.base16,latin1:Hu,ascii:Hu,binary:Hu,...wn},Qs=B2});var mo={};H(mo,{toString:()=>A});function A(r,e="utf8"){let t=Qs[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}var W=$(()=>{a();Gu()});var kp={};H(kp,{fromString:()=>N});function N(r,e="utf8"){let t=Qs[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}var ge=$(()=>{a();Gu()});var Ju=b((dI,Rp)=>{"use strict";a();var N2=async r=>{let e=0;for await(let t of r)e++;return e};Rp.exports=N2});var Xy=b((J6,Yy)=>{"use strict";a();Yy.exports=D8;function D8(r,e){for(var t=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)t[n++]=arguments[i++];return new Promise(function(c,u){t[n]=function(l){if(o)if(o=!1,l)u(l);else{for(var h=new Array(arguments.length-1),d=0;d<h.length;)h[d++]=arguments[d];c.apply(null,h)}};try{r.apply(e||null,t)}catch(f){o&&(o=!1,u(f))}})}});var rm=b(tm=>{"use strict";a();var fa=tm;fa.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&e.charAt(t)==="=";)++n;return Math.ceil(e.length*3)/4-n};var Ei=new Array(64),em=new Array(123);for(xt=0;xt<64;)em[Ei[xt]=xt<26?xt+65:xt<52?xt+71:xt<62?xt-4:xt-59|43]=xt++;var xt;fa.encode=function(e,t,n){for(var i=null,o=[],s=0,c=0,u;t<n;){var f=e[t++];switch(c){case 0:o[s++]=Ei[f>>2],u=(f&3)<<4,c=1;break;case 1:o[s++]=Ei[u|f>>4],u=(f&15)<<2,c=2;break;case 2:o[s++]=Ei[u|f>>6],o[s++]=Ei[f&63],c=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0)}return c&&(o[s++]=Ei[u],o[s++]=61,c===1&&(o[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))};var Zy="invalid encoding";fa.decode=function(e,t,n){for(var i=n,o=0,s,c=0;c<e.length;){var u=e.charCodeAt(c++);if(u===61&&o>1)break;if((u=em[u])===void 0)throw Error(Zy);switch(o){case 0:s=u,o=1;break;case 1:t[n++]=s<<2|(u&48)>>4,s=u,o=2;break;case 2:t[n++]=(s&15)<<4|(u&60)>>2,s=u,o=3;break;case 3:t[n++]=(s&3)<<6|u,o=0;break}}if(o===1)throw Error(Zy);return n-i};fa.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var im=b((Z6,nm)=>{"use strict";a();nm.exports=la;function la(){this._listeners={}}la.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this};la.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===t?n.splice(i,1):++i;return this};la.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,n)}return this}});var lm=b((t4,fm)=>{"use strict";a();fm.exports=om(om);function om(r){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),n=t[3]===128;function i(u,f,l){e[0]=u,f[l]=t[0],f[l+1]=t[1],f[l+2]=t[2],f[l+3]=t[3]}function o(u,f,l){e[0]=u,f[l]=t[3],f[l+1]=t[2],f[l+2]=t[1],f[l+3]=t[0]}r.writeFloatLE=n?i:o,r.writeFloatBE=n?o:i;function s(u,f){return t[0]=u[f],t[1]=u[f+1],t[2]=u[f+2],t[3]=u[f+3],e[0]}function c(u,f){return t[3]=u[f],t[2]=u[f+1],t[1]=u[f+2],t[0]=u[f+3],e[0]}r.readFloatLE=n?s:c,r.readFloatBE=n?c:s}():function(){function e(n,i,o,s){var c=i<0?1:0;if(c&&(i=-i),i===0)n(1/i>0?0:2147483648,o,s);else if(isNaN(i))n(2143289344,o,s);else if(i>34028234663852886e22)n((c<<31|2139095040)>>>0,o,s);else if(i<11754943508222875e-54)n((c<<31|Math.round(i/1401298464324817e-60))>>>0,o,s);else{var u=Math.floor(Math.log(i)/Math.LN2),f=Math.round(i*Math.pow(2,-u)*8388608)&8388607;n((c<<31|u+127<<23|f)>>>0,o,s)}}r.writeFloatLE=e.bind(null,sm),r.writeFloatBE=e.bind(null,am);function t(n,i,o){var s=n(i,o),c=(s>>31)*2+1,u=s>>>23&255,f=s&8388607;return u===255?f?NaN:c*(1/0):u===0?c*1401298464324817e-60*f:c*Math.pow(2,u-150)*(f+8388608)}r.readFloatLE=t.bind(null,cm),r.readFloatBE=t.bind(null,um)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),n=t[7]===128;function i(u,f,l){e[0]=u,f[l]=t[0],f[l+1]=t[1],f[l+2]=t[2],f[l+3]=t[3],f[l+4]=t[4],f[l+5]=t[5],f[l+6]=t[6],f[l+7]=t[7]}function o(u,f,l){e[0]=u,f[l]=t[7],f[l+1]=t[6],f[l+2]=t[5],f[l+3]=t[4],f[l+4]=t[3],f[l+5]=t[2],f[l+6]=t[1],f[l+7]=t[0]}r.writeDoubleLE=n?i:o,r.writeDoubleBE=n?o:i;function s(u,f){return t[0]=u[f],t[1]=u[f+1],t[2]=u[f+2],t[3]=u[f+3],t[4]=u[f+4],t[5]=u[f+5],t[6]=u[f+6],t[7]=u[f+7],e[0]}function c(u,f){return t[7]=u[f],t[6]=u[f+1],t[5]=u[f+2],t[4]=u[f+3],t[3]=u[f+4],t[2]=u[f+5],t[1]=u[f+6],t[0]=u[f+7],e[0]}r.readDoubleLE=n?s:c,r.readDoubleBE=n?c:s}():function(){function e(n,i,o,s,c,u){var f=s<0?1:0;if(f&&(s=-s),s===0)n(0,c,u+i),n(1/s>0?0:2147483648,c,u+o);else if(isNaN(s))n(0,c,u+i),n(2146959360,c,u+o);else if(s>17976931348623157e292)n(0,c,u+i),n((f<<31|2146435072)>>>0,c,u+o);else{var l;if(s<22250738585072014e-324)l=s/5e-324,n(l>>>0,c,u+i),n((f<<31|l/4294967296)>>>0,c,u+o);else{var h=Math.floor(Math.log(s)/Math.LN2);h===1024&&(h=1023),l=s*Math.pow(2,-h),n(l*4503599627370496>>>0,c,u+i),n((f<<31|h+1023<<20|l*1048576&1048575)>>>0,c,u+o)}}}r.writeDoubleLE=e.bind(null,sm,0,4),r.writeDoubleBE=e.bind(null,am,4,0);function t(n,i,o,s,c){var u=n(s,c+i),f=n(s,c+o),l=(f>>31)*2+1,h=f>>>20&2047,d=4294967296*(f&1048575)+u;return h===2047?d?NaN:l*(1/0):h===0?l*5e-324*d:l*Math.pow(2,h-1075)*(d+4503599627370496)}r.readDoubleLE=t.bind(null,cm,0,4),r.readDoubleBE=t.bind(null,um,4,0)}(),r}function sm(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}function am(r,e,t){e[t]=r>>>24,e[t+1]=r>>>16&255,e[t+2]=r>>>8&255,e[t+3]=r&255}function cm(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0}function um(r,e){return(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}});var hm=b((exports,module)=>{"use strict";a();module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(r){}return null}});var pm=b(dm=>{"use strict";a();var cf=dm;cf.length=function(e){for(var t=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?t+=1:n<2048?t+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,t+=4):t+=3;return t};cf.read=function(e,t,n){var i=n-t;if(i<1)return"";for(var o=null,s=[],c=0,u;t<n;)u=e[t++],u<128?s[c++]=u:u>191&&u<224?s[c++]=(u&31)<<6|e[t++]&63:u>239&&u<365?(u=((u&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,s[c++]=55296+(u>>10),s[c++]=56320+(u&1023)):s[c++]=(u&15)<<12|(e[t++]&63)<<6|e[t++]&63,c>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),c=0);return o?(c&&o.push(String.fromCharCode.apply(String,s.slice(0,c))),o.join("")):String.fromCharCode.apply(String,s.slice(0,c))};cf.write=function(e,t,n){for(var i=n,o,s,c=0;c<e.length;++c)o=e.charCodeAt(c),o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=o&63|128):(o&64512)===55296&&((s=e.charCodeAt(c+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++c,t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=o&63|128):(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=o&63|128);return n-i}});var mm=b((s4,ym)=>{"use strict";a();ym.exports=S8;function S8(r,e,t){var n=t||8192,i=n>>>1,o=null,s=n;return function(u){if(u<1||u>i)return r(u);s+u>n&&(o=r(n),s=0);var f=e.call(o,s,s+=u);return s&7&&(s=(s|7)+1),f}}});var wm=b((c4,gm)=>{"use strict";a();gm.exports=de;var To=Or();function de(r,e){this.lo=r>>>0,this.hi=e>>>0}var En=de.zero=new de(0,0);En.toNumber=function(){return 0};En.zzEncode=En.zzDecode=function(){return this};En.length=function(){return 1};var A8=de.zeroHash="\0\0\0\0\0\0\0\0";de.fromNumber=function(e){if(e===0)return En;var t=e<0;t&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return t&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new de(n,i)};de.from=function(e){if(typeof e=="number")return de.fromNumber(e);if(To.isString(e))if(To.Long)e=To.Long.fromString(e);else return de.fromNumber(parseInt(e,10));return e.low||e.high?new de(e.low>>>0,e.high>>>0):En};de.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+n*4294967296)}return this.lo+this.hi*4294967296};de.prototype.toLong=function(e){return To.Long?new To.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var Ir=String.prototype.charCodeAt;de.fromHash=function(e){return e===A8?En:new de((Ir.call(e,0)|Ir.call(e,1)<<8|Ir.call(e,2)<<16|Ir.call(e,3)<<24)>>>0,(Ir.call(e,4)|Ir.call(e,5)<<8|Ir.call(e,6)<<16|Ir.call(e,7)<<24)>>>0)};de.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};de.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};de.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};de.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}});var Or=b(uf=>{"use strict";a();var S=uf;S.asPromise=Xy();S.base64=rm();S.EventEmitter=im();S.float=lm();S.inquire=hm();S.utf8=pm();S.pool=mm();S.LongBits=wm();S.isNode=Boolean(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node);S.global=S.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||uf;S.emptyArray=Object.freeze?Object.freeze([]):[];S.emptyObject=Object.freeze?Object.freeze({}):{};S.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};S.isString=function(e){return typeof e=="string"||e instanceof String};S.isObject=function(e){return e&&typeof e=="object"};S.isset=S.isSet=function(e,t){var n=e[t];return n!=null&&e.hasOwnProperty(t)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};S.Buffer=function(){try{var r=S.inquire("buffer").Buffer;return r.prototype.utf8Write?r:null}catch{return null}}();S._Buffer_from=null;S._Buffer_allocUnsafe=null;S.newBuffer=function(e){return typeof e=="number"?S.Buffer?S._Buffer_allocUnsafe(e):new S.Array(e):S.Buffer?S._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};S.Array=typeof Uint8Array<"u"?Uint8Array:Array;S.Long=S.global.dcodeIO&&S.global.dcodeIO.Long||S.global.Long||S.inquire("long");S.key2Re=/^true|false|0|1$/;S.key32Re=/^-?(?:0|[1-9][0-9]*)$/;S.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;S.longToHash=function(e){return e?S.LongBits.from(e).toHash():S.LongBits.zeroHash};S.longFromHash=function(e,t){var n=S.LongBits.fromHash(e);return S.Long?S.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))};function bm(r,e,t){for(var n=Object.keys(e),i=0;i<n.length;++i)(r[n[i]]===void 0||!t)&&(r[n[i]]=e[n[i]]);return r}S.merge=bm;S.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function Em(r){function e(t,n){if(!(this instanceof e))return new e(t,n);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&bm(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get(){return r},set:void 0,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}S.newError=Em;S.ProtocolError=Em("ProtocolError");S.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var i=Object.keys(this),o=i.length-1;o>-1;--o)if(t[i[o]]===1&&this[i[o]]!==void 0&&this[i[o]]!==null)return i[o]}};S.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}};S.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};S._configure=function(){var r=S.Buffer;if(!r){S._Buffer_from=S._Buffer_allocUnsafe=null;return}S._Buffer_from=r.from!==Uint8Array.from&&r.from||function(t,n){return new r(t,n)},S._Buffer_allocUnsafe=r.allocUnsafe||function(t){return new r(t)}}});var mf=b((h4,Dm)=>{"use strict";a();Dm.exports=P;var at=Or(),ff,ha=at.LongBits,xm=at.base64,vm=at.utf8;function Co(r,e,t){this.fn=r,this.len=e,this.next=void 0,this.val=t}function hf(){}function T8(r){this.head=r.head,this.tail=r.tail,this.len=r.len,this.next=r.states}function P(){this.len=0,this.head=new Co(hf,0,0),this.tail=this.head,this.states=null}var _m=function(){return at.Buffer?function(){return(P.create=function(){return new ff})()}:function(){return new P}};P.create=_m();P.alloc=function(e){return new at.Array(e)};at.Array!==Array&&(P.alloc=at.pool(P.alloc,at.Array.prototype.subarray));P.prototype._push=function(e,t,n){return this.tail=this.tail.next=new Co(e,t,n),this.len+=t,this};function df(r,e,t){e[t]=r&255}function C8(r,e,t){for(;r>127;)e[t++]=r&127|128,r>>>=7;e[t]=r}function pf(r,e){this.len=r,this.next=void 0,this.val=e}pf.prototype=Object.create(Co.prototype);pf.prototype.fn=C8;P.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new pf((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};P.prototype.int32=function(e){return e<0?this._push(yf,10,ha.fromNumber(e)):this.uint32(e)};P.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function yf(r,e,t){for(;r.hi;)e[t++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)e[t++]=r.lo&127|128,r.lo=r.lo>>>7;e[t++]=r.lo}P.prototype.uint64=function(e){var t=ha.from(e);return this._push(yf,t.length(),t)};P.prototype.int64=P.prototype.uint64;P.prototype.sint64=function(e){var t=ha.from(e).zzEncode();return this._push(yf,t.length(),t)};P.prototype.bool=function(e){return this._push(df,1,e?1:0)};function lf(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}P.prototype.fixed32=function(e){return this._push(lf,4,e>>>0)};P.prototype.sfixed32=P.prototype.fixed32;P.prototype.fixed64=function(e){var t=ha.from(e);return this._push(lf,4,t.lo)._push(lf,4,t.hi)};P.prototype.sfixed64=P.prototype.fixed64;P.prototype.float=function(e){return this._push(at.float.writeFloatLE,4,e)};P.prototype.double=function(e){return this._push(at.float.writeDoubleLE,8,e)};var I8=at.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var i=0;i<e.length;++i)t[n+i]=e[i]};P.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(df,1,0);if(at.isString(e)){var n=P.alloc(t=xm.length(e));xm.decode(e,n,0),e=n}return this.uint32(t)._push(I8,t,e)};P.prototype.string=function(e){var t=vm.length(e);return t?this.uint32(t)._push(vm.write,t,e):this._push(df,1,0)};P.prototype.fork=function(){return this.states=new T8(this),this.head=this.tail=new Co(hf,0,0),this.len=0,this};P.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Co(hf,0,0),this.len=0),this};P.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this};P.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t};P._configure=function(r){ff=r,P.create=_m(),ff._configure()}});var Tm=b((p4,Am)=>{"use strict";a();Am.exports=$t;var Sm=mf();($t.prototype=Object.create(Sm.prototype)).constructor=$t;var Br=Or();function $t(){Sm.call(this)}$t._configure=function(){$t.alloc=Br._Buffer_allocUnsafe,$t.writeBytesBuffer=Br.Buffer&&Br.Buffer.prototype instanceof Uint8Array&&Br.Buffer.prototype.set.name==="set"?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var i=0;i<e.length;)t[n++]=e[i++]}};$t.prototype.bytes=function(e){Br.isString(e)&&(e=Br._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push($t.writeBytesBuffer,t,e),this};function O8(r,e,t){r.length<40?Br.utf8.write(r,e,t):e.utf8Write?e.utf8Write(r,t):e.write(r,t)}$t.prototype.string=function(e){var t=Br.Buffer.byteLength(e);return this.uint32(t),t&&this._push(O8,t,e),this};$t._configure()});var bf=b((m4,km)=>{"use strict";a();km.exports=ne;var Mt=Or(),wf,Om=Mt.LongBits,B8=Mt.utf8;function vt(r,e){return RangeError("index out of range: "+r.pos+" + "+(e||1)+" > "+r.len)}function ne(r){this.buf=r,this.pos=0,this.len=r.length}var Cm=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new ne(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new ne(e);throw Error("illegal buffer")},Bm=function(){return Mt.Buffer?function(t){return(ne.create=function(i){return Mt.Buffer.isBuffer(i)?new wf(i):Cm(i)})(t)}:Cm};ne.create=Bm();ne.prototype._slice=Mt.Array.prototype.subarray||Mt.Array.prototype.slice;ne.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,vt(this,10);return e}}();ne.prototype.int32=function(){return this.uint32()|0};ne.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function gf(){var r=new Om(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r;if(r.lo=(r.lo|(this.buf[this.pos]&127)<<28)>>>0,r.hi=(r.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return r;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw vt(this);if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r}return r.lo=(r.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,r}if(this.len-this.pos>4){for(;e<5;++e)if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}else for(;e<5;++e){if(this.pos>=this.len)throw vt(this);if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}throw Error("invalid varint encoding")}ne.prototype.bool=function(){return this.uint32()!==0};function da(r,e){return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0}ne.prototype.fixed32=function(){if(this.pos+4>this.len)throw vt(this,4);return da(this.buf,this.pos+=4)};ne.prototype.sfixed32=function(){if(this.pos+4>this.len)throw vt(this,4);return da(this.buf,this.pos+=4)|0};function Im(){if(this.pos+8>this.len)throw vt(this,8);return new Om(da(this.buf,this.pos+=4),da(this.buf,this.pos+=4))}ne.prototype.float=function(){if(this.pos+4>this.len)throw vt(this,4);var e=Mt.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};ne.prototype.double=function(){if(this.pos+8>this.len)throw vt(this,4);var e=Mt.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};ne.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw vt(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)};ne.prototype.string=function(){var e=this.bytes();return B8.read(e,0,e.length)};ne.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw vt(this,e);this.pos+=e}else do if(this.pos>=this.len)throw vt(this);while(this.buf[this.pos++]&128);return this};ne.prototype.skipType=function(r){switch(r){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(r=this.uint32()&7)!==4;)this.skipType(r);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+r+" at offset "+this.pos)}return this};ne._configure=function(r){wf=r,ne.create=Bm(),wf._configure();var e=Mt.Long?"toLong":"toNumber";Mt.merge(ne.prototype,{int64:function(){return gf.call(this)[e](!1)},uint64:function(){return gf.call(this)[e](!0)},sint64:function(){return gf.call(this).zzDecode()[e](!1)},fixed64:function(){return Im.call(this)[e](!0)},sfixed64:function(){return Im.call(this)[e](!1)}})}});var Pm=b((w4,Nm)=>{"use strict";a();Nm.exports=xn;var Rm=bf();(xn.prototype=Object.create(Rm.prototype)).constructor=xn;var Lm=Or();function xn(r){Rm.call(this,r)}xn._configure=function(){Lm.Buffer&&(xn.prototype._slice=Lm.Buffer.prototype.slice)};xn.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};xn._configure()});var Um=b((E4,Fm)=>{"use strict";a();Fm.exports=Io;var Ef=Or();(Io.prototype=Object.create(Ef.EventEmitter.prototype)).constructor=Io;function Io(r,e,t){if(typeof r!="function")throw TypeError("rpcImpl must be a function");Ef.EventEmitter.call(this),this.rpcImpl=r,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(t)}Io.prototype.rpcCall=function r(e,t,n,i,o){if(!i)throw TypeError("request must be specified");var s=this;if(!o)return Ef.asPromise(r,s,e,t,n,i);if(!s.rpcImpl){setTimeout(function(){o(Error("already ended"))},0);return}try{return s.rpcImpl(e,t[s.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(u,f){if(u)return s.emit("error",u,e),o(u);if(f===null){s.end(!0);return}if(!(f instanceof n))try{f=n[s.responseDelimited?"decodeDelimited":"decode"](f)}catch(l){return s.emit("error",l,e),o(l)}return s.emit("data",f,e),o(null,f)})}catch(c){s.emit("error",c,e),setTimeout(function(){o(c)},0);return}};Io.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var Mm=b($m=>{"use strict";a();var k8=$m;k8.Service=Um()});var zm=b((D4,jm)=>{"use strict";a();jm.exports={}});var Km=b(Vm=>{"use strict";a();var Le=Vm;Le.build="minimal";Le.Writer=mf();Le.BufferWriter=Tm();Le.Reader=bf();Le.BufferReader=Pm();Le.util=Or();Le.rpc=Mm();Le.roots=zm();Le.configure=qm;function qm(){Le.util._configure(),Le.Writer._configure(Le.BufferWriter),Le.Reader._configure(Le.BufferReader)}qm()});var kr=b((C4,Wm)=>{"use strict";a();Wm.exports=Km()});var Qm=b((xf,Jm)=>{"use strict";a();Object.defineProperty(xf,"__esModule",{value:!0});ya.BASE=2166136261;function ya(r,e=ya.BASE){let t=r.length;for(let n=0;n<t;n++)e^=r.charCodeAt(n),e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24);return e>>>0}xf.default=ya;Jm.exports=ya});var Zm=b((R4,Xm)=>{a();Xm.exports=vf;var Ym=128,R8=127,N8=~R8,P8=Math.pow(2,31);function vf(r,e,t){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw vf.bytes=0,new RangeError("Could not encode varint");e=e||[],t=t||0;for(var n=t;r>=P8;)e[t++]=r&255|Ym,r/=128;for(;r&N8;)e[t++]=r&255|Ym,r>>>=7;return e[t]=r|0,vf.bytes=t-n+1,e}});var rg=b((P4,tg)=>{a();tg.exports=_f;var F8=128,eg=127;function _f(r,n){var t=0,n=n||0,i=0,o=n,s,c=r.length;do{if(o>=c||i>49)throw _f.bytes=0,new RangeError("Could not decode varint");s=r[o++],t+=i<28?(s&eg)<<i:(s&eg)*Math.pow(2,i),i+=7}while(s>=F8);return _f.bytes=o-n,t}});var ig=b((U4,ng)=>{a();var U8=Math.pow(2,7),$8=Math.pow(2,14),M8=Math.pow(2,21),j8=Math.pow(2,28),z8=Math.pow(2,35),q8=Math.pow(2,42),V8=Math.pow(2,49),K8=Math.pow(2,56),W8=Math.pow(2,63);ng.exports=function(r){return r<U8?1:r<$8?2:r<M8?3:r<j8?4:r<z8?5:r<q8?6:r<V8?7:r<K8?8:r<W8?9:10}});var Re=b((M4,og)=>{a();og.exports={encode:Zm(),decode:rg(),encodingLength:ig()}});var Af={};H(Af,{concat:()=>Q});function Q(r,e){e||(e=r.reduce((i,o)=>i+o.length,0));let t=Js(e),n=0;for(let i of r)t.set(i,n),n+=i.length;return t}var Lr=$(()=>{a();Wu()});var Sg=b((FO,Dg)=>{"use strict";a();var _g="[a-fA-F\\d:]",Pr=r=>r&&r.includeBoundaries?`(?:(?<=\\s|^)(?=${_g})|(?<=${_g})(?=\\s|$))`:"",Dt="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",ae="[a-fA-F\\d]{1,4}",_a=`
(?:
(?:${ae}:){7}(?:${ae}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${ae}:){6}(?:${Dt}|:${ae}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${ae}:){5}(?::${Dt}|(?::${ae}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${ae}:){4}(?:(?::${ae}){0,1}:${Dt}|(?::${ae}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${ae}:){3}(?:(?::${ae}){0,2}:${Dt}|(?::${ae}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${ae}:){2}(?:(?::${ae}){0,3}:${Dt}|(?::${ae}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${ae}:){1}(?:(?::${ae}){0,4}:${Dt}|(?::${ae}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${ae}){0,5}:${Dt}|(?::${ae}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),u_=new RegExp(`(?:^${Dt}$)|(?:^${_a}$)`),f_=new RegExp(`^${Dt}$`),l_=new RegExp(`^${_a}$`),Uf=r=>r&&r.exact?u_:new RegExp(`(?:${Pr(r)}${Dt}${Pr(r)})|(?:${Pr(r)}${_a}${Pr(r)})`,"g");Uf.v4=r=>r&&r.exact?f_:new RegExp(`${Pr(r)}${Dt}${Pr(r)}`,"g");Uf.v6=r=>r&&r.exact?l_:new RegExp(`${Pr(r)}${_a}${Pr(r)}`,"g");Dg.exports=Uf});var Tg=b(($O,Ag)=>{"use strict";a();var $f=Sg(),Di=r=>$f({exact:!0}).test(r);Di.v4=r=>$f.v4({exact:!0}).test(r);Di.v6=r=>$f.v6({exact:!0}).test(r);Di.version=r=>Di(r)?Di.v4(r)?4:6:void 0;Ag.exports=Di});var kg=b((jO,Bg)=>{"use strict";a();var jf=Tg(),{toString:Cg}=(W(),Oe(mo)),h_=jf,Mf=jf.v4,Ig=jf.v6,Og=function(r,e,t){t=~~t;let n;if(Mf(r))n=e||new Uint8Array(t+4),r.split(/\./g).map(function(i){n[t++]=parseInt(i,10)&255});else if(Ig(r)){let i=r.split(":",8),o;for(o=0;o<i.length;o++){let s=Mf(i[o]),c;s&&(c=Og(i[o]),i[o]=Cg(c.slice(0,2),"base16")),c&&++o<8&&i.splice(o,0,Cg(c.slice(2,4),"base16"))}if(i[0]==="")for(;i.length<8;)i.unshift("0");else if(i[i.length-1]==="")for(;i.length<8;)i.push("0");else if(i.length<8){for(o=0;o<i.length&&i[o]!=="";o++);let s=[o,"1"];for(o=9-i.length;o>0;o--)s.push("0");i.splice.apply(i,s)}for(n=e||new Uint8Array(t+16),o=0;o<i.length;o++){let s=parseInt(i[o],16);n[t++]=s>>8&255,n[t++]=s&255}}if(!n)throw Error("Invalid ip address: "+r);return n},d_=function(r,e,t){e=~~e,t=t||r.length-e;let n=[],i,o=new DataView(r.buffer);if(t===4){for(let s=0;s<t;s++)n.push(r[e+s]);i=n.join(".")}else if(t===16){for(let s=0;s<t;s+=2)n.push(o.getUint16(e+s).toString(16));i=n.join(":"),i=i.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),i=i.replace(/:{3,4}/,"::")}return i};Bg.exports={isIP:h_,isV4:Mf,isV6:Ig,toBytes:Og,toString:d_}});var Da=b((qO,Rg)=>{"use strict";a();function Ne(r){if(typeof r=="number"){if(Ne.codes[r])return Ne.codes[r];throw new Error("no protocol with code: "+r)}else if(typeof r=="string"){if(Ne.names[r])return Ne.names[r];throw new Error("no protocol with name: "+r)}throw new Error("invalid protocol id type: "+r)}var ut=-1;Ne.lengthPrefixedVarSize=ut;Ne.V=ut;Ne.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,ut,"ip6zone"],[53,ut,"dns","resolvable"],[54,ut,"dns4","resolvable"],[55,ut,"dns6","resolvable"],[56,ut,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,ut,"unix",!1,"path"],[421,ut,"ipfs"],[421,ut,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,ut,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,ut,"memory"]];Ne.names={};Ne.codes={};Ne.table.map(r=>{let e=Lg.apply(null,r);return Ne.codes[e.code]=e,Ne.names[e.name]=e,null});Ne.object=Lg;function Lg(r,e,t,n,i){return{code:r,size:e,name:t,resolvable:Boolean(n),path:Boolean(i)}}Rg.exports=Ne});var zg=b((KO,jg)=>{"use strict";a();var Sa=kg(),Fg=Da(),{CID:p_}=(V(),Oe(Ou)),{base32:Ug}=(Ce(),Oe(qs)),{base58btc:y_}=(ke(),Oe(fo)),m_=(Te(),Oe(Ae)),Si=Re(),{toString:Aa}=(W(),Oe(mo)),{fromString:$g}=(ge(),Oe(kp)),{concat:Ta}=(Lr(),Oe(Af));jg.exports=Ro;function Ro(r,e){return e instanceof Uint8Array?Ro.toString(r,e):Ro.toBytes(r,e)}Ro.toString=function(e,t){switch(Fg(e).code){case 4:case 41:return g_(t);case 6:case 273:case 33:case 132:return Mg(t).toString();case 53:case 54:case 55:case 56:case 400:case 777:return b_(t);case 421:return x_(t);case 444:return Pg(t);case 445:return Pg(t);default:return Aa(t,"base16")}};Ro.toBytes=function(e,t){switch(Fg(e).code){case 4:return Ng(t);case 41:return Ng(t);case 6:case 273:case 33:case 132:return zf(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 777:return w_(t);case 421:return E_(t);case 444:return v_(t);case 445:return __(t);default:return $g(t,"base16")}};function Ng(r){if(!Sa.isIP(r))throw new Error("invalid ip address");return Sa.toBytes(r)}function g_(r){let e=Sa.toString(r);if(!e||!Sa.isIP(e))throw new Error("invalid ip address");return e}function zf(r){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,r),new Uint8Array(e)}function Mg(r){return new DataView(r.buffer).getUint16(r.byteOffset)}function w_(r){let e=$g(r),t=Uint8Array.from(Si.encode(e.length));return Ta([t,e],t.length+e.length)}function b_(r){let e=Si.decode(r);if(r=r.slice(Si.decode.bytes),r.length!==e)throw new Error("inconsistent lengths");return Aa(r)}function E_(r){let e;r[0]==="Q"||r[0]==="1"?e=m_.decode(y_.decode(`z${r}`)).bytes:e=p_.parse(r).multihash.bytes;let t=Uint8Array.from(Si.encode(e.length));return Ta([t,e],t.length+e.length)}function x_(r){let e=Si.decode(r),t=r.slice(Si.decode.bytes);if(t.length!==e)throw new Error("inconsistent lengths");return Aa(t,"base58btc")}function v_(r){let e=r.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==16)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion address.");let t=Ug.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=zf(n);return Ta([t,i],t.length+i.length)}function __(r){let e=r.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==56)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion3 address.");let t=Ug.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=zf(n);return Ta([t,i],t.length+i.length)}function Pg(r){let e=r.slice(0,r.length-2),t=r.slice(r.length-2),n=Aa(e,"base32"),i=Mg(t);return n+":"+i}});var ew=b((HO,Zg)=>{"use strict";a();var Vg=zg(),qf=Da(),No=Re(),{concat:qg}=(Lr(),Oe(Af)),{toString:D_}=(W(),Oe(mo));Zg.exports={stringToStringTuples:Kg,stringTuplesToString:Wg,tuplesToStringTuples:Gg,stringTuplesToTuples:Hg,bytesToTuples:Vf,tuplesToBytes:Jg,bytesToString:S_,stringToBytes:Yg,fromString:A_,fromBytes:Xg,validateBytes:Kf,isValidBytes:T_,cleanPath:Ca,ParseError:Wf,protoFromTuple:Po,sizeForAddr:Qg};function Kg(r){let e=[],t=r.split("/").slice(1);if(t.length===1&&t[0]==="")return[];for(let n=0;n<t.length;n++){let i=t[n],o=qf(i);if(o.size===0){e.push([i]);continue}if(n++,n>=t.length)throw Wf("invalid address: "+r);if(o.path){e.push([i,Ca(t.slice(n).join("/"))]);break}e.push([i,t[n]])}return e}function Wg(r){let e=[];return r.map(t=>{let n=Po(t);return e.push(n.name),t.length>1&&e.push(t[1]),null}),Ca(e.join("/"))}function Hg(r){return r.map(e=>{Array.isArray(e)||(e=[e]);let t=Po(e);return e.length>1?[t.code,Vg.toBytes(t.code,e[1])]:[t.code]})}function Gg(r){return r.map(e=>{let t=Po(e);return e[1]?[t.code,Vg.toString(t.code,e[1])]:[t.code]})}function Jg(r){return Xg(qg(r.map(e=>{let t=Po(e),n=Uint8Array.from(No.encode(t.code));return e.length>1&&(n=qg([n,e[1]])),n})))}function Qg(r,e){return r.size>0?r.size/8:r.size===0?0:No.decode(e)+No.decode.bytes}function Vf(r){let e=[],t=0;for(;t<r.length;){let n=No.decode(r,t),i=No.decode.bytes,o=qf(n),s=Qg(o,r.slice(t+i));if(s===0){e.push([n]),t+=i;continue}let c=r.slice(t+i,t+i+s);if(t+=s+i,t>r.length)throw Wf("Invalid address Uint8Array: "+D_(r,"base16"));e.push([n,c])}return e}function S_(r){let e=Vf(r),t=Gg(e);return Wg(t)}function Yg(r){r=Ca(r);let e=Kg(r),t=Hg(e);return Jg(t)}function A_(r){return Yg(r)}function Xg(r){let e=Kf(r);if(e)throw e;return Uint8Array.from(r)}function Kf(r){try{Vf(r)}catch(e){return e}}function T_(r){return Kf(r)===void 0}function Ca(r){return"/"+r.trim().split("/").filter(e=>e).join("/")}function Wf(r){return new Error("Error parsing address: "+r)}function Po(r){return qf(r[0])}});var tw={};H(tw,{equals:()=>Fo});function Fo(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}var Ia=$(()=>{a()});var ow=b((QO,iw)=>{"use strict";a();var St=ew(),Ai=Da(),rw=Re(),{CID:C_}=(V(),Oe(Ou)),{base58btc:I_}=(ke(),Oe(fo)),O_=Se(),B_=Symbol.for("nodejs.util.inspect.custom"),{toString:Oa}=(W(),Oe(mo)),{equals:k_}=(Ia(),Oe(tw)),Hf=new Map,nw=Symbol.for("@multiformats/js-multiaddr/multiaddr"),be=class{constructor(e){if(e==null&&(e=""),Object.defineProperty(this,nw,{value:!0}),e instanceof Uint8Array)this.bytes=St.fromBytes(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=St.fromString(e)}else if(be.isMultiaddr(e))this.bytes=St.fromBytes(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return St.bytesToString(this.bytes)}toJSON(){return this.toString()}toOptions(){let e={},t=this.toString().split("/");return e.family=t[1]==="ip4"?4:6,e.host=t[2],e.transport=t[3],e.port=parseInt(t[4]),e}protos(){return this.protoCodes().map(e=>Object.assign({},Ai(e)))}protoCodes(){let e=[],t=this.bytes,n=0;for(;n<t.length;){let i=rw.decode(t,n),o=rw.decode.bytes,s=Ai(i);n+=St.sizeForAddr(s,t.slice(n+o))+o,e.push(i)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return St.bytesToTuples(this.bytes)}stringTuples(){let e=St.bytesToTuples(this.bytes);return St.tuplesToStringTuples(e)}encapsulate(e){return e=new be(e),new be(this.toString()+e.toString())}decapsulate(e){let t=e.toString(),n=this.toString(),i=n.lastIndexOf(t);if(i<0)throw new Error("Address "+this+" does not contain subaddress: "+e);return new be(n.slice(0,i))}decapsulateCode(e){let t=this.tuples();for(let n=t.length-1;n>=0;n--)if(t[n][0]===e)return new be(St.tuplesToBytes(t.slice(0,n)));return this}getPeerId(){try{let t=this.stringTuples().filter(n=>n[0]===Ai.names.ipfs.code).pop();if(t&&t[1]){let n=t[1];return n[0]==="Q"||n[0]==="1"?Oa(I_.decode(`z${n}`),"base58btc"):Oa(C_.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let e=null;try{e=this.stringTuples().filter(t=>!!Ai(t[0]).path)[0][1],e||(e=null)}catch{e=null}return e}equals(e){return k_(this.bytes,e.bytes)}async resolve(){let e=this.protos().find(i=>i.resolvable);if(!e)return[this];let t=Hf.get(e.name);if(!t)throw O_(new Error(`no available resolver for ${e.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await t(this)).map(i=>new be(i))}nodeAddress(){let e=this.protoCodes(),t=this.protoNames(),n=this.toString().split("/").slice(1);if(n.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(e[0]!==4&&e[0]!==41&&e[0]!==54&&e[0]!==55)throw new Error(`no protocol with name: "'${t[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if(n[2]!=="tcp"&&n[2]!=="udp")throw new Error(`no protocol with name: "'${t[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:e[0]===41||e[0]===55?6:4,address:n[1],port:parseInt(n[3])}}isThinWaistAddress(e){let t=(e||this).protos();return!(t.length!==2||t[0].code!==4&&t[0].code!==41||t[1].code!==6&&t[1].code!==273)}static fromNodeAddress(e,t){if(!e)throw new Error("requires node address object");if(!t)throw new Error("requires transport protocol");let n;switch(e.family){case 4:n="ip4";break;case 6:n="ip6";break;default:throw Error(`Invalid addr family. Got '${e.family}' instead of 4 or 6`)}return new be("/"+[n,e.address,t,e.port].join("/"))}static isName(e){return be.isMultiaddr(e)?e.protos().some(t=>t.resolvable):!1}static isMultiaddr(e){return e instanceof be||Boolean(e&&e[nw])}[B_](){return"<Multiaddr "+Oa(this.bytes,"base16")+" - "+St.bytesToString(this.bytes)+">"}inspect(){return"<Multiaddr "+Oa(this.bytes,"base16")+" - "+St.bytesToString(this.bytes)+">"}};be.protocols=Ai;be.resolvers=Hf;function L_(r){return new be(r)}iw.exports={Multiaddr:be,multiaddr:L_,protocols:Ai,resolvers:Hf}});var yw=b((TB,ka)=>{"use strict";a();ka.exports=z_;ka.exports.format=dw;ka.exports.parse=pw;var $_=/\B(?=(\d{3})+(?!\d))/g,M_=/(?:\.0*|(\.[^0]+)0+)$/,Ur={b:1,kb:1<<10,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},j_=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function z_(r,e){return typeof r=="string"?pw(r):typeof r=="number"?dw(r,e):null}function dw(r,e){if(!Number.isFinite(r))return null;var t=Math.abs(r),n=e&&e.thousandsSeparator||"",i=e&&e.unitSeparator||"",o=e&&e.decimalPlaces!==void 0?e.decimalPlaces:2,s=Boolean(e&&e.fixedDecimals),c=e&&e.unit||"";(!c||!Ur[c.toLowerCase()])&&(t>=Ur.pb?c="PB":t>=Ur.tb?c="TB":t>=Ur.gb?c="GB":t>=Ur.mb?c="MB":t>=Ur.kb?c="KB":c="B");var u=r/Ur[c.toLowerCase()],f=u.toFixed(o);return s||(f=f.replace(M_,"$1")),n&&(f=f.split(".").map(function(l,h){return h===0?l.replace($_,n):l}).join(".")),f+i+c}function pw(r){if(typeof r=="number"&&!isNaN(r))return r;if(typeof r!="string")return null;var e=j_.exec(r),t,n="b";return e?(t=parseFloat(e[1]),n=e[4].toLowerCase()):(t=parseInt(r,10),n="b"),isNaN(t)?null:Math.floor(Ur[n]*t)}});var gw=b((IB,mw)=>{"use strict";a();mw.exports=r=>{if(Object.prototype.toString.call(r)!=="[object Object]")return!1;let e=Object.getPrototypeOf(r);return e===null||e===Object.prototype}});var _w=b((xw,vw)=>{"use strict";a();var La=gw(),{hasOwnProperty:bw}=Object.prototype,{propertyIsEnumerable:q_}=Object,Oi=(r,e,t)=>Object.defineProperty(r,e,{value:t,writable:!0,enumerable:!0,configurable:!0}),V_=xw,ww={concatArrays:!1,ignoreUndefined:!1},Ra=r=>{let e=[];for(let t in r)bw.call(r,t)&&e.push(t);if(Object.getOwnPropertySymbols){let t=Object.getOwnPropertySymbols(r);for(let n of t)q_.call(r,n)&&e.push(n)}return e};function Bi(r){return Array.isArray(r)?K_(r):La(r)?W_(r):r}function K_(r){let e=r.slice(0,0);return Ra(r).forEach(t=>{Oi(e,t,Bi(r[t]))}),e}function W_(r){let e=Object.getPrototypeOf(r)===null?Object.create(null):{};return Ra(r).forEach(t=>{Oi(e,t,Bi(r[t]))}),e}var Ew=(r,e,t,n)=>(t.forEach(i=>{typeof e[i]>"u"&&n.ignoreUndefined||(i in r&&r[i]!==Object.getPrototypeOf(r)?Oi(r,i,Zf(r[i],e[i],n)):Oi(r,i,Bi(e[i])))}),r),H_=(r,e,t)=>{let n=r.slice(0,0),i=0;return[r,e].forEach(o=>{let s=[];for(let c=0;c<o.length;c++)!bw.call(o,c)||(s.push(String(c)),o===r?Oi(n,i++,o[c]):Oi(n,i++,Bi(o[c])));n=Ew(n,o,Ra(o).filter(c=>!s.includes(c)),t)}),n};function Zf(r,e,t){return t.concatArrays&&Array.isArray(r)&&Array.isArray(e)?H_(r,e,t):!La(e)||!La(r)?Bi(e):Ew(r,e,Ra(e),t)}vw.exports=function(...r){let e=Zf(Bi(ww),this!==V_&&this||{},ww),t={_:{}};for(let n of r)if(n!==void 0){if(!La(n))throw new TypeError("`"+n+"` is not an Option Object");t=Zf(t,{_:n},e)}return t._}});var Lw=b((QB,tl)=>{"use strict";a();var eD=Object.prototype.hasOwnProperty,Ie="~";function Mo(){}Object.create&&(Mo.prototype=Object.create(null),new Mo().__proto__||(Ie=!1));function tD(r,e,t){this.fn=r,this.context=e,this.once=t||!1}function kw(r,e,t,n,i){if(typeof t!="function")throw new TypeError("The listener must be a function");var o=new tD(t,n||r,i),s=Ie?Ie+e:e;return r._events[s]?r._events[s].fn?r._events[s]=[r._events[s],o]:r._events[s].push(o):(r._events[s]=o,r._eventsCount++),r}function Ua(r,e){--r._eventsCount===0?r._events=new Mo:delete r._events[e]}function Ee(){this._events=new Mo,this._eventsCount=0}Ee.prototype.eventNames=function(){var e=[],t,n;if(this._eventsCount===0)return e;for(n in t=this._events)eD.call(t,n)&&e.push(Ie?n.slice(1):n);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};Ee.prototype.listeners=function(e){var t=Ie?Ie+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=new Array(o);i<o;i++)s[i]=n[i].fn;return s};Ee.prototype.listenerCount=function(e){var t=Ie?Ie+e:e,n=this._events[t];return n?n.fn?1:n.length:0};Ee.prototype.emit=function(e,t,n,i,o,s){var c=Ie?Ie+e:e;if(!this._events[c])return!1;var u=this._events[c],f=arguments.length,l,h;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),f){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,i),!0;case 5:return u.fn.call(u.context,t,n,i,o),!0;case 6:return u.fn.call(u.context,t,n,i,o,s),!0}for(h=1,l=new Array(f-1);h<f;h++)l[h-1]=arguments[h];u.fn.apply(u.context,l)}else{var d=u.length,w;for(h=0;h<d;h++)switch(u[h].once&&this.removeListener(e,u[h].fn,void 0,!0),f){case 1:u[h].fn.call(u[h].context);break;case 2:u[h].fn.call(u[h].context,t);break;case 3:u[h].fn.call(u[h].context,t,n);break;case 4:u[h].fn.call(u[h].context,t,n,i);break;default:if(!l)for(w=1,l=new Array(f-1);w<f;w++)l[w-1]=arguments[w];u[h].fn.apply(u[h].context,l)}}return!0};Ee.prototype.on=function(e,t,n){return kw(this,e,t,n,!1)};Ee.prototype.once=function(e,t,n){return kw(this,e,t,n,!0)};Ee.prototype.removeListener=function(e,t,n,i){var o=Ie?Ie+e:e;if(!this._events[o])return this;if(!t)return Ua(this,o),this;var s=this._events[o];if(s.fn)s.fn===t&&(!i||s.once)&&(!n||s.context===n)&&Ua(this,o);else{for(var c=0,u=[],f=s.length;c<f;c++)(s[c].fn!==t||i&&!s[c].once||n&&s[c].context!==n)&&u.push(s[c]);u.length?this._events[o]=u.length===1?u[0]:u:Ua(this,o)}return this};Ee.prototype.removeAllListeners=function(e){var t;return e?(t=Ie?Ie+e:e,this._events[t]&&Ua(this,t)):(this._events=new Mo,this._eventsCount=0),this};Ee.prototype.off=Ee.prototype.removeListener;Ee.prototype.addListener=Ee.prototype.on;Ee.prefixed=Ie;Ee.EventEmitter=Ee;typeof tl<"u"&&(tl.exports=Ee)});var On=b(($k,Gw)=>{"use strict";a();var oD=async function*(r,e){for await(let t of r)await e(t)&&(yield t)};Gw.exports=oD});var Bn=b((Wk,Qw)=>{"use strict";a();var aD=async r=>{for await(let e of r);};Qw.exports=aD});var dl=b((aL,ob)=>{"use strict";a();var fD=async r=>{for await(let e of r)return e};ob.exports=fD});var Ri=b((BL,lb)=>{"use strict";a();var mD=async function*(r,e){for await(let t of r)yield e(t)};lb.exports=mD});var _b=b((eR,vb)=>{"use strict";a();async function*ED(r,e=1){let t=[];e<1&&(e=1);for await(let n of r)for(t.push(n);t.length>=e;)yield t.slice(0,e),t=t.slice(e);for(;t.length;)yield t.slice(0,e),t=t.slice(e)}vb.exports=ED});var Sb=b((rR,Db)=>{"use strict";a();var xD=_b();async function*vD(r,e=1){for await(let t of xD(r,e)){let n=t.map(i=>i().then(o=>({ok:!0,value:o}),o=>({ok:!1,err:o})));for(let i=0;i<n.length;i++){let o=await n[i];if(o.ok)yield o.value;else throw o.err}}}Db.exports=vD});var Cb=b((fR,Tb)=>{a();Tb.exports=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}}});var Bb=b((dR,Ob)=>{a();var Ib=Cb();Ob.exports=class{constructor(e){this.hwm=e||16,this.head=new Ib(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let t=this.head;this.head=t.next=new Ib(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let t=this.tail.next;return this.tail.next=null,this.tail=t,this.tail.shift()}return e}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}}});var Lb=b((yR,kb)=>{a();var Bl=Bb();kb.exports=r=>{r=r||{};let e;typeof r=="function"?(e=r,r={}):e=r.onEnd;let t=new Bl,n,i,o,s=()=>{if(!t.isEmpty()){if(r.writev){let m,I=[];for(;!t.isEmpty();){if(m=t.shift(),m.error)throw m.error;I.push(m.value)}return{done:m.done,value:I}}let g=t.shift();if(g.error)throw g.error;return g}return o?{done:!0}:new Promise((g,m)=>{i=I=>(i=null,I.error?m(I.error):r.writev&&!I.done?g({done:I.done,value:[I.value]}):g(I),n)})},c=g=>i?i(g):(t.push(g),n),u=g=>(t=new Bl,i?i({error:g}):(t.push({error:g}),n)),f=g=>o?n:c({done:!1,value:g}),l=g=>o?n:(o=!0,g?u(g):c({done:!0})),h=()=>(t=new Bl,l(),{done:!0}),d=g=>(l(g),{done:!0});if(n={[Symbol.asyncIterator](){return this},next:s,return:h,throw:d,push:f,end:l},!e)return n;let w=n;return n={[Symbol.asyncIterator](){return this},next(){return w.next()},throw(g){return w.throw(g),e&&(e(g),e=null),{done:!0}},return(){return w.return(),e&&(e(),e=null),{done:!0}},push:f,end(g){return w.end(g),e&&(e(g),e=null),n}},n}});var Za=b((gR,Rb)=>{"use strict";a();var DD=Lb(),SD=async function*(...r){let e=DD();setTimeout(async()=>{try{await Promise.all(r.map(async t=>{for await(let n of t)e.push(n)})),e.end()}catch(t){e.end(t)}},0),yield*e};Rb.exports=SD});var Zo=b((lN,Jb)=>{"use strict";a();var KD=async r=>{let e=[];for await(let t of r)e.push(t);return e};Jb.exports=KD});var es=b((yN,Yb)=>{"use strict";a();var WD=async function*(r,e){let t=0;if(!(e<1)){for await(let n of r)if(yield n,t++,t===e)return}};Yb.exports=WD});var t0=b((AP,e0)=>{"use strict";a();var XD=Zo(),ZD=async function*(r,e){yield*(await XD(r)).sort(e)};e0.exports=ZD});var n0=b(r0=>{"use strict";a();r0.supports=function(...e){let t=e.reduce((n,i)=>Object.assign(n,i),{});return Object.assign(t,{snapshots:t.snapshots||!1,permanence:t.permanence||!1,seek:t.seek||!1,clear:t.clear||!1,getMany:t.getMany||!1,keyIterator:t.keyIterator||!1,valueIterator:t.valueIterator||!1,iteratorNextv:t.iteratorNextv||!1,iteratorAll:t.iteratorAll||!1,status:t.status||!1,createIfMissing:t.createIfMissing||!1,errorIfExists:t.errorIfExists||!1,deferredOpen:t.deferredOpen||!1,promises:t.promises||!1,streams:t.streams||!1,encodings:Object.assign({},t.encodings),events:Object.assign({},t.events),additionalMethods:Object.assign({},t.additionalMethods)})}});var Ct=b((BP,i0)=>{"use strict";a();i0.exports=class extends Error{constructor(e,t){super(e||""),typeof t=="object"&&t!==null&&(t.code&&(this.code=String(t.code)),t.expected&&(this.expected=!0),t.transient&&(this.transient=!0),t.cause&&(this.cause=t.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}});var Ml=b((LP,o0)=>{"use strict";a();var $l=null;o0.exports=function(){return $l===null&&($l={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),$l}});var ql=b(s0=>{"use strict";a();var jl=Ct(),eS=new Set(["buffer","view","utf8"]),zl=class{constructor(e){if(this.encode=e.encode||this.encode,this.decode=e.decode||this.decode,this.name=e.name||this.name,this.format=e.format||this.format,typeof this.encode!="function")throw new TypeError("The 'encode' property must be a function");if(typeof this.decode!="function")throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),typeof this.name!="string"||this.name==="")throw new TypeError("The 'name' property must be a string");if(typeof this.format!="string"||!eS.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");e.createViewTranscoder&&(this.createViewTranscoder=e.createViewTranscoder),e.createBufferTranscoder&&(this.createBufferTranscoder=e.createBufferTranscoder),e.createUTF8Transcoder&&(this.createUTF8Transcoder=e.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new jl(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new jl(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new jl(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}};s0.Encoding=zl});var Hl=b(ic=>{"use strict";a();var{Buffer:Kl}=so()||{},{Encoding:Wl}=ql(),tS=Ml(),ts=class extends Wl{constructor(e){super({...e,format:"buffer"})}createViewTranscoder(){return new rs({encode:this.encode,decode:e=>this.decode(Kl.from(e.buffer,e.byteOffset,e.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}},rs=class extends Wl{constructor(e){super({...e,format:"view"})}createBufferTranscoder(){return new ts({encode:e=>{let t=this.encode(e);return Kl.from(t.buffer,t.byteOffset,t.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}},Vl=class extends Wl{constructor(e){super({...e,format:"utf8"})}createBufferTranscoder(){return new ts({encode:e=>Kl.from(this.encode(e),"utf8"),decode:e=>this.decode(e.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){let{textEncoder:e,textDecoder:t}=tS();return new rs({encode:n=>e.encode(this.encode(n)),decode:n=>this.decode(t.decode(n)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}};ic.BufferFormat=ts;ic.ViewFormat=rs;ic.UTF8Format=Vl});var f0=b(Pn=>{"use strict";a();var{Buffer:xe}=so()||{Buffer:{isBuffer:()=>!1}},{textEncoder:c0,textDecoder:a0}=Ml()(),{BufferFormat:ns,ViewFormat:Gl,UTF8Format:u0}=Hl(),oc=r=>r;Pn.utf8=new u0({encode:function(r){return xe.isBuffer(r)?r.toString("utf8"):ArrayBuffer.isView(r)?a0.decode(r):String(r)},decode:oc,name:"utf8",createViewTranscoder(){return new Gl({encode:function(r){return ArrayBuffer.isView(r)?r:c0.encode(r)},decode:function(r){return a0.decode(r)},name:`${this.name}+view`})},createBufferTranscoder(){return new ns({encode:function(r){return xe.isBuffer(r)?r:ArrayBuffer.isView(r)?xe.from(r.buffer,r.byteOffset,r.byteLength):xe.from(String(r),"utf8")},decode:function(r){return r.toString("utf8")},name:`${this.name}+buffer`})}});Pn.json=new u0({encode:JSON.stringify,decode:JSON.parse,name:"json"});Pn.buffer=new ns({encode:function(r){return xe.isBuffer(r)?r:ArrayBuffer.isView(r)?xe.from(r.buffer,r.byteOffset,r.byteLength):xe.from(String(r),"utf8")},decode:oc,name:"buffer",createViewTranscoder(){return new Gl({encode:function(r){return ArrayBuffer.isView(r)?r:xe.from(String(r),"utf8")},decode:function(r){return xe.from(r.buffer,r.byteOffset,r.byteLength)},name:`${this.name}+view`})}});Pn.view=new Gl({encode:function(r){return ArrayBuffer.isView(r)?r:c0.encode(r)},decode:oc,name:"view",createBufferTranscoder(){return new ns({encode:function(r){return xe.isBuffer(r)?r:ArrayBuffer.isView(r)?xe.from(r.buffer,r.byteOffset,r.byteLength):xe.from(String(r),"utf8")},decode:oc,name:`${this.name}+buffer`})}});Pn.hex=new ns({encode:function(r){return xe.isBuffer(r)?r:xe.from(String(r),"hex")},decode:function(r){return r.toString("hex")},name:"hex"});Pn.base64=new ns({encode:function(r){return xe.isBuffer(r)?r:xe.from(String(r),"base64")},decode:function(r){return r.toString("base64")},name:"base64"})});var d0=b(h0=>{"use strict";a();var l0=Ct(),ac=f0(),{Encoding:rS}=ql(),{BufferFormat:nS,ViewFormat:iS,UTF8Format:oS}=Hl(),is=Symbol("formats"),sc=Symbol("encodings"),sS=new Set(["buffer","view","utf8"]),Jl=class{constructor(e){if(Array.isArray(e)){if(!e.every(t=>sS.has(t)))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}else throw new TypeError("The first argument 'formats' must be an array");this[sc]=new Map,this[is]=new Set(e);for(let t in ac)try{this.encoding(t)}catch(n){if(n.code!=="LEVEL_ENCODING_NOT_SUPPORTED")throw n}}encodings(){return Array.from(new Set(this[sc].values()))}encoding(e){let t=this[sc].get(e);if(t===void 0){if(typeof e=="string"&&e!==""){if(t=fS[e],!t)throw new l0(`Encoding '${e}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if(typeof e!="object"||e===null)throw new TypeError("First argument 'encoding' must be a string or object");t=aS(e)}let{name:n,format:i}=t;if(!this[is].has(i))if(this[is].has("view"))t=t.createViewTranscoder();else if(this[is].has("buffer"))t=t.createBufferTranscoder();else if(this[is].has("utf8"))t=t.createUTF8Transcoder();else throw new l0(`Encoding '${n}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});for(let o of[e,n,t.name,t.commonName])this[sc].set(o,t)}return t}};h0.Transcoder=Jl;function aS(r){if(r instanceof rS)return r;let e="type"in r&&typeof r.type=="string"?r.type:void 0,t=r.name||e||`anonymous-${lS++}`;switch(cS(r)){case"view":return new iS({...r,name:t});case"utf8":return new oS({...r,name:t});case"buffer":return new nS({...r,name:t});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}function cS(r){return"format"in r&&r.format!==void 0?r.format:"buffer"in r&&typeof r.buffer=="boolean"?r.buffer?"buffer":"utf8":"code"in r&&Number.isInteger(r.code)?"view":"buffer"}var uS={binary:ac.buffer,"utf-8":ac.utf8},fS={...ac,...uS},lS=0});var D0=b((qP,Ql)=>{"use strict";a();var Fi=typeof Reflect=="object"?Reflect:null,p0=Fi&&typeof Fi.apply=="function"?Fi.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},cc;Fi&&typeof Fi.ownKeys=="function"?cc=Fi.ownKeys:Object.getOwnPropertySymbols?cc=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:cc=function(e){return Object.getOwnPropertyNames(e)};function hS(r){console&&console.warn&&console.warn(r)}var m0=Number.isNaN||function(e){return e!==e};function q(){q.init.call(this)}Ql.exports=q;Ql.exports.once=mS;q.EventEmitter=q;q.prototype._events=void 0;q.prototype._eventsCount=0;q.prototype._maxListeners=void 0;var y0=10;function uc(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(q,"defaultMaxListeners",{enumerable:!0,get:function(){return y0},set:function(r){if(typeof r!="number"||r<0||m0(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");y0=r}});q.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};q.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||m0(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function g0(r){return r._maxListeners===void 0?q.defaultMaxListeners:r._maxListeners}q.prototype.getMaxListeners=function(){return g0(this)};q.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var c=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw c.context=s,c}var u=o[e];if(u===void 0)return!1;if(typeof u=="function")p0(u,this,t);else for(var f=u.length,l=v0(u,f),n=0;n<f;++n)p0(l[n],this,t);return!0};function w0(r,e,t,n){var i,o,s;if(uc(t),o=r._events,o===void 0?(o=r._events=Object.create(null),r._eventsCount=0):(o.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),o=r._events),s=o[e]),s===void 0)s=o[e]=t,++r._eventsCount;else if(typeof s=="function"?s=o[e]=n?[t,s]:[s,t]:n?s.unshift(t):s.push(t),i=g0(r),i>0&&s.length>i&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=r,c.type=e,c.count=s.length,hS(c)}return r}q.prototype.addListener=function(e,t){return w0(this,e,t,!1)};q.prototype.on=q.prototype.addListener;q.prototype.prependListener=function(e,t){return w0(this,e,t,!0)};function dS(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function b0(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=dS.bind(n);return i.listener=t,n.wrapFn=i,i}q.prototype.once=function(e,t){return uc(t),this.on(e,b0(this,e,t)),this};q.prototype.prependOnceListener=function(e,t){return uc(t),this.prependListener(e,b0(this,e,t)),this};q.prototype.removeListener=function(e,t){var n,i,o,s,c;if(uc(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(o=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){c=n[s].listener,o=s;break}if(o<0)return this;o===0?n.shift():pS(n,o),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,c||t)}return this};q.prototype.off=q.prototype.removeListener;q.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var o=Object.keys(n),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function E0(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?yS(i):v0(i,i.length)}q.prototype.listeners=function(e){return E0(this,e,!0)};q.prototype.rawListeners=function(e){return E0(this,e,!1)};q.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):x0.call(r,e)};q.prototype.listenerCount=x0;function x0(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}q.prototype.eventNames=function(){return this._eventsCount>0?cc(this._events):[]};function v0(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function pS(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function yS(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function mS(r,e){return new Promise(function(t,n){function i(s){r.removeListener(e,o),n(s)}function o(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}_0(r,e,o,{once:!0}),e!=="error"&&gS(r,i,{once:!0})})}function gS(r,e,t){typeof r.on=="function"&&_0(r,"error",e,t)}function _0(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(o){n.once&&r.removeEventListener(e,i),t(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}});var A0=b((KP,S0)=>{a();S0.exports=typeof queueMicrotask=="function"?queueMicrotask:r=>Promise.resolve().then(r)});var os=b(Yl=>{"use strict";a();var T0=A0();Yl.fromCallback=function(r,e){if(r===void 0){var t=new Promise(function(n,i){r=function(o,s){o?i(o):n(s)}});r[e!==void 0?e:"promise"]=t}else if(typeof r!="function")throw new TypeError("Callback must be a function");return r};Yl.fromPromise=function(r,e){if(e===void 0)return r;r.then(function(t){T0(()=>e(null,t))}).catch(function(t){T0(()=>e(t))})}});var fc=b(Xl=>{"use strict";a();Xl.getCallback=function(r,e){return typeof r=="function"?r:e};Xl.getOptions=function(r,e){return typeof r=="object"&&r!==null?r:e!==void 0?e:{}}});var Jr=b(pc=>{"use strict";a();var{fromCallback:Zl}=os(),Ge=Ct(),{getOptions:eh,getCallback:C0}=fc(),Fn=Symbol("promise"),Ui=Symbol("callback"),Kt=Symbol("working"),Un=Symbol("handleOne"),lr=Symbol("handleMany"),th=Symbol("autoClose"),Hr=Symbol("finishWork"),Wt=Symbol("returnMany"),Vr=Symbol("closing"),ss=Symbol("handleClose"),lc=Symbol("closed"),as=Symbol("closeCallbacks"),Wr=Symbol("keyEncoding"),$n=Symbol("valueEncoding"),rh=Symbol("abortOnClose"),hc=Symbol("legacy"),nh=Symbol("keys"),ih=Symbol("values"),Kr=Symbol("limit"),lt=Symbol("count"),dc=Object.freeze({}),wS=()=>{},I0=!1,cs=class{constructor(e,t,n){if(typeof e!="object"||e===null){let i=e===null?"null":typeof e;throw new TypeError(`The first argument must be an abstract-level database, received ${i}`)}if(typeof t!="object"||t===null)throw new TypeError("The second argument must be an options object");this[lc]=!1,this[as]=[],this[Kt]=!1,this[Vr]=!1,this[th]=!1,this[Ui]=null,this[Un]=this[Un].bind(this),this[lr]=this[lr].bind(this),this[ss]=this[ss].bind(this),this[Wr]=t[Wr],this[$n]=t[$n],this[hc]=n,this[Kr]=Number.isInteger(t.limit)&&t.limit>=0?t.limit:1/0,this[lt]=0,this[rh]=!!t.abortOnClose,this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get count(){return this[lt]}get limit(){return this[Kr]}next(e){let t;if(e===void 0)t=new Promise((n,i)=>{e=(o,s,c)=>{o?i(o):this[hc]?s===void 0&&c===void 0?n():n([s,c]):n(s)}});else if(typeof e!="function")throw new TypeError("Callback must be a function");return this[Vr]?this.nextTick(e,new Ge("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[Kt]?this.nextTick(e,new Ge("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[Kt]=!0,this[Ui]=e,this[lt]>=this[Kr]?this.nextTick(this[Un],null):this._next(this[Un])),t}_next(e){this.nextTick(e)}nextv(e,t,n){return n=C0(t,n),n=Zl(n,Fn),t=eh(t,dc),Number.isInteger(e)?(this[Vr]?this.nextTick(n,new Ge("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[Kt]?this.nextTick(n,new Ge("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(e<1&&(e=1),this[Kr]<1/0&&(e=Math.min(e,this[Kr]-this[lt])),this[Kt]=!0,this[Ui]=n,e<=0?this.nextTick(this[lr],null,[]):this._nextv(e,t,this[lr])),n[Fn]):(this.nextTick(n,new TypeError("The first argument 'size' must be an integer")),n[Fn])}_nextv(e,t,n){let i=[],o=(s,c,u)=>{if(s)return n(s);if(this[hc]?c===void 0&&u===void 0:c===void 0)return n(null,i);i.push(this[hc]?[c,u]:c),i.length===e?n(null,i):this._next(o)};this._next(o)}all(e,t){return t=C0(e,t),t=Zl(t,Fn),e=eh(e,dc),this[Vr]?this.nextTick(t,new Ge("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[Kt]?this.nextTick(t,new Ge("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[Kt]=!0,this[Ui]=t,this[th]=!0,this[lt]>=this[Kr]?this.nextTick(this[lr],null,[]):this._all(e,this[lr])),t[Fn]}_all(e,t){let n=this[lt],i=[],o=()=>{let c=this[Kr]<1/0?Math.min(1e3,this[Kr]-n):1e3;c<=0?this.nextTick(t,null,i):this._nextv(c,dc,s)},s=(c,u)=>{c?t(c):u.length===0?t(null,i):(i.push.apply(i,u),n+=u.length,o())};o()}[Hr](){let e=this[Ui];return this[rh]&&e===null?wS:(this[Kt]=!1,this[Ui]=null,this[Vr]&&this._close(this[ss]),e)}[Wt](e,t,n){this[th]?this.close(e.bind(null,t,n)):e(t,n)}seek(e,t){if(t=eh(t,dc),!this[Vr]){if(this[Kt])throw new Ge("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{let n=this.db.keyEncoding(t.keyEncoding||this[Wr]),i=n.format;t.keyEncoding!==i&&(t={...t,keyEncoding:i});let o=this.db.prefixKey(n.encode(e),i);this._seek(o,t)}}}_seek(e,t){throw new Ge("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(e){return e=Zl(e,Fn),this[lc]?this.nextTick(e):this[Vr]?this[as].push(e):(this[Vr]=!0,this[as].push(e),this[Kt]?this[rh]&&this[Hr]()(new Ge("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this._close(this[ss])),e[Fn]}_close(e){this.nextTick(e)}[ss](){this[lc]=!0,this.db.detachResource(this);let e=this[as];this[as]=[];for(let t of e)t()}async*[Symbol.asyncIterator](){try{let e;for(;(e=await this.next())!==void 0;)yield e}finally{this[lc]||await this.close()}}},$i=class extends cs{constructor(e,t){super(e,t,!0),this[nh]=t.keys!==!1,this[ih]=t.values!==!1}[Un](e,t,n){let i=this[Hr]();if(e)return i(e);try{t=this[nh]&&t!==void 0?this[Wr].decode(t):void 0,n=this[ih]&&n!==void 0?this[$n].decode(n):void 0}catch(o){return i(new Gr("entry",o))}t===void 0&&n===void 0||this[lt]++,i(null,t,n)}[lr](e,t){let n=this[Hr]();if(e)return this[Wt](n,e);try{for(let i of t){let o=i[0],s=i[1];i[0]=this[nh]&&o!==void 0?this[Wr].decode(o):void 0,i[1]=this[ih]&&s!==void 0?this[$n].decode(s):void 0}}catch(i){return this[Wt](n,new Gr("entries",i))}this[lt]+=t.length,this[Wt](n,null,t)}end(e){return!I0&&typeof console<"u"&&(I0=!0,console.warn(new Ge("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(e)}},oh=class extends cs{constructor(e,t){super(e,t,!1)}[Un](e,t){let n=this[Hr]();if(e)return n(e);try{t=t!==void 0?this[Wr].decode(t):void 0}catch(i){return n(new Gr("key",i))}t!==void 0&&this[lt]++,n(null,t)}[lr](e,t){let n=this[Hr]();if(e)return this[Wt](n,e);try{for(let i=0;i<t.length;i++){let o=t[i];t[i]=o!==void 0?this[Wr].decode(o):void 0}}catch(i){return this[Wt](n,new Gr("keys",i))}this[lt]+=t.length,this[Wt](n,null,t)}},sh=class extends cs{constructor(e,t){super(e,t,!1)}[Un](e,t){let n=this[Hr]();if(e)return n(e);try{t=t!==void 0?this[$n].decode(t):void 0}catch(i){return n(new Gr("value",i))}t!==void 0&&this[lt]++,n(null,t)}[lr](e,t){let n=this[Hr]();if(e)return this[Wt](n,e);try{for(let i=0;i<t.length;i++){let o=t[i];t[i]=o!==void 0?this[$n].decode(o):void 0}}catch(i){return this[Wt](n,new Gr("values",i))}this[lt]+=t.length,this[Wt](n,null,t)}},Gr=class extends Ge{constructor(e,t){super(`Iterator could not decode ${e}`,{code:"LEVEL_DECODE_ERROR",cause:t})}};for(let r of["_ended property","_nexting property","_end method"])Object.defineProperty($i.prototype,r.split(" ")[0],{get(){throw new Ge(`The ${r} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new Ge(`The ${r} has been removed`,{code:"LEVEL_LEGACY"})}});$i.keyEncoding=Wr;$i.valueEncoding=$n;pc.AbstractIterator=$i;pc.AbstractKeyIterator=oh;pc.AbstractValueIterator=sh});var O0=b(ah=>{"use strict";a();var{AbstractKeyIterator:bS,AbstractValueIterator:ES}=Jr(),Mn=Symbol("iterator"),us=Symbol("callback"),Mi=Symbol("handleOne"),jn=Symbol("handleMany"),fs=class extends bS{constructor(e,t){super(e,t),this[Mn]=e.iterator({...t,keys:!0,values:!1}),this[Mi]=this[Mi].bind(this),this[jn]=this[jn].bind(this)}},yc=class extends ES{constructor(e,t){super(e,t),this[Mn]=e.iterator({...t,keys:!1,values:!0}),this[Mi]=this[Mi].bind(this),this[jn]=this[jn].bind(this)}};for(let r of[fs,yc]){let e=r===fs,t=e?n=>n[0]:n=>n[1];r.prototype._next=function(n){this[us]=n,this[Mn].next(this[Mi])},r.prototype[Mi]=function(n,i,o){let s=this[us];n?s(n):s(null,e?i:o)},r.prototype._nextv=function(n,i,o){this[us]=o,this[Mn].nextv(n,i,this[jn])},r.prototype._all=function(n,i){this[us]=i,this[Mn].all(n,this[jn])},r.prototype[jn]=function(n,i){let o=this[us];n?o(n):o(null,i.map(t))},r.prototype._seek=function(n,i){this[Mn].seek(n,i)},r.prototype._close=function(n){this[Mn].close(n)}}ah.DefaultKeyIterator=fs;ah.DefaultValueIterator=yc});var B0=b(xc=>{"use strict";a();var{AbstractIterator:xS,AbstractKeyIterator:vS,AbstractValueIterator:_S}=Jr(),ch=Ct(),Ue=Symbol("nut"),bc=Symbol("undefer"),Ec=Symbol("factory"),mc=class extends xS{constructor(e,t){super(e,t),this[Ue]=null,this[Ec]=()=>e.iterator(t),this.db.defer(()=>this[bc]())}},gc=class extends vS{constructor(e,t){super(e,t),this[Ue]=null,this[Ec]=()=>e.keys(t),this.db.defer(()=>this[bc]())}},wc=class extends _S{constructor(e,t){super(e,t),this[Ue]=null,this[Ec]=()=>e.values(t),this.db.defer(()=>this[bc]())}};for(let r of[mc,gc,wc])r.prototype[bc]=function(){this.db.status==="open"&&(this[Ue]=this[Ec]())},r.prototype._next=function(e){this[Ue]!==null?this[Ue].next(e):this.db.status==="opening"?this.db.defer(()=>this._next(e)):this.nextTick(e,new ch("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},r.prototype._nextv=function(e,t,n){this[Ue]!==null?this[Ue].nextv(e,t,n):this.db.status==="opening"?this.db.defer(()=>this._nextv(e,t,n)):this.nextTick(n,new ch("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},r.prototype._all=function(e,t){this[Ue]!==null?this[Ue].all(t):this.db.status==="opening"?this.db.defer(()=>this._all(e,t)):this.nextTick(t,new ch("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},r.prototype._seek=function(e,t){this[Ue]!==null?this[Ue]._seek(e,t):this.db.status==="opening"&&this.db.defer(()=>this._seek(e,t))},r.prototype._close=function(e){this[Ue]!==null?this[Ue].close(e):this.db.status==="opening"?this.db.defer(()=>this._close(e)):this.nextTick(e)};xc.DeferredIterator=mc;xc.DeferredKeyIterator=gc;xc.DeferredValueIterator=wc});var fh=b(L0=>{"use strict";a();var{fromCallback:k0}=os(),vc=Ct(),{getCallback:DS,getOptions:SS}=fc(),_c=Symbol("promise"),ht=Symbol("status"),ji=Symbol("operations"),ls=Symbol("finishClose"),zi=Symbol("closeCallbacks"),uh=class{constructor(e){if(typeof e!="object"||e===null){let t=e===null?"null":typeof e;throw new TypeError(`The first argument must be an abstract-level database, received ${t}`)}this[ji]=[],this[zi]=[],this[ht]="open",this[ls]=this[ls].bind(this),this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get length(){return this[ji].length}put(e,t,n){if(this[ht]!=="open")throw new vc("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});let i=this.db._checkKey(e)||this.db._checkValue(t);if(i)throw i;let o=n&&n.sublevel!=null?n.sublevel:this.db,s=n,c=o.keyEncoding(n&&n.keyEncoding),u=o.valueEncoding(n&&n.valueEncoding),f=c.format;n={...n,keyEncoding:f,valueEncoding:u.format},o!==this.db&&(n.sublevel=null);let l=o.prefixKey(c.encode(e),f),h=u.encode(t);return this._put(l,h,n),this[ji].push({...s,type:"put",key:e,value:t}),this}_put(e,t,n){}del(e,t){if(this[ht]!=="open")throw new vc("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});let n=this.db._checkKey(e);if(n)throw n;let i=t&&t.sublevel!=null?t.sublevel:this.db,o=t,s=i.keyEncoding(t&&t.keyEncoding),c=s.format;return t={...t,keyEncoding:c},i!==this.db&&(t.sublevel=null),this._del(i.prefixKey(s.encode(e),c),t),this[ji].push({...o,type:"del",key:e}),this}_del(e,t){}clear(){if(this[ht]!=="open")throw new vc("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[ji]=[],this}_clear(){}write(e,t){return t=DS(e,t),t=k0(t,_c),e=SS(e),this[ht]!=="open"?this.nextTick(t,new vc("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):this.length===0?this.close(t):(this[ht]="writing",this._write(e,n=>{this[ht]="closing",this[zi].push(()=>t(n)),n||this.db.emit("batch",this[ji]),this._close(this[ls])})),t[_c]}_write(e,t){}close(e){return e=k0(e,_c),this[ht]==="closing"?this[zi].push(e):this[ht]==="closed"?this.nextTick(e):(this[zi].push(e),this[ht]!=="writing"&&(this[ht]="closing",this._close(this[ls]))),e[_c]}_close(e){this.nextTick(e)}[ls](){this[ht]="closed",this.db.detachResource(this);let e=this[zi];this[zi]=[];for(let t of e)t()}};L0.AbstractChainedBatch=uh});var N0=b(R0=>{"use strict";a();var{AbstractChainedBatch:AS}=fh(),TS=Ct(),qi=Symbol("encoded"),lh=class extends AS{constructor(e){super(e),this[qi]=[]}_put(e,t,n){this[qi].push({...n,type:"put",key:e,value:t})}_del(e,t){this[qi].push({...t,type:"del",key:e})}_clear(){this[qi]=[]}_write(e,t){this.db.status==="opening"?this.db.defer(()=>this._write(e,t)):this.db.status==="open"?this[qi].length===0?this.nextTick(t):this.db._batch(this[qi],e,t):this.nextTick(t,new TS("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}};R0.DefaultChainedBatch=lh});var U0=b((aF,F0)=>{"use strict";a();var P0=Ct(),CS=Object.prototype.hasOwnProperty,IS=new Set(["lt","lte","gt","gte"]);F0.exports=function(r,e){let t={};for(let n in r)if(!!CS.call(r,n)&&!(n==="keyEncoding"||n==="valueEncoding")){if(n==="start"||n==="end")throw new P0(`The legacy range option '${n}' has been removed`,{code:"LEVEL_LEGACY"});if(n==="encoding")throw new P0("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});IS.has(n)?t[n]=e.encode(r[n]):t[n]=r[n]}return t.reverse=!!t.reverse,t.limit=Number.isInteger(t.limit)&&t.limit>=0?t.limit:-1,t}});var hh=b((uF,M0)=>{a();var $0;M0.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:global):r=>($0||($0=Promise.resolve())).then(r).catch(e=>setTimeout(()=>{throw e},0))});var q0=b((lF,z0)=>{"use strict";a();var j0=hh();z0.exports=function(r,...e){e.length===0?j0(r):j0(()=>r(...e))}});var V0=b(Dc=>{"use strict";a();var{AbstractIterator:OS,AbstractKeyIterator:BS,AbstractValueIterator:kS}=Jr(),Vi=Symbol("unfix"),It=Symbol("iterator"),zn=Symbol("handleOne"),Qr=Symbol("handleMany"),hr=Symbol("callback"),hs=class extends OS{constructor(e,t,n,i){super(e,t),this[It]=n,this[Vi]=i,this[zn]=this[zn].bind(this),this[Qr]=this[Qr].bind(this),this[hr]=null}[zn](e,t,n){let i=this[hr];if(e)return i(e);t!==void 0&&(t=this[Vi](t)),i(e,t,n)}[Qr](e,t){let n=this[hr];if(e)return n(e);for(let i of t){let o=i[0];o!==void 0&&(i[0]=this[Vi](o))}n(e,t)}},ds=class extends BS{constructor(e,t,n,i){super(e,t),this[It]=n,this[Vi]=i,this[zn]=this[zn].bind(this),this[Qr]=this[Qr].bind(this),this[hr]=null}[zn](e,t){let n=this[hr];if(e)return n(e);t!==void 0&&(t=this[Vi](t)),n(e,t)}[Qr](e,t){let n=this[hr];if(e)return n(e);for(let i=0;i<t.length;i++){let o=t[i];o!==void 0&&(t[i]=this[Vi](o))}n(e,t)}},ps=class extends kS{constructor(e,t,n){super(e,t),this[It]=n}};for(let r of[hs,ds])r.prototype._next=function(e){this[hr]=e,this[It].next(this[zn])},r.prototype._nextv=function(e,t,n){this[hr]=n,this[It].nextv(e,t,this[Qr])},r.prototype._all=function(e,t){this[hr]=t,this[It].all(e,this[Qr])};for(let r of[ps])r.prototype._next=function(e){this[It].next(e)},r.prototype._nextv=function(e,t,n){this[It].nextv(e,t,n)},r.prototype._all=function(e,t){this[It].all(e,t)};for(let r of[hs,ds,ps])r.prototype._seek=function(e,t){this[It].seek(e,t)},r.prototype._close=function(e){this[It].close(e)};Dc.AbstractSublevelIterator=hs;Dc.AbstractSublevelKeyIterator=ds;Dc.AbstractSublevelValueIterator=ps});var G0=b((yF,H0)=>{"use strict";a();var dh=Ct(),{Buffer:mh}=so()||{},{AbstractSublevelIterator:LS,AbstractSublevelKeyIterator:RS,AbstractSublevelValueIterator:NS}=V0(),dr=Symbol("prefix"),K0=Symbol("upperBound"),ys=Symbol("prefixRange"),Je=Symbol("parent"),ph=Symbol("unfix"),W0=new TextEncoder,PS={separator:"!"};H0.exports=function({AbstractLevel:r}){class e extends r{static defaults(n){if(typeof n=="string")throw new dh("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(n&&n.open)throw new dh("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return n==null?PS:n.separator?n:{...n,separator:"!"}}constructor(n,i,o){let{separator:s,manifest:c,...u}=e.defaults(o);i=US(i,s);let f=s.charCodeAt(0)+1,l=n[Je]||n;if(!W0.encode(i).every(w=>w>f&&w<127))throw new dh(`Prefix must use bytes > ${f} < ${127}`,{code:"LEVEL_INVALID_PREFIX"});super(FS(l,c),u);let h=(n.prefix||"")+s+i+s,d=h.slice(0,-1)+String.fromCharCode(f);this[Je]=l,this[dr]=new Sc(h),this[K0]=new Sc(d),this[ph]=new gh,this.nextTick=l.nextTick}prefixKey(n,i){if(i==="utf8")return this[dr].utf8+n;if(n.byteLength===0)return this[dr][i];if(i==="view"){let o=this[dr].view,s=new Uint8Array(o.byteLength+n.byteLength);return s.set(o,0),s.set(n,o.byteLength),s}else{let o=this[dr].buffer;return mh.concat([o,n],o.byteLength+n.byteLength)}}[ys](n,i){n.gte!==void 0?n.gte=this.prefixKey(n.gte,i):n.gt!==void 0?n.gt=this.prefixKey(n.gt,i):n.gte=this[dr][i],n.lte!==void 0?n.lte=this.prefixKey(n.lte,i):n.lt!==void 0?n.lt=this.prefixKey(n.lt,i):n.lte=this[K0][i]}get prefix(){return this[dr].utf8}get db(){return this[Je]}_open(n,i){this[Je].open({passive:!0},i)}_put(n,i,o,s){this[Je].put(n,i,o,s)}_get(n,i,o){this[Je].get(n,i,o)}_getMany(n,i,o){this[Je].getMany(n,i,o)}_del(n,i,o){this[Je].del(n,i,o)}_batch(n,i,o){this[Je].batch(n,i,o)}_clear(n,i){this[ys](n,n.keyEncoding),this[Je].clear(n,i)}_iterator(n){this[ys](n,n.keyEncoding);let i=this[Je].iterator(n),o=this[ph].get(this[dr].utf8.length,n.keyEncoding);return new LS(this,n,i,o)}_keys(n){this[ys](n,n.keyEncoding);let i=this[Je].keys(n),o=this[ph].get(this[dr].utf8.length,n.keyEncoding);return new RS(this,n,i,o)}_values(n){this[ys](n,n.keyEncoding);let i=this[Je].values(n);return new NS(this,n,i)}}return{AbstractSublevel:e}};var FS=function(r,e){return{...r.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...e,encodings:{utf8:yh(r,"utf8"),buffer:yh(r,"buffer"),view:yh(r,"view")}}},yh=function(r,e){return r.supports.encodings[e]?r.keyEncoding(e).name===e:!1},Sc=class{constructor(e){this.utf8=e,this.view=W0.encode(e),this.buffer=mh?mh.from(this.view.buffer,0,this.view.byteLength):{}}},gh=class{constructor(){this.cache=new Map}get(e,t){let n=this.cache.get(t);return n===void 0&&(t==="view"?n=function(i,o){return o.subarray(i)}.bind(null,e):n=function(i,o){return o.slice(i)}.bind(null,e),this.cache.set(t,n)),n}},US=function(r,e){let t=0,n=r.length;for(;t<n&&r[t]===e;)t++;for(;n>t&&r[n-1]===e;)n--;return r.slice(t,n)}});var vh=b(xh=>{"use strict";a();var{supports:$S}=n0(),{Transcoder:MS}=d0(),{EventEmitter:jS}=D0(),{fromCallback:Yr}=os(),Ot=Ct(),{AbstractIterator:qn}=Jr(),{DefaultKeyIterator:zS,DefaultValueIterator:qS}=O0(),{DeferredIterator:VS,DeferredKeyIterator:KS,DeferredValueIterator:WS}=B0(),{DefaultChainedBatch:J0}=N0(),{getCallback:Vn,getOptions:Xr}=fc(),Ac=U0(),O=Symbol("promise"),pr=Symbol("landed"),Kn=Symbol("resources"),wh=Symbol("closeResources"),ms=Symbol("operations"),gs=Symbol("undefer"),Tc=Symbol("deferOpen"),Q0=Symbol("options"),R=Symbol("status"),Wn=Symbol("defaultOptions"),Ki=Symbol("transcoder"),Cc=Symbol("keyEncoding"),bh=Symbol("valueEncoding"),HS=()=>{},ws=class extends jS{constructor(e,t){if(super(),typeof e!="object"||e===null)throw new TypeError("The first argument 'manifest' must be an object");t=Xr(t);let{keyEncoding:n,valueEncoding:i,passive:o,...s}=t;this[Kn]=new Set,this[ms]=[],this[Tc]=!0,this[Q0]=s,this[R]="opening",this.supports=$S(e,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:e.snapshots!==!1,permanence:e.permanence!==!1,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:e.encodings||{},events:Object.assign({},e.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[Ki]=new MS(GS(this)),this[Cc]=this[Ki].encoding(n||"utf8"),this[bh]=this[Ki].encoding(i||"utf8");for(let c of this[Ki].encodings())this.supports.encodings[c.commonName]||(this.supports.encodings[c.commonName]=!0);this[Wn]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[Cc].commonName,valueEncoding:this[bh].commonName}),key:Object.freeze({keyEncoding:this[Cc].commonName})},this.nextTick(()=>{this[Tc]&&this.open({passive:!1},HS)})}get status(){return this[R]}keyEncoding(e){return this[Ki].encoding(e??this[Cc])}valueEncoding(e){return this[Ki].encoding(e??this[bh])}open(e,t){t=Vn(e,t),t=Yr(t,O),e={...this[Q0],...Xr(e)},e.createIfMissing=e.createIfMissing!==!1,e.errorIfExists=!!e.errorIfExists;let n=i=>{this[R]==="closing"||this[R]==="opening"?this.once(pr,i?()=>n(i):n):this[R]!=="open"?t(new Ot("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:i})):t()};return e.passive?this[R]==="opening"?this.once(pr,n):this.nextTick(n):this[R]==="closed"||this[Tc]?(this[Tc]=!1,this[R]="opening",this.emit("opening"),this._open(e,i=>{if(i){this[R]="closed",this[wh](()=>{this.emit(pr),n(i)}),this[gs]();return}this[R]="open",this[gs](),this.emit(pr),this[R]==="open"&&this.emit("open"),this[R]==="open"&&this.emit("ready"),n()})):this[R]==="open"?this.nextTick(n):this.once(pr,()=>this.open(e,t)),t[O]}_open(e,t){this.nextTick(t)}close(e){e=Yr(e,O);let t=n=>{this[R]==="opening"||this[R]==="closing"?this.once(pr,n?t(n):t):this[R]!=="closed"?e(new Ot("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:n})):e()};if(this[R]==="open"){this[R]="closing",this.emit("closing");let n=i=>{this[R]="open",this[gs](),this.emit(pr),t(i)};this[wh](()=>{this._close(i=>{if(i)return n(i);this[R]="closed",this[gs](),this.emit(pr),this[R]==="closed"&&this.emit("closed"),t()})})}else this[R]==="closed"?this.nextTick(t):this.once(pr,()=>this.close(e));return e[O]}[wh](e){if(this[Kn].size===0)return this.nextTick(e);let t=this[Kn].size,n=!0,i=()=>{--t===0&&(n?this.nextTick(e):e())};for(let o of this[Kn])o.close(i);n=!1,this[Kn].clear()}_close(e){this.nextTick(e)}get(e,t,n){if(n=Vn(t,n),n=Yr(n,O),t=Xr(t,this[Wn].entry),this[R]==="opening")return this.defer(()=>this.get(e,t,n)),n[O];if(Wi(this,n))return n[O];let i=this._checkKey(e);if(i)return this.nextTick(n,i),n[O];let o=this.keyEncoding(t.keyEncoding),s=this.valueEncoding(t.valueEncoding),c=o.format,u=s.format;return(t.keyEncoding!==c||t.valueEncoding!==u)&&(t=Object.assign({},t,{keyEncoding:c,valueEncoding:u})),this._get(this.prefixKey(o.encode(e),c),t,(f,l)=>{if(f)return(f.code==="LEVEL_NOT_FOUND"||f.notFound||/NotFound/i.test(f))&&(f.code||(f.code="LEVEL_NOT_FOUND"),f.notFound||(f.notFound=!0),f.status||(f.status=404)),n(f);try{l=s.decode(l)}catch(h){return n(new Ot("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:h}))}n(null,l)}),n[O]}_get(e,t,n){this.nextTick(n,new Error("NotFound"))}getMany(e,t,n){if(n=Vn(t,n),n=Yr(n,O),t=Xr(t,this[Wn].entry),this[R]==="opening")return this.defer(()=>this.getMany(e,t,n)),n[O];if(Wi(this,n))return n[O];if(!Array.isArray(e))return this.nextTick(n,new TypeError("The first argument 'keys' must be an array")),n[O];if(e.length===0)return this.nextTick(n,null,[]),n[O];let i=this.keyEncoding(t.keyEncoding),o=this.valueEncoding(t.valueEncoding),s=i.format,c=o.format;(t.keyEncoding!==s||t.valueEncoding!==c)&&(t=Object.assign({},t,{keyEncoding:s,valueEncoding:c}));let u=new Array(e.length);for(let f=0;f<e.length;f++){let l=e[f],h=this._checkKey(l);if(h)return this.nextTick(n,h),n[O];u[f]=this.prefixKey(i.encode(l),s)}return this._getMany(u,t,(f,l)=>{if(f)return n(f);try{for(let h=0;h<l.length;h++)l[h]!==void 0&&(l[h]=o.decode(l[h]))}catch(h){return n(new Ot(`Could not decode one or more of ${l.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:h}))}n(null,l)}),n[O]}_getMany(e,t,n){this.nextTick(n,null,new Array(e.length).fill(void 0))}put(e,t,n,i){if(i=Vn(n,i),i=Yr(i,O),n=Xr(n,this[Wn].entry),this[R]==="opening")return this.defer(()=>this.put(e,t,n,i)),i[O];if(Wi(this,i))return i[O];let o=this._checkKey(e)||this._checkValue(t);if(o)return this.nextTick(i,o),i[O];let s=this.keyEncoding(n.keyEncoding),c=this.valueEncoding(n.valueEncoding),u=s.format,f=c.format;(n.keyEncoding!==u||n.valueEncoding!==f)&&(n=Object.assign({},n,{keyEncoding:u,valueEncoding:f}));let l=this.prefixKey(s.encode(e),u),h=c.encode(t);return this._put(l,h,n,d=>{if(d)return i(d);this.emit("put",e,t),i()}),i[O]}_put(e,t,n,i){this.nextTick(i)}del(e,t,n){if(n=Vn(t,n),n=Yr(n,O),t=Xr(t,this[Wn].key),this[R]==="opening")return this.defer(()=>this.del(e,t,n)),n[O];if(Wi(this,n))return n[O];let i=this._checkKey(e);if(i)return this.nextTick(n,i),n[O];let o=this.keyEncoding(t.keyEncoding),s=o.format;return t.keyEncoding!==s&&(t=Object.assign({},t,{keyEncoding:s})),this._del(this.prefixKey(o.encode(e),s),t,c=>{if(c)return n(c);this.emit("del",e),n()}),n[O]}_del(e,t,n){this.nextTick(n)}batch(e,t,n){if(!arguments.length){if(this[R]==="opening")return new J0(this);if(this[R]!=="open")throw new Ot("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(typeof e=="function"?n=e:n=Vn(t,n),n=Yr(n,O),t=Xr(t,this[Wn].empty),this[R]==="opening")return this.defer(()=>this.batch(e,t,n)),n[O];if(Wi(this,n))return n[O];if(!Array.isArray(e))return this.nextTick(n,new TypeError("The first argument 'operations' must be an array")),n[O];if(e.length===0)return this.nextTick(n),n[O];let i=new Array(e.length),{keyEncoding:o,valueEncoding:s,...c}=t;for(let u=0;u<e.length;u++){if(typeof e[u]!="object"||e[u]===null)return this.nextTick(n,new TypeError("A batch operation must be an object")),n[O];let f=Object.assign({},e[u]);if(f.type!=="put"&&f.type!=="del")return this.nextTick(n,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),n[O];let l=this._checkKey(f.key);if(l)return this.nextTick(n,l),n[O];let h=f.sublevel!=null?f.sublevel:this,d=h.keyEncoding(f.keyEncoding||o),w=d.format;if(f.key=h.prefixKey(d.encode(f.key),w),f.keyEncoding=w,f.type==="put"){let g=this._checkValue(f.value);if(g)return this.nextTick(n,g),n[O];let m=h.valueEncoding(f.valueEncoding||s);f.value=m.encode(f.value),f.valueEncoding=m.format}h!==this&&(f.sublevel=null),i[u]=f}return this._batch(i,c,u=>{if(u)return n(u);this.emit("batch",e),n()}),n[O]}_batch(e,t,n){this.nextTick(n)}sublevel(e,t){return this._sublevel(e,Eh.defaults(t))}_sublevel(e,t){return new Eh(this,e,t)}prefixKey(e,t){return e}clear(e,t){if(t=Vn(e,t),t=Yr(t,O),e=Xr(e,this[Wn].empty),this[R]==="opening")return this.defer(()=>this.clear(e,t)),t[O];if(Wi(this,t))return t[O];let n=e,i=this.keyEncoding(e.keyEncoding);return e=Ac(e,i),e.keyEncoding=i.format,e.limit===0?this.nextTick(t):this._clear(e,o=>{if(o)return t(o);this.emit("clear",n),t()}),t[O]}_clear(e,t){this.nextTick(t)}iterator(e){let t=this.keyEncoding(e&&e.keyEncoding),n=this.valueEncoding(e&&e.valueEncoding);if(e=Ac(e,t),e.keys=e.keys!==!1,e.values=e.values!==!1,e[qn.keyEncoding]=t,e[qn.valueEncoding]=n,e.keyEncoding=t.format,e.valueEncoding=n.format,this[R]==="opening")return new VS(this,e);if(this[R]!=="open")throw new Ot("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(e)}_iterator(e){return new qn(this,e)}keys(e){let t=this.keyEncoding(e&&e.keyEncoding),n=this.valueEncoding(e&&e.valueEncoding);if(e=Ac(e,t),e[qn.keyEncoding]=t,e[qn.valueEncoding]=n,e.keyEncoding=t.format,e.valueEncoding=n.format,this[R]==="opening")return new KS(this,e);if(this[R]!=="open")throw new Ot("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(e)}_keys(e){return new zS(this,e)}values(e){let t=this.keyEncoding(e&&e.keyEncoding),n=this.valueEncoding(e&&e.valueEncoding);if(e=Ac(e,t),e[qn.keyEncoding]=t,e[qn.valueEncoding]=n,e.keyEncoding=t.format,e.valueEncoding=n.format,this[R]==="opening")return new WS(this,e);if(this[R]!=="open")throw new Ot("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(e)}_values(e){return new qS(this,e)}defer(e){if(typeof e!="function")throw new TypeError("The first argument must be a function");this[ms].push(e)}[gs](){if(this[ms].length===0)return;let e=this[ms];this[ms]=[];for(let t of e)t()}attachResource(e){if(typeof e!="object"||e===null||typeof e.close!="function")throw new TypeError("The first argument must be a resource object");this[Kn].add(e)}detachResource(e){this[Kn].delete(e)}_chainedBatch(){return new J0(this)}_checkKey(e){if(e==null)return new Ot("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(e){if(e==null)return new Ot("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}};ws.prototype.nextTick=q0();var{AbstractSublevel:Eh}=G0()({AbstractLevel:ws});xh.AbstractLevel=ws;xh.AbstractSublevel=Eh;var Wi=function(r,e){return r[R]!=="open"?(r.nextTick(e,new Ot("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0):!1},GS=function(r){return Object.keys(r.supports.encodings).filter(e=>!!r.supports.encodings[e])}});var _h=b(Hn=>{"use strict";a();Hn.AbstractLevel=vh().AbstractLevel;Hn.AbstractSublevel=vh().AbstractSublevel;Hn.AbstractIterator=Jr().AbstractIterator;Hn.AbstractKeyIterator=Jr().AbstractKeyIterator;Hn.AbstractValueIterator=Jr().AbstractValueIterator;Hn.AbstractChainedBatch=fh().AbstractChainedBatch});var X0=b((xF,Y0)=>{a();Y0.exports=QS;var JS=hh();function QS(r,e,t){if(typeof e!="number")throw new Error("second argument must be a Number");let n,i,o,s,c,u=!0,f;Array.isArray(r)?(n=[],o=i=r.length):(s=Object.keys(r),n={},o=i=s.length);function l(d){function w(){t&&t(d,n),t=null}u?JS(w):w()}function h(d,w,g){if(n[d]=g,w&&(c=!0),--o===0||w)l(w);else if(!c&&f<i){let m;s?(m=s[f],f+=1,r[m](function(I,U){h(m,I,U)})):(m=f,f+=1,r[m](function(I,U){h(m,I,U)}))}}f=e,o?s?s.some(function(d,w){return r[d](function(g,m){h(d,g,m)}),w===e-1}):r.some(function(d,w){return d(function(g,m){h(w,g,m)}),w===e-1}):l(null),u=!1}});var Dh=b((_F,Z0)=>{"use strict";a();Z0.exports=function(e){let t=e.gte!==void 0?e.gte:e.gt!==void 0?e.gt:void 0,n=e.lte!==void 0?e.lte:e.lt!==void 0?e.lt:void 0,i=e.gte===void 0,o=e.lte===void 0;return t!==void 0&&n!==void 0?IDBKeyRange.bound(t,n,i,o):t!==void 0?IDBKeyRange.lowerBound(t,i):n!==void 0?IDBKeyRange.upperBound(n,o):null}});var Sh=b((SF,eE)=>{"use strict";a();var YS=new TextEncoder;eE.exports=function(r){return r instanceof Uint8Array?r:r instanceof ArrayBuffer?new Uint8Array(r):YS.encode(r)}});var oE=b(iE=>{"use strict";a();var{AbstractIterator:XS}=_h(),tE=Dh(),Ic=Sh(),Ht=Symbol("cache"),yr=Symbol("finished"),Qe=Symbol("options"),mr=Symbol("currentOptions"),Gn=Symbol("position"),Ah=Symbol("location"),Hi=Symbol("first"),rE={},Th=class extends XS{constructor(e,t,n){super(e,n),this[Ht]=[],this[yr]=this.limit===0,this[Qe]=n,this[mr]={...n},this[Gn]=void 0,this[Ah]=t,this[Hi]=!0}_nextv(e,t,n){if(this[Hi]=!1,this[yr])return this.nextTick(n,null,[]);if(this[Ht].length>0)return e=Math.min(e,this[Ht].length),this.nextTick(n,null,this[Ht].splice(0,e));this[Gn]!==void 0&&(this[Qe].reverse?(this[mr].lt=this[Gn],this[mr].lte=void 0):(this[mr].gt=this[Gn],this[mr].gte=void 0));let i;try{i=tE(this[mr])}catch{return this[yr]=!0,this.nextTick(n,null,[])}let o=this.db.db.transaction([this[Ah]],"readonly"),s=o.objectStore(this[Ah]),c=[];if(this[Qe].reverse){let u=!this[Qe].values&&s.openKeyCursor?"openKeyCursor":"openCursor";s[u](i,"prev").onsuccess=f=>{let l=f.target.result;if(l){let{key:h,value:d}=l;this[Gn]=h,c.push([this[Qe].keys&&h!==void 0?Ic(h):void 0,this[Qe].values&&d!==void 0?Ic(d):void 0]),c.length<e?l.continue():nE(o)}else this[yr]=!0}}else{let u,f,l=()=>{if(u===void 0||f===void 0)return;let h=Math.max(u.length,f.length);h===0||e===1/0?this[yr]=!0:this[Gn]=u[h-1],c.length=h;for(let d=0;d<h;d++){let w=u[d],g=f[d];c[d]=[this[Qe].keys&&w!==void 0?Ic(w):void 0,this[Qe].values&&g!==void 0?Ic(g):void 0]}nE(o)};this[Qe].keys||e<1/0?s.getAllKeys(i,e<1/0?e:void 0).onsuccess=h=>{u=h.target.result,l()}:(u=[],this.nextTick(l)),this[Qe].values?s.getAll(i,e<1/0?e:void 0).onsuccess=h=>{f=h.target.result,l()}:(f=[],this.nextTick(l))}o.onabort=()=>{n(o.error||new Error("aborted by user")),n=null},o.oncomplete=()=>{n(null,c),n=null}}_next(e){if(this[Ht].length>0){let[t,n]=this[Ht].shift();this.nextTick(e,null,t,n)}else if(this[yr])this.nextTick(e);else{let t=Math.min(100,this.limit-this.count);this[Hi]&&(this[Hi]=!1,t=1),this._nextv(t,rE,(n,i)=>{if(n)return e(n);this[Ht]=i,this._next(e)})}}_all(e,t){this[Hi]=!1;let n=this[Ht].splice(0,this[Ht].length),i=this.limit-this.count-n.length;if(i<=0)return this.nextTick(t,null,n);this._nextv(i,rE,(o,s)=>{if(o)return t(o);n.length>0&&(s=n.concat(s)),t(null,s)})}_seek(e,t){this[Hi]=!0,this[Ht]=[],this[yr]=!1,this[Gn]=void 0,this[mr]={...this[Qe]};let n;try{n=tE(this[Qe])}catch{this[yr]=!0;return}n!==null&&!n.includes(e)?this[yr]=!0:this[Qe].reverse?this[mr].lte=e:this[mr].gte=e}};iE.Iterator=Th;function nE(r){typeof r.commit=="function"&&r.commit()}});var aE=b((IF,sE)=>{"use strict";a();sE.exports=function(e,t,n,i,o){if(i.limit===0)return e.nextTick(o);let s=e.db.transaction([t],"readwrite"),c=s.objectStore(t),u=0;s.oncomplete=function(){o()},s.onabort=function(){o(s.error||new Error("aborted by user"))};let f=c.openKeyCursor?"openKeyCursor":"openCursor",l=i.reverse?"prev":"next";c[f](n,l).onsuccess=function(h){let d=h.target.result;d&&(c.delete(d.key).onsuccess=function(){(i.limit<=0||++u<i.limit)&&d.continue()})}}});var dE=b(hE=>{"use strict";a();var{AbstractLevel:ZS}=_h(),cE=Ct(),e3=X0(),{fromCallback:t3}=os(),{Iterator:r3}=oE(),uE=Sh(),n3=aE(),i3=Dh(),lE="level-js-",bs=Symbol("idb"),Ch=Symbol("namePrefix"),gr=Symbol("location"),Ih=Symbol("version"),Jn=Symbol("store"),Es=Symbol("onComplete"),fE=Symbol("promise"),Oc=class extends ZS{constructor(e,t,n){if(typeof t=="function"||typeof n=="function")throw new cE("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});let{prefix:i,version:o,...s}=t||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},s),typeof e!="string")throw new Error("constructor requires a location string argument");this[gr]=e,this[Ch]=i??lE,this[Ih]=parseInt(o||1,10),this[bs]=null}get location(){return this[gr]}get namePrefix(){return this[Ch]}get version(){return this[Ih]}get db(){return this[bs]}get type(){return"browser-level"}_open(e,t){let n=indexedDB.open(this[Ch]+this[gr],this[Ih]);n.onerror=function(){t(n.error||new Error("unknown error"))},n.onsuccess=()=>{this[bs]=n.result,t()},n.onupgradeneeded=i=>{let o=i.target.result;o.objectStoreNames.contains(this[gr])||o.createObjectStore(this[gr])}}[Jn](e){return this[bs].transaction([this[gr]],e).objectStore(this[gr])}[Es](e,t){let n=e.transaction;n.onabort=function(){t(n.error||new Error("aborted by user"))},n.oncomplete=function(){t(null,e.result)}}_get(e,t,n){let i=this[Jn]("readonly"),o;try{o=i.get(e)}catch(s){return this.nextTick(n,s)}this[Es](o,function(s,c){if(s)return n(s);if(c===void 0)return n(new cE("Entry not found",{code:"LEVEL_NOT_FOUND"}));n(null,uE(c))})}_getMany(e,t,n){let i=this[Jn]("readonly"),o=e.map(s=>c=>{let u;try{u=i.get(s)}catch(f){return c(f)}u.onsuccess=()=>{let f=u.result;c(null,f===void 0?f:uE(f))},u.onerror=f=>{f.stopPropagation(),c(u.error)}});e3(o,16,n)}_del(e,t,n){let i=this[Jn]("readwrite"),o;try{o=i.delete(e)}catch(s){return this.nextTick(n,s)}this[Es](o,n)}_put(e,t,n,i){let o=this[Jn]("readwrite"),s;try{s=o.put(t,e)}catch(c){return this.nextTick(i,c)}this[Es](s,i)}_iterator(e){return new r3(this,this[gr],e)}_batch(e,t,n){let i=this[Jn]("readwrite"),o=i.transaction,s=0,c;o.onabort=function(){n(c||o.error||new Error("aborted by user"))},o.oncomplete=function(){n()};function u(){let f=e[s++],l=f.key,h;try{h=f.type==="del"?i.delete(l):i.put(f.value,l)}catch(d){c=d,o.abort();return}s<e.length?h.onsuccess=u:typeof o.commit=="function"&&o.commit()}u()}_clear(e,t){let n,i;try{n=i3(e)}catch{return this.nextTick(t)}if(e.limit>=0)return n3(this,this[gr],n,e,t);try{let o=this[Jn]("readwrite");i=n?o.delete(n):o.clear()}catch(o){return this.nextTick(t,o)}this[Es](i,t)}_close(e){this[bs].close(),this.nextTick(e)}};Oc.destroy=function(r,e,t){typeof e=="function"&&(t=e,e=lE),t=t3(t,fE);let n=indexedDB.deleteDatabase(e+r);return n.onsuccess=function(){t()},n.onerror=function(i){t(i)},t[fE]};hE.BrowserLevel=Oc});var yE=b(pE=>{a();pE.Level=dE().BrowserLevel});var kE=b((B5,BE)=>{"use strict";a();BE.exports=function(){return Date.now()}});var RE=b((L5,LE)=>{"use strict";a();var $c=kE(),Mh=class{constructor(e,t,n){let i=this;this._started=$c(),this._rescheduled=0,this._scheduled=t,this._args=n,this._triggered=!1,this._timerWrapper=()=>{i._rescheduled>0?(i._scheduled=i._rescheduled-($c()-i._started),i._schedule(i._scheduled)):(i._triggered=!0,e.apply(null,i._args))},this._timer=setTimeout(this._timerWrapper,t)}reschedule(e){e||(e=this._scheduled);let t=$c();t+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=t,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=$c(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}};function C3(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let r;if(arguments.length>0){r=new Array(arguments.length-2);for(var e=0;e<r.length;e++)r[e]=arguments[e+2]}return new Mh(arguments[0],arguments[1],r)}LE.exports=C3});var FE=b((N5,PE)=>{"use strict";a();var{AbortController:I3}=globalThis,NE=RE(),_s=class extends I3{constructor(e){super(),this._ms=e,this._timer=NE(()=>this.abort(),e),Object.setPrototypeOf(this,_s.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=NE(()=>this.abort(),this._ms)}};PE.exports={TimeoutController:_s}});var $E=b((F5,jh)=>{a();function UE(r){let e=new globalThis.AbortController;function t(){e.abort();for(let n of r)!n||!n.removeEventListener||n.removeEventListener("abort",t)}for(let n of r)if(!(!n||!n.addEventListener)){if(n.aborted){t();break}n.addEventListener("abort",t)}return e.signal}jh.exports=UE;jh.exports.anySignal=UE});var HE=b((uU,WE)=>{"use strict";a();var L3=async r=>{let e;for await(let t of r)e=t;return e};WE.exports=L3});var wd=b((U$,Bx)=>{"use strict";a();var MA=typeof navigator<"u"&&navigator.product==="ReactNative";function jA(){return MA?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:""}var Bs=self.URL,Ox=jA(),gd=class{constructor(e="",t=Ox){this.super=new Bs(e,t),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set username(e){this.super.username=e}static createObjectURL(e){return Bs.createObjectURL(e)}static revokeObjectURL(e){Bs.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function zA(r){if(typeof r=="string")return new Bs(r).toString();if(!(r instanceof Bs)){let e=r.username&&r.password?`${r.username}:${r.password}@`:"",t=r.auth?r.auth+"@":"",n=r.port?":"+r.port:"",i=r.protocol?r.protocol+"//":"",o=r.host||"",s=r.hostname||"",c=r.search||(r.query?"?"+r.query:""),u=r.hash||"",f=r.pathname||"",l=r.path||f+c;return`${i}${e||t}${o||s+n}${l}${u}`}}Bx.exports={URLWithLegacySupport:gd,URLSearchParams:self.URLSearchParams,defaultBase:Ox,format:zA}});var Rx=b((M$,Lx)=>{"use strict";a();var{URLWithLegacySupport:kx,format:qA}=wd();Lx.exports=(r,e={},t={},n)=>{let i=e.protocol?e.protocol.replace(":",""):"http";i=(t[i]||n||i)+":";let o;try{o=new kx(r)}catch{o={}}let s=Object.assign({},e,{protocol:i||o.protocol,host:e.host||o.host});return new kx(r,qA(s)).toString()}});var Px=b((z$,Nx)=>{"use strict";a();var{URLWithLegacySupport:VA,format:KA,URLSearchParams:WA,defaultBase:HA}=wd(),GA=Rx();Nx.exports={URL:VA,URLSearchParams:WA,format:KA,relative:GA,defaultBase:HA}});var Gx=b((xM,Hx)=>{"use strict";a();function eT(r){let[e,t]=r[Symbol.asyncIterator]?[r[Symbol.asyncIterator](),Symbol.asyncIterator]:[r[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>e.next(),push:i=>{n.push(i)},next:()=>n.length?{done:!1,value:n.shift()}:e.next(),[t](){return this}}}Hx.exports=eT});a();a();a();a();a();var ao=ov;function ov(r,e,t){if(!r)return t;var n,i;if(Array.isArray(e)&&(n=e.slice(0)),typeof e=="string"&&(n=e.split(".")),typeof e=="symbol"&&(n=[e]),!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");for(;n.length;)if(i=n.shift(),!r||(r=r[i],r===void 0))return t;return r}var zb=x(tt(),1),Rn=x(Se(),1);a();a();a();V();a();a();a();var nt=(r=21)=>crypto.getRandomValues(new Uint8Array(r)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");W();ge();var tr="/",Lp=new TextEncoder().encode(tr),Ys=Lp[0],M=class{constructor(e,t){if(typeof e=="string")this._buf=N(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==Ys)throw new Error("Invalid key")}toString(e="utf8"){return A(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new M(e.join(tr))}static random(){return new M(nt().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new M(e):typeof e.uint8Array=="function"?new M(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=Lp),this._buf[0]!==Ys){let e=new Uint8Array(this._buf.byteLength+1);e.fill(Ys,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===Ys;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),n=e.list();for(let i=0;i<t.length;i++){if(n.length<i+1)return!1;let o=t[i],s=n[i];if(o<s)return!0;if(o>s)return!1}return t.length<n.length}reverse(){return M.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(tr).slice(1)}type(){return k2(this.baseNamespace())}name(){return L2(this.baseNamespace())}instance(e){return new M(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(tr)||(e+=tr),e+=this.type(),new M(e)}parent(){let e=this.list();return e.length===1?new M(tr):new M(e.slice(0,-1).join(tr))}child(e){return this.toString()===tr?e:e.toString()===tr?this:new M(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return M.withNamespaces([...this.namespaces(),...R2(e.map(t=>t.namespaces()))])}};function k2(r){let e=r.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function L2(r){let e=r.split(":");return e[e.length-1]}function R2(r){return[].concat(...r)}var Pp=x(tt(),1),Fp=x(Ju(),1);Ce();Ar();Te();var P2=(0,Pp.default)("ipfs:repo:migrator:migration-8");function Up(r){return r.child?Up(r.child):r}function F2(r){try{let e=k.decode(`b${r.toString().toLowerCase().slice(1)}`),t=E.decode(e).multihash.bytes,n=k.encode(t).slice(1).toUpperCase();return new M(`/${n}`,!1)}catch{return r}}function U2(r){try{let e=k.decode(`b${r.toString().toLowerCase().slice(1)}`),t=re(e),n=k.encode(E.createV1(er,t).bytes).slice(1);return new M(`/${n.toUpperCase()}`,!1)}catch{return r}}async function Np(r,e,t){let n=r.blocks;await n.open();let i=Up(n),o=await(0,Fp.default)(i.queryKeys({filters:[s=>t(s).toString()!==s.toString()]}));try{let s=0;for await(let c of i.query({})){let u=t(c.key);u.toString()!==c.key.toString()&&(s+=1,P2(`Migrating Block from ${c.key} to ${u}`,await i.has(c.key)),await i.delete(c.key),await i.put(u,c.value),e(s/o*100,`Migrated Block from ${c.key} to ${u}`))}}finally{await n.close()}}var $p={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(r,e=()=>{})=>Np(r,e,F2),revert:(r,e=()=>{})=>Np(r,e,U2)};a();V();a();V();a();var $2=new TextDecoder;function Qu(r,e){let t=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(e>=r.length)throw new Error("protobuf: unexpected end of data");let i=r[e++];if(t+=n<28?(i&127)<<n:(i&127)*2**n,i<128)break}return[t,e]}function Xs(r,e){let t;[t,e]=Qu(r,e);let n=e+t;if(t<0||n<0)throw new Error("protobuf: invalid length");if(n>r.length)throw new Error("protobuf: unexpected end of data");return[r.subarray(e,n),n]}function Mp(r,e){let t;return[t,e]=Qu(r,e),[t&7,t>>3,e]}function M2(r){let e={},t=r.length,n=0;for(;n<t;){let i,o;if([i,o,n]=Mp(r,n),o===1){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Hash`);if(e.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,n]=Xs(r,n)}else if(o===2){if(e.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Name`);if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let s;[s,n]=Xs(r,n),e.Name=$2.decode(s)}else if(o===3){if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(i!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Tsize`);[e.Tsize,n]=Qu(r,n)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${o}`)}if(n>t)throw new Error("protobuf: (PBLink) unexpected end of data");return e}function jp(r){let e=r.length,t=0,n,i=!1,o;for(;t<e;){let c,u;if([c,u,t]=Mp(r,t),c!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${c}`);if(u===1){if(o)throw new Error("protobuf: (PBNode) duplicate Data section");[o,t]=Xs(r,t),n&&(i=!0)}else if(u===2){if(i)throw new Error("protobuf: (PBNode) duplicate Links section");n||(n=[]);let f;[f,t]=Xs(r,t),n.push(M2(f))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${u}`)}if(t>e)throw new Error("protobuf: (PBNode) unexpected end of data");let s={};return o&&(s.Data=o),s.Links=n||[],s}a();var qp=new TextEncoder,zp=2**32,j2=2**31;function z2(r,e){let t=e.length;if(typeof r.Tsize=="number"){if(r.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(r.Tsize))throw new Error("Tsize too large for encoding");t=go(e,t,r.Tsize)-1,e[t]=24}if(typeof r.Name=="string"){let n=qp.encode(r.Name);t-=n.length,e.set(n,t),t=go(e,t,n.length)-1,e[t]=18}return r.Hash&&(t-=r.Hash.length,e.set(r.Hash,t),t=go(e,t,r.Hash.length)-1,e[t]=10),e.length-t}function Vp(r){let e=V2(r),t=new Uint8Array(e),n=e;if(r.Data&&(n-=r.Data.length,t.set(r.Data,n),n=go(t,n,r.Data.length)-1,t[n]=10),r.Links)for(let i=r.Links.length-1;i>=0;i--){let o=z2(r.Links[i],t.subarray(0,n));n-=o,n=go(t,n,o)-1,t[n]=18}return t}function q2(r){let e=0;if(r.Hash){let t=r.Hash.length;e+=1+t+di(t)}if(typeof r.Name=="string"){let t=qp.encode(r.Name).length;e+=1+t+di(t)}return typeof r.Tsize=="number"&&(e+=1+di(r.Tsize)),e}function V2(r){let e=0;if(r.Data){let t=r.Data.length;e+=1+t+di(t)}if(r.Links)for(let t of r.Links){let n=q2(t);e+=1+n+di(n)}return e}function go(r,e,t){e-=di(t);let n=e;for(;t>=j2;)r[e++]=t&127|128,t/=128;for(;t>=128;)r[e++]=t&127|128,t>>>=7;return r[e]=t,n}function di(r){return r%2===0&&r++,Math.floor((K2(r)+6)/7)}function K2(r){let e=0;return r>=zp&&(r=Math.floor(r/zp),e=32),r>=1<<16&&(r>>>=16,e+=16),r>=1<<8&&(r>>>=8,e+=8),e+W2[r]}var W2=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8];a();V();var H2=["Data","Links"],G2=["Hash","Name","Tsize"],Kp=new TextEncoder;function J2(r,e){if(r===e)return 0;let t=r.Name?Kp.encode(r.Name):[],n=e.Name?Kp.encode(e.Name):[],i=t.length,o=n.length;for(let s=0,c=Math.min(i,o);s<c;++s)if(t[s]!==n[s]){i=t[s],o=n[s];break}return i<o?-1:o<i?1:0}function Wp(r,e){return!Object.keys(r).some(t=>!e.includes(t))}function Hp(r){if(!r||typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");if(!Wp(r,H2))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(r.Data!==void 0&&!(r.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be a Uint8Array)");if(!Array.isArray(r.Links))throw new TypeError("Invalid DAG-PB form (Links must be an array)");for(let e=0;e<r.Links.length;e++){let t=r.Links[e];if(!t||typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form (bad link object)");if(!Wp(t,G2))throw new TypeError("Invalid DAG-PB form (extraneous properties on link object)");if(!t.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(t.Hash.asCID!==t.Hash)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(t.Name!==void 0&&typeof t.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(t.Tsize!==void 0&&(typeof t.Tsize!="number"||t.Tsize%1!==0))throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(e>0&&J2(t,r.Links[e-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}var wt=112;function wo(r){Hp(r);let e={};return r.Links&&(e.Links=r.Links.map(t=>{let n={};return t.Hash&&(n.Hash=t.Hash.bytes),t.Name!==void 0&&(n.Name=t.Name),t.Tsize!==void 0&&(n.Tsize=t.Tsize),n})),r.Data&&(e.Data=r.Data),Vp(e)}function bo(r){let e=jp(r),t={};return e.Data&&(t.Data=e.Data),e.Links&&(t.Links=e.Links.map(n=>{let i={};try{i.Hash=E.decode(n.Hash)}catch{}if(!i.Hash)throw new Error("Invalid Hash field found in link, expected CID");return n.Name!==void 0&&(i.Name=n.Name),n.Tsize!==void 0&&(i.Tsize=n.Tsize),i})),t}a();a();a();var Q2=["string","number","bigint","symbol"],Y2=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function Gp(r){if(r===null)return"null";if(r===void 0)return"undefined";if(r===!0||r===!1)return"boolean";let e=typeof r;if(Q2.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(r))return"Array";if(X2(r))return"Buffer";let t=Z2(r);return t||"Object"}function X2(r){return r&&r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer.call(null,r)}function Z2(r){let e=Object.prototype.toString.call(r).slice(8,-1);if(Y2.includes(e))return e}a();var p=class{constructor(e,t,n){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};p.uint=new p(0,"uint",!0);p.negint=new p(1,"negint",!0);p.bytes=new p(2,"bytes",!0);p.string=new p(3,"string",!0);p.array=new p(4,"array",!1);p.map=new p(5,"map",!1);p.tag=new p(6,"tag",!1);p.float=new p(7,"float",!0);p.false=new p(7,"false",!0);p.true=new p(7,"true",!0);p.null=new p(7,"null",!0);p.undefined=new p(7,"undefined",!0);p.break=new p(7,"break",!0);var v=class{constructor(e,t,n){this.type=e,this.value=t,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}};a();a();var pi=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",e8=new TextDecoder,t8=new TextEncoder;function ea(r){return pi&&globalThis.Buffer.isBuffer(r)}function Yu(r){return r instanceof Uint8Array?ea(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r:Uint8Array.from(r)}var Xp=pi?(r,e,t)=>t-e>64?globalThis.Buffer.from(r.subarray(e,t)).toString("utf8"):Qp(r,e,t):(r,e,t)=>t-e>64?e8.decode(r.subarray(e,t)):Qp(r,e,t),Zp=pi?r=>r.length>64?globalThis.Buffer.from(r):Jp(r):r=>r.length>64?t8.encode(r):Jp(r),Ut=r=>Uint8Array.from(r),yi=pi?(r,e,t)=>ea(r)?new Uint8Array(r.subarray(e,t)):r.slice(e,t):(r,e,t)=>r.slice(e,t),ey=pi?(r,e)=>(r=r.map(t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t)),Yu(globalThis.Buffer.concat(r,e))):(r,e)=>{let t=new Uint8Array(e),n=0;for(let i of r)n+i.length>t.length&&(i=i.subarray(0,t.length-n)),t.set(i,n),n+=i.length;return t},ty=pi?r=>globalThis.Buffer.allocUnsafe(r):r=>new Uint8Array(r);function ry(r,e){if(ea(r)&&ea(e))return r.compare(e);for(let t=0;t<r.length;t++)if(r[t]!==e[t])return r[t]<e[t]?-1:1;return 0}function Jp(r,e=1/0){let t,n=r.length,i=null,o=[];for(let s=0;s<n;++s){if(t=r.charCodeAt(s),t>55295&&t<57344){if(!i){if(t>56319){(e-=3)>-1&&o.push(239,191,189);continue}else if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=t;continue}if(t<56320){(e-=3)>-1&&o.push(239,191,189),i=t;continue}t=(i-55296<<10|t-56320)+65536}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,t<128){if((e-=1)<0)break;o.push(t)}else if(t<2048){if((e-=2)<0)break;o.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;o.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;o.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return o}function Qp(r,e,t){let n=[];for(;e<t;){let i=r[e],o=null,s=i>239?4:i>223?3:i>191?2:1;if(e+s<=t){let c,u,f,l;switch(s){case 1:i<128&&(o=i);break;case 2:c=r[e+1],(c&192)===128&&(l=(i&31)<<6|c&63,l>127&&(o=l));break;case 3:c=r[e+1],u=r[e+2],(c&192)===128&&(u&192)===128&&(l=(i&15)<<12|(c&63)<<6|u&63,l>2047&&(l<55296||l>57343)&&(o=l));break;case 4:c=r[e+1],u=r[e+2],f=r[e+3],(c&192)===128&&(u&192)===128&&(f&192)===128&&(l=(i&15)<<18|(c&63)<<12|(u&63)<<6|f&63,l>65535&&l<1114112&&(o=l))}}o===null?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|o&1023),n.push(o),e+=s}return r8(n)}var Yp=4096;function r8(r){let e=r.length;if(e<=Yp)return String.fromCharCode.apply(String,r);let t="",n=0;for(;n<e;)t+=String.fromCharCode.apply(String,r.slice(n,n+=Yp));return t}var n8=256,Eo=class{constructor(e=n8){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let i=t.length-(this.maxCursor-this.cursor)-1;t.set(e,i)}else{if(t){let i=t.length-(this.maxCursor-this.cursor)-1;i<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,i),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=ty(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,this._initReuseChunk===null&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(this.chunks.length===1){let n=this.chunks[0];e&&this.cursor>n.length/2?(t=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=yi(n,0,this.cursor)}else t=ey(this.chunks,this.cursor);return e&&this.reset(),t}};a();var C="CBOR decode error:",Xu="CBOR encode error:",xo=[];xo[23]=1;xo[24]=2;xo[25]=3;xo[26]=5;xo[27]=9;function rr(r,e,t){if(r.length-e<t)throw new Error(`${C} not enough data for type`)}a();a();var he=[24,256,65536,4294967296,BigInt("18446744073709551616")];function je(r,e,t){rr(r,e,1);let n=r[e];if(t.strict===!0&&n<he[0])throw new Error(`${C} integer encoded in more bytes than necessary (strict decode)`);return n}function ze(r,e,t){rr(r,e,2);let n=r[e]<<8|r[e+1];if(t.strict===!0&&n<he[1])throw new Error(`${C} integer encoded in more bytes than necessary (strict decode)`);return n}function qe(r,e,t){rr(r,e,4);let n=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3];if(t.strict===!0&&n<he[2])throw new Error(`${C} integer encoded in more bytes than necessary (strict decode)`);return n}function Ve(r,e,t){rr(r,e,8);let n=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3],i=r[e+4]*16777216+(r[e+5]<<16)+(r[e+6]<<8)+r[e+7],o=(BigInt(n)<<BigInt(32))+BigInt(i);if(t.strict===!0&&o<he[3])throw new Error(`${C} integer encoded in more bytes than necessary (strict decode)`);if(o<=Number.MAX_SAFE_INTEGER)return Number(o);if(t.allowBigInt===!0)return o;throw new Error(`${C} integers outside of the safe integer range are not supported`)}function ny(r,e,t,n){return new v(p.uint,je(r,e+1,n),2)}function iy(r,e,t,n){return new v(p.uint,ze(r,e+1,n),3)}function oy(r,e,t,n){return new v(p.uint,qe(r,e+1,n),5)}function sy(r,e,t,n){return new v(p.uint,Ve(r,e+1,n),9)}function it(r,e){return we(r,0,e.value)}function we(r,e,t){if(t<he[0]){let n=Number(t);r.push([e|n])}else if(t<he[1]){let n=Number(t);r.push([e|24,n])}else if(t<he[2]){let n=Number(t);r.push([e|25,n>>>8,n&255])}else if(t<he[3]){let n=Number(t);r.push([e|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{let n=BigInt(t);if(n<he[4]){let i=[e|27,0,0,0,0,0,0,0],o=Number(n&BigInt(4294967295)),s=Number(n>>BigInt(32)&BigInt(4294967295));i[8]=o&255,o=o>>8,i[7]=o&255,o=o>>8,i[6]=o&255,o=o>>8,i[5]=o&255,i[4]=s&255,s=s>>8,i[3]=s&255,s=s>>8,i[2]=s&255,s=s>>8,i[1]=s&255,r.push(i)}else throw new Error(`${C} encountered BigInt larger than allowable range`)}}it.encodedSize=function(e){return we.encodedSize(e.value)};we.encodedSize=function(e){return e<he[0]?1:e<he[1]?2:e<he[2]?3:e<he[3]?5:9};it.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};a();function ay(r,e,t,n){return new v(p.negint,-1-je(r,e+1,n),2)}function cy(r,e,t,n){return new v(p.negint,-1-ze(r,e+1,n),3)}function uy(r,e,t,n){return new v(p.negint,-1-qe(r,e+1,n),5)}var Zu=BigInt(-1),fy=BigInt(1);function ly(r,e,t,n){let i=Ve(r,e+1,n);if(typeof i!="bigint"){let o=-1-i;if(o>=Number.MIN_SAFE_INTEGER)return new v(p.negint,o,9)}if(n.allowBigInt!==!0)throw new Error(`${C} integers outside of the safe integer range are not supported`);return new v(p.negint,Zu-BigInt(i),9)}function ta(r,e){let t=e.value,n=typeof t=="bigint"?t*Zu-fy:t*-1-1;we(r,e.type.majorEncoded,n)}ta.encodedSize=function(e){let t=e.value,n=typeof t=="bigint"?t*Zu-fy:t*-1-1;return n<he[0]?1:n<he[1]?2:n<he[2]?3:n<he[3]?5:9};ta.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0};a();function vo(r,e,t,n){rr(r,e,t+n);let i=yi(r,e+t,e+t+n);return new v(p.bytes,i,t+n)}function hy(r,e,t,n){return vo(r,e,1,t)}function dy(r,e,t,n){return vo(r,e,2,je(r,e+1,n))}function py(r,e,t,n){return vo(r,e,3,ze(r,e+1,n))}function yy(r,e,t,n){return vo(r,e,5,qe(r,e+1,n))}function my(r,e,t,n){let i=Ve(r,e+1,n);if(typeof i=="bigint")throw new Error(`${C} 64-bit integer bytes lengths not supported`);return vo(r,e,9,i)}function ra(r){return r.encodedBytes===void 0&&(r.encodedBytes=r.type===p.string?Zp(r.value):r.value),r.encodedBytes}function mi(r,e){let t=ra(e);we(r,e.type.majorEncoded,t.length),r.push(t)}mi.encodedSize=function(e){let t=ra(e);return we.encodedSize(t.length)+t.length};mi.compareTokens=function(e,t){return o8(ra(e),ra(t))};function o8(r,e){return r.length<e.length?-1:r.length>e.length?1:ry(r,e)}a();function _o(r,e,t,n,i){let o=t+n;rr(r,e,o);let s=new v(p.string,Xp(r,e+t,e+o),o);return i.retainStringBytes===!0&&(s.byteValue=yi(r,e+t,e+o)),s}function gy(r,e,t,n){return _o(r,e,1,t,n)}function wy(r,e,t,n){return _o(r,e,2,je(r,e+1,n),n)}function by(r,e,t,n){return _o(r,e,3,ze(r,e+1,n),n)}function Ey(r,e,t,n){return _o(r,e,5,qe(r,e+1,n),n)}function xy(r,e,t,n){let i=Ve(r,e+1,n);if(typeof i=="bigint")throw new Error(`${C} 64-bit integer string lengths not supported`);return _o(r,e,9,i,n)}var vy=mi;a();function gi(r,e,t,n){return new v(p.array,n,t)}function _y(r,e,t,n){return gi(r,e,1,t)}function Dy(r,e,t,n){return gi(r,e,2,je(r,e+1,n))}function Sy(r,e,t,n){return gi(r,e,3,ze(r,e+1,n))}function Ay(r,e,t,n){return gi(r,e,5,qe(r,e+1,n))}function Ty(r,e,t,n){let i=Ve(r,e+1,n);if(typeof i=="bigint")throw new Error(`${C} 64-bit integer array lengths not supported`);return gi(r,e,9,i)}function Cy(r,e,t,n){if(n.allowIndefinite===!1)throw new Error(`${C} indefinite length items not allowed`);return gi(r,e,1,1/0)}function na(r,e){we(r,p.array.majorEncoded,e.value)}na.compareTokens=it.compareTokens;na.encodedSize=function(e){return we.encodedSize(e.value)};a();function wi(r,e,t,n){return new v(p.map,n,t)}function Iy(r,e,t,n){return wi(r,e,1,t)}function Oy(r,e,t,n){return wi(r,e,2,je(r,e+1,n))}function By(r,e,t,n){return wi(r,e,3,ze(r,e+1,n))}function ky(r,e,t,n){return wi(r,e,5,qe(r,e+1,n))}function Ly(r,e,t,n){let i=Ve(r,e+1,n);if(typeof i=="bigint")throw new Error(`${C} 64-bit integer map lengths not supported`);return wi(r,e,9,i)}function Ry(r,e,t,n){if(n.allowIndefinite===!1)throw new Error(`${C} indefinite length items not allowed`);return wi(r,e,1,1/0)}function ia(r,e){we(r,p.map.majorEncoded,e.value)}ia.compareTokens=it.compareTokens;ia.encodedSize=function(e){return we.encodedSize(e.value)};a();function Ny(r,e,t,n){return new v(p.tag,t,1)}function Py(r,e,t,n){return new v(p.tag,je(r,e+1,n),2)}function Fy(r,e,t,n){return new v(p.tag,ze(r,e+1,n),3)}function Uy(r,e,t,n){return new v(p.tag,qe(r,e+1,n),5)}function $y(r,e,t,n){return new v(p.tag,Ve(r,e+1,n),9)}function oa(r,e){we(r,p.tag.majorEncoded,e.value)}oa.compareTokens=it.compareTokens;oa.encodedSize=function(e){return we.encodedSize(e.value)};a();var l8=20,h8=21,d8=22,p8=23;function My(r,e,t,n){if(n.allowUndefined===!1)throw new Error(`${C} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new v(p.null,null,1):new v(p.undefined,void 0,1)}function jy(r,e,t,n){if(n.allowIndefinite===!1)throw new Error(`${C} indefinite length items not allowed`);return new v(p.break,void 0,1)}function ef(r,e,t){if(t){if(t.allowNaN===!1&&Number.isNaN(r))throw new Error(`${C} NaN values are not supported`);if(t.allowInfinity===!1&&(r===1/0||r===-1/0))throw new Error(`${C} Infinity values are not supported`)}return new v(p.float,r,e)}function zy(r,e,t,n){return ef(tf(r,e+1),3,n)}function qy(r,e,t,n){return ef(rf(r,e+1),5,n)}function Vy(r,e,t,n){return ef(Gy(r,e+1),9,n)}function sa(r,e,t){let n=e.value;if(n===!1)r.push([p.float.majorEncoded|l8]);else if(n===!0)r.push([p.float.majorEncoded|h8]);else if(n===null)r.push([p.float.majorEncoded|d8]);else if(n===void 0)r.push([p.float.majorEncoded|p8]);else{let i,o=!1;(!t||t.float64!==!0)&&(Wy(n),i=tf(bt,1),n===i||Number.isNaN(n)?(bt[0]=249,r.push(bt.slice(0,3)),o=!0):(Hy(n),i=rf(bt,1),n===i&&(bt[0]=250,r.push(bt.slice(0,5)),o=!0))),o||(y8(n),i=Gy(bt,1),bt[0]=251,r.push(bt.slice(0,9)))}}sa.encodedSize=function(e,t){let n=e.value;if(n===!1||n===!0||n===null||n===void 0)return 1;if(!t||t.float64!==!0){Wy(n);let i=tf(bt,1);if(n===i||Number.isNaN(n))return 3;if(Hy(n),i=rf(bt,1),n===i)return 5}return 9};var Ky=new ArrayBuffer(9),ot=new DataView(Ky,1),bt=new Uint8Array(Ky,0);function Wy(r){if(r===1/0)ot.setUint16(0,31744,!1);else if(r===-1/0)ot.setUint16(0,64512,!1);else if(Number.isNaN(r))ot.setUint16(0,32256,!1);else{ot.setFloat32(0,r);let e=ot.getUint32(0),t=(e&2139095040)>>23,n=e&8388607;if(t===255)ot.setUint16(0,31744,!1);else if(t===0)ot.setUint16(0,(r&2147483648)>>16|n>>13,!1);else{let i=t-127;i<-24?ot.setUint16(0,0):i<-14?ot.setUint16(0,(e&2147483648)>>16|1<<24+i,!1):ot.setUint16(0,(e&2147483648)>>16|i+15<<10|n>>13,!1)}}}function tf(r,e){if(r.length-e<2)throw new Error(`${C} not enough data for float16`);let t=(r[e]<<8)+r[e+1];if(t===31744)return 1/0;if(t===64512)return-1/0;if(t===32256)return NaN;let n=t>>10&31,i=t&1023,o;return n===0?o=i*2**-24:n!==31?o=(i+1024)*2**(n-25):o=i===0?1/0:NaN,t&32768?-o:o}function Hy(r){ot.setFloat32(0,r,!1)}function rf(r,e){if(r.length-e<4)throw new Error(`${C} not enough data for float32`);let t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,4).getFloat32(0,!1)}function y8(r){ot.setFloat64(0,r,!1)}function Gy(r,e){if(r.length-e<8)throw new Error(`${C} not enough data for float64`);let t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,8).getFloat64(0,!1)}sa.compareTokens=it.compareTokens;function F(r,e,t){throw new Error(`${C} encountered invalid minor (${t}) for major ${r[e]>>>5}`)}function aa(r){return()=>{throw new Error(`${C} ${r}`)}}var _=[];for(let r=0;r<=23;r++)_[r]=F;_[24]=ny;_[25]=iy;_[26]=oy;_[27]=sy;_[28]=F;_[29]=F;_[30]=F;_[31]=F;for(let r=32;r<=55;r++)_[r]=F;_[56]=ay;_[57]=cy;_[58]=uy;_[59]=ly;_[60]=F;_[61]=F;_[62]=F;_[63]=F;for(let r=64;r<=87;r++)_[r]=hy;_[88]=dy;_[89]=py;_[90]=yy;_[91]=my;_[92]=F;_[93]=F;_[94]=F;_[95]=aa("indefinite length bytes/strings are not supported");for(let r=96;r<=119;r++)_[r]=gy;_[120]=wy;_[121]=by;_[122]=Ey;_[123]=xy;_[124]=F;_[125]=F;_[126]=F;_[127]=aa("indefinite length bytes/strings are not supported");for(let r=128;r<=151;r++)_[r]=_y;_[152]=Dy;_[153]=Sy;_[154]=Ay;_[155]=Ty;_[156]=F;_[157]=F;_[158]=F;_[159]=Cy;for(let r=160;r<=183;r++)_[r]=Iy;_[184]=Oy;_[185]=By;_[186]=ky;_[187]=Ly;_[188]=F;_[189]=F;_[190]=F;_[191]=Ry;for(let r=192;r<=215;r++)_[r]=Ny;_[216]=Py;_[217]=Fy;_[218]=Uy;_[219]=$y;_[220]=F;_[221]=F;_[222]=F;_[223]=F;for(let r=224;r<=243;r++)_[r]=aa("simple values are not supported");_[244]=F;_[245]=F;_[246]=F;_[247]=My;_[248]=aa("simple values are not supported");_[249]=zy;_[250]=qy;_[251]=Vy;_[252]=F;_[253]=F;_[254]=F;_[255]=jy;var Et=[];for(let r=0;r<24;r++)Et[r]=new v(p.uint,r,1);for(let r=-1;r>=-24;r--)Et[31-r]=new v(p.negint,r,1);Et[64]=new v(p.bytes,new Uint8Array(0),1);Et[96]=new v(p.string,"",1);Et[128]=new v(p.array,0,1);Et[160]=new v(p.map,0,1);Et[244]=new v(p.false,!1,1);Et[245]=new v(p.true,!0,1);Et[246]=new v(p.null,null,1);function ca(r){switch(r.type){case p.false:return Ut([244]);case p.true:return Ut([245]);case p.null:return Ut([246]);case p.bytes:return r.value.length?void 0:Ut([64]);case p.string:return r.value===""?Ut([96]):void 0;case p.array:return r.value===0?Ut([128]):void 0;case p.map:return r.value===0?Ut([160]):void 0;case p.uint:return r.value<24?Ut([Number(r.value)]):void 0;case p.negint:if(r.value>=-24)return Ut([31-Number(r.value)])}}var g8={float64:!1,mapSorter:b8,quickEncodeToken:ca};function of(){let r=[];return r[p.uint.major]=it,r[p.negint.major]=ta,r[p.bytes.major]=mi,r[p.string.major]=vy,r[p.array.major]=na,r[p.map.major]=ia,r[p.tag.major]=oa,r[p.float.major]=sa,r}var Jy=of(),nf=new Eo,bi=class{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do if(t.obj===e)return!0;while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${Xu} object contains circular references`);return new bi(t,e)}},Tr={null:new v(p.null,null),undefined:new v(p.undefined,void 0),true:new v(p.true,!0),false:new v(p.false,!1),emptyArray:new v(p.array,0),emptyMap:new v(p.map,0)},Cr={number(r,e,t,n){return!Number.isInteger(r)||!Number.isSafeInteger(r)?new v(p.float,r):r>=0?new v(p.uint,r):new v(p.negint,r)},bigint(r,e,t,n){return r>=BigInt(0)?new v(p.uint,r):new v(p.negint,r)},Uint8Array(r,e,t,n){return new v(p.bytes,r)},string(r,e,t,n){return new v(p.string,r)},boolean(r,e,t,n){return r?Tr.true:Tr.false},null(r,e,t,n){return Tr.null},undefined(r,e,t,n){return Tr.undefined},ArrayBuffer(r,e,t,n){return new v(p.bytes,new Uint8Array(r))},DataView(r,e,t,n){return new v(p.bytes,new Uint8Array(r.buffer,r.byteOffset,r.byteLength))},Array(r,e,t,n){if(!r.length)return t.addBreakTokens===!0?[Tr.emptyArray,new v(p.break)]:Tr.emptyArray;n=bi.createCheck(n,r);let i=[],o=0;for(let s of r)i[o++]=Do(s,t,n);return t.addBreakTokens?[new v(p.array,r.length),i,new v(p.break)]:[new v(p.array,r.length),i]},Object(r,e,t,n){let i=e!=="Object",o=i?r.keys():Object.keys(r),s=i?r.size:o.length;if(!s)return t.addBreakTokens===!0?[Tr.emptyMap,new v(p.break)]:Tr.emptyMap;n=bi.createCheck(n,r);let c=[],u=0;for(let f of o)c[u++]=[Do(f,t,n),Do(i?r.get(f):r[f],t,n)];return w8(c,t),t.addBreakTokens?[new v(p.map,s),c,new v(p.break)]:[new v(p.map,s),c]}};Cr.Map=Cr.Object;Cr.Buffer=Cr.Uint8Array;for(let r of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Cr[`${r}Array`]=Cr.DataView;function Do(r,e={},t){let n=Gp(r),i=e&&e.typeEncoders&&e.typeEncoders[n]||Cr[n];if(typeof i=="function"){let s=i(r,n,e,t);if(s!=null)return s}let o=Cr[n];if(!o)throw new Error(`${Xu} unsupported type: ${n}`);return o(r,n,e,t)}function w8(r,e){e.mapSorter&&r.sort(e.mapSorter)}function b8(r,e){let t=Array.isArray(r[0])?r[0][0]:r[0],n=Array.isArray(e[0])?e[0][0]:e[0];if(t.type!==n.type)return t.type.compare(n.type);let i=t.type.major,o=Jy[i].compareTokens(t,n);return o===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),o}function Qy(r,e,t,n){if(Array.isArray(e))for(let i of e)Qy(r,i,t,n);else t[e.type.major](r,e,n)}function E8(r,e,t){let n=Do(r,t);if(!Array.isArray(n)&&t.quickEncodeToken){let i=t.quickEncodeToken(n);if(i)return i;let o=e[n.type.major];if(o.encodedSize){let s=o.encodedSize(n,t),c=new Eo(s);if(o(c,n,t),c.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return Yu(c.chunks[0])}}return nf.reset(),Qy(nf,n,e,t),nf.toBytes(!0)}function nr(r,e){return e=Object.assign({},g8,e),E8(r,Jy,e)}a();var x8={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},sf=class{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){let e=this.data[this.pos],t=Et[e];if(t===void 0){let n=_[e];if(!n)throw new Error(`${C} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let i=e&31;t=n(this.data,this.pos,i,this.options)}return this.pos+=t.encodedLength,t}},So=Symbol.for("DONE"),ua=Symbol.for("BREAK");function v8(r,e,t){let n=[];for(let i=0;i<r.value;i++){let o=Ao(e,t);if(o===ua){if(r.value===1/0)break;throw new Error(`${C} got unexpected break to lengthed array`)}if(o===So)throw new Error(`${C} found array but not enough entries (got ${i}, expected ${r.value})`);n[i]=o}return n}function _8(r,e,t){let n=t.useMaps===!0,i=n?void 0:{},o=n?new Map:void 0;for(let s=0;s<r.value;s++){let c=Ao(e,t);if(c===ua){if(r.value===1/0)break;throw new Error(`${C} got unexpected break to lengthed map`)}if(c===So)throw new Error(`${C} found map but not enough entries (got ${s} [no key], expected ${r.value})`);if(n!==!0&&typeof c!="string")throw new Error(`${C} non-string keys not supported (got ${typeof c})`);let u=Ao(e,t);if(u===So)throw new Error(`${C} found map but not enough entries (got ${s} [no value], expected ${r.value})`);n?o.set(c,u):i[c]=u}return n?o:i}function Ao(r,e){if(r.done())return So;let t=r.next();if(t.type===p.break)return ua;if(t.type.terminal)return t.value;if(t.type===p.array)return v8(t,r,e);if(t.type===p.map)return _8(t,r,e);if(t.type===p.tag){if(e.tags&&typeof e.tags[t.value]=="function"){let n=Ao(r,e);return e.tags[t.value](n)}throw new Error(`${C} tag not supported (${t.value})`)}throw new Error("unsupported")}function st(r,e){if(!(r instanceof Uint8Array))throw new Error(`${C} data to decode must be a Uint8Array`);e=Object.assign({},x8,e);let t=e.tokenizer||new sf(r,e),n=Ao(t,e);if(n===So)throw new Error(`${C} did not find any content to decode`);if(n===ua)throw new Error(`${C} got unexpected break`);if(!t.done())throw new Error(`${C} too many terminals, data makes no sense`);return n}a();V();a();var vn=x(kr(),1),Hm=vn.default.Reader,L8=vn.default.Writer,O4=vn.default.util,pa=vn.default.roots.default||(vn.default.roots.default={}),Gm=pa.ipfs=(()=>{let r={};return r.pin=function(){let e={};return e.Set=function(){function t(n){if(n)for(var i=Object.keys(n),o=0;o<i.length;++o)n[i[o]]!=null&&(this[i[o]]=n[i[o]])}return t.prototype.version=0,t.prototype.fanout=0,t.prototype.seed=0,t.encode=function(i,o){return o||(o=L8.create()),i.version!=null&&Object.hasOwnProperty.call(i,"version")&&o.uint32(8).uint32(i.version),i.fanout!=null&&Object.hasOwnProperty.call(i,"fanout")&&o.uint32(16).uint32(i.fanout),i.seed!=null&&Object.hasOwnProperty.call(i,"seed")&&o.uint32(29).fixed32(i.seed),o},t.decode=function(i,o){i instanceof Hm||(i=Hm.create(i));for(var s=o===void 0?i.len:i.pos+o,c=new pa.ipfs.pin.Set;i.pos<s;){var u=i.uint32();switch(u>>>3){case 1:c.version=i.uint32();break;case 2:c.fanout=i.uint32();break;case 3:c.seed=i.fixed32();break;default:i.skipType(u&7);break}}return c},t.fromObject=function(i){if(i instanceof pa.ipfs.pin.Set)return i;var o=new pa.ipfs.pin.Set;return i.version!=null&&(o.version=i.version>>>0),i.fanout!=null&&(o.fanout=i.fanout>>>0),i.seed!=null&&(o.seed=i.seed>>>0),o},t.toObject=function(i,o){o||(o={});var s={};return o.defaults&&(s.version=0,s.fanout=0,s.seed=0),i.version!=null&&i.hasOwnProperty("version")&&(s.version=i.version),i.fanout!=null&&i.hasOwnProperty("fanout")&&(s.fanout=i.fanout),i.seed!=null&&i.hasOwnProperty("seed")&&(s.seed=i.seed),s},t.prototype.toJSON=function(){return this.constructor.toObject(this,vn.default.util.toJSONOptions)},t}(),e}(),r})();var cg=x(Qm(),1),ga=x(Re(),1);a();Ce();V();var Oo=new M("/local/pins"),ma=256,sg=8192,Df=E.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),_n={direct:"direct",recursive:"recursive"};function Sf(r){return new M(`/${k.encode(r.multihash.bytes).toUpperCase().substring(1)}`)}Lr();a();function ag(r,e){for(let t=0;t<r.byteLength;t++){if(r[t]<e[t])return-1;if(r[t]>e[t])return 1}return r.byteLength>e.byteLength?1:r.byteLength<e.byteLength?-1:0}W();ge();fi();var Tf=Gm.pin.Set;function H8(r){let e=r.Data;if(!e)throw new Error("No data present");let t=ga.default.decode(e),n=ga.default.decode.bytes;if(n<=0)throw new Error("Invalid Set header length");if(n+t>e.length)throw new Error("Impossibly large set header length");let i=e.slice(n,t+n),o=Tf.toObject(Tf.decode(i),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(o.version!==1)throw new Error(`Unsupported Set version: ${o.version}`);if(o.fanout>r.Links.length)throw new Error("Impossibly large fanout");return{header:o,data:e.slice(t+n)}}function G8(r,e){let t=new Uint8Array(4);new DataView(t.buffer).setUint32(0,r,!0);let i=N(e.toString()),o=Q([t,i],t.byteLength+i.byteLength);return(0,cg.default)(A(o))}async function*ug(r,e){let t=H8(e),n=0;for(let i of e.Links){if(n<t.header.fanout){let o=i.Hash;if(!Df.equals(o)){let s=await r.get(o),c=bo(s);yield*ug(r,c)}}else yield i.Hash;n++}}async function*Bo(r,e,t){let n=e.Links.find(s=>s.Name===t);if(!n)throw new Error("No link found with name "+t);let i=await r.get(n.Hash),o=bo(i);yield*ug(r,o)}function J8(r,e){return t(e,0);async function t(n,i){let o=Tf.encode({version:1,fanout:ma,seed:i}).finish(),s=ga.default.encode(o.length),c=Q([s,o]),u=[];for(let l=0;l<ma;l++)u.push({Name:"",Tsize:1,Hash:Df});if(n.length<=sg){let l=n.map(w=>({link:{Name:"",Tsize:1,Hash:w.key},data:w.data||new Uint8Array})).sort((w,g)=>ag(w.link.Hash.bytes,g.link.Hash.bytes)),h=u.concat(l.map(w=>w.link));return{Data:Q([c,...l.map(w=>w.data)]),Links:h}}else{let l=n.reduce((d,w)=>{let g=G8(i,w.key)%ma;return d[g]=g in d?d[g].concat([w]):[w],d},[]),h=0;for(let d of l){let w=await t(d,i+1);await f(w,h),h++}return{Data:c,Links:u}}async function f(l,h){let d=wo(l),w=await Ft.digest(d),g=E.createV0(w);await r.put(g,d);let m=l.Links.reduce((I,U)=>I+(U.Tsize||0),0)+d.length;u[h]={Name:"",Tsize:m,Hash:g}}}}async function Cf(r,e,t){let n=await J8(r,t.map(u=>({key:u}))),i=wo(n),o=await Ft.digest(i),s=E.createV0(o);await r.put(s,i);let c=n.Links.reduce((u,f)=>u+f.Tsize,0)+i.length;return{Name:e,Tsize:c,Hash:s}}var wa=x(Ju(),1);fi();Te();Ce();async function Y8(r,e,t,n){if(!await e.has(Oo))return;let i=await e.get(Oo),o=E.decode(i),s=await r.get(o),c=bo(s),u=0,f=await(0,wa.default)(Bo(r,c,_n.recursive))+await(0,wa.default)(Bo(r,c,_n.direct));for await(let l of Bo(r,c,_n.recursive)){u++;let h={depth:1/0};l.version!==0&&(h.version=l.version),l.code!==wt&&(h.codec=l.code),await t.put(Sf(l),nr(h)),n(u/f*100,`Migrated recursive pin ${l}`)}for await(let l of Bo(r,c,_n.direct)){u++;let h={depth:0};l.version!==0&&(h.version=l.version),l.code!==wt&&(h.codec=l.code),await t.put(Sf(l),nr(h)),n(u/f*100,`Migrated direct pin ${l}`)}await r.delete(o),await e.delete(Oo)}async function X8(r,e,t,n){let i=[],o=[],s=0,c=await(0,wa.default)(t.queryKeys({}));for await(let{key:d,value:w}of t.query({})){s++;let g=st(w),m=E.create(g.version||0,g.codec||wt,re(k.decode("b"+d.toString().toLowerCase().split("/").pop())));g.depth===0?(n(s/c*100,`Reverted direct pin ${m}`),o.push(m)):(n(s/c*100,`Reverted recursive pin ${m}`),i.push(m))}n(100,"Updating pin root");let u={Links:[await Cf(r,_n.direct,o),await Cf(r,_n.recursive,i)]},f=wo(u),l=await Ft.digest(f),h=E.createV0(l);await r.put(h,f),await e.put(Oo,h.bytes)}async function fg(r,e,t){let n=r.blocks,i=r.datastore,o=r.pins;await n.open(),await i.open(),await o.open();try{await t(n,i,o,e)}finally{await o.close(),await i.close(),await n.close()}}var lg={version:9,description:"Migrates pins to datastore",migrate:(r,e=()=>{})=>fg(r,e,Y8),revert:(r,e=()=>{})=>fg(r,e,X8)};a();a();var ct={};H(ct,{abortedError:()=>Z8,dbDeleteFailedError:()=>Of,dbOpenFailedError:()=>If,dbWriteFailedError:()=>Bf,notFoundError:()=>ir});a();var xi=x(Se(),1);function If(r){return r=r||new Error("Cannot open database"),(0,xi.default)(r,"ERR_DB_OPEN_FAILED")}function Of(r){return r=r||new Error("Delete failed"),(0,xi.default)(r,"ERR_DB_DELETE_FAILED")}function Bf(r){return r=r||new Error("Write failed"),(0,xi.default)(r,"ERR_DB_WRITE_FAILED")}function ir(r){return r=r||new Error("Not Found"),(0,xi.default)(r,"ERR_NOT_FOUND")}function Z8(r){return r=r||new Error("Aborted"),(0,xi.default)(r,"ERR_ABORTED")}var hg=new M("/config"),ko=new M("/version");function Lo(r){let e=r;for(;e.db||e.child;)if(e=e.db||e.child,e.type==="level-js"||e.constructor.name==="Level")return e}async function e_(r,e,t){let n=await e(r);if(n)return n;let i=Lo(t);return i?new Promise((o,s)=>{let c=i.store("readonly").get(r.toString());c.transaction.onabort=()=>{s(c.transaction.error)},c.transaction.oncomplete=()=>{o(Boolean(c.result))}}):!1}async function t_(r,e,t,n){if(await t(r))return e(r);let i=Lo(n);if(!i)throw ir();return new Promise((o,s)=>{let c=i.store("readonly").get(r.toString());c.transaction.onabort=()=>{s(c.transaction.error)},c.transaction.oncomplete=()=>{if(c.result)return o(c.result);s(ir())}})}function ba(r){let e=r.get.bind(r),t=r.has.bind(r);return r.get=n=>t_(n,e,t,r),r.has=n=>e_(n,t,r),r}function kf(r){return{...r,root:ba(r.root),datastore:ba(r.datastore),pins:ba(r.pins),keys:ba(r.keys)}}ge();W();async function r_(r,e,t=()=>{}){let n=Lo(e);if(!n){t(`${r} did not need an upgrade`);return}t(`Upgrading ${r}`),await mg(n,(o,s)=>[{type:"del",key:o},{type:"put",key:N(o),value:s}])}async function n_(r,e,t=()=>{}){let n=Lo(e);if(!n){t(`${r} did not need a downgrade`);return}t(`Downgrading ${r}`),await mg(n,(o,s)=>[{type:"del",key:o},{type:"put",key:A(o),value:s}])}function pg(r){return r.child?pg(r.child):r}async function dg(r,e,t){let n=Object.entries(r).map(([s,c])=>({key:s,backend:pg(c)})).filter(({key:s,backend:c})=>c.constructor.name==="LevelDatastore").map(({key:s,backend:c})=>({name:s,store:c}));e(0,`Migrating ${n.length} dbs`);let i=0,o=s=>{e(Math.round(i/n.length*100),s)};for(let{name:s,store:c}of n){await c.open();try{await t(s,c,o)}finally{i++,await c.close()}}e(100,`Migrated ${n.length} dbs`)}var yg={version:10,description:"Migrates datastore-level keys to binary",migrate:(r,e=()=>{})=>dg(r,e,r_),revert:(r,e=()=>{})=>dg(r,e,n_)};function mg(r,e){function t(n,i){let o=r.store("readwrite"),s=o.transaction,c=0,u;s.onabort=()=>i(u||s.error||new Error("aborted by user")),s.oncomplete=()=>i();function f(){let l=n[c++],h=l.key,d;try{d=l.type==="del"?o.delete(h):o.put(l.value,h)}catch(w){u=w,s.abort();return}c<n.length&&(d.onsuccess=f)}f()}return new Promise((n,i)=>{let o=r.iterator(),s=u=>u;o._deserializeKey=o._deserializeValue=s,c();function c(){let u=(f,l,h)=>{if(f||l===void 0){let d=w=>{if(w){i(w);return}n()};o.end(d);return}t(e(l,h),c)};o.next(u)}})}a();var Rr=new M("/local/filesroot");async function i_(r,e=()=>{}){if(e(100,"Migrating MFS root to repo datastore"),await r.root.open(),await r.datastore.open(),await r.root.has(Rr)){let t=await r.root.get(Rr);await r.datastore.put(Rr,t),await r.root.delete(Rr)}await r.datastore.close(),await r.root.close(),e(100,"Stored MFS root in repo datastore")}async function o_(r,e=()=>{}){if(e(100,"Migrating MFS root to repo root datastore"),await r.root.open(),await r.datastore.open(),await r.datastore.has(Rr)){let t=await r.datastore.get(Rr);await r.root.put(Rr,t),await r.datastore.delete(Rr)}await r.datastore.close(),await r.root.close(),e(100,"Stored MFS root in repo root datastore")}var gg={version:11,description:"Store mfs root in the datastore",migrate:i_,revert:o_};a();var Jf=x(kr(),1);a();var Dn=x(kr(),1),wg=Dn.default.Reader,s_=Dn.default.Writer,a_=Dn.default.util,Ea=Dn.default.roots.default||(Dn.default.roots.default={}),Lf=Ea.Protocols=(()=>{function r(e){if(this.protocols=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)e[t[n]]!=null&&(this[t[n]]=e[t[n]])}return r.prototype.protocols=a_.emptyArray,r.encode=function(t,n){if(n||(n=s_.create()),t.protocols!=null&&t.protocols.length)for(var i=0;i<t.protocols.length;++i)n.uint32(10).string(t.protocols[i]);return n},r.decode=function(t,n){t instanceof wg||(t=wg.create(t));for(var i=n===void 0?t.len:t.pos+n,o=new Ea.Protocols;t.pos<i;){var s=t.uint32();switch(s>>>3){case 1:o.protocols&&o.protocols.length||(o.protocols=[]),o.protocols.push(t.string());break;default:t.skipType(s&7);break}}return o},r.fromObject=function(t){if(t instanceof Ea.Protocols)return t;var n=new Ea.Protocols;if(t.protocols){if(!Array.isArray(t.protocols))throw TypeError(".Protocols.protocols: array expected");n.protocols=[];for(var i=0;i<t.protocols.length;++i)n.protocols[i]=String(t.protocols[i])}return n},r.toObject=function(t,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.protocols=[]),t.protocols&&t.protocols.length){i.protocols=[];for(var o=0;o<t.protocols.length;++o)i.protocols[o]=t.protocols[o]}return i},r.prototype.toJSON=function(){return this.constructor.toObject(this,Dn.default.util.toJSONOptions)},r})();a();var or=x(kr(),1),vi=or.default.Reader,Rf=or.default.Writer,G=or.default.util,pe=or.default.roots.default||(or.default.roots.default={}),Nf=pe.Addresses=(()=>{function r(e){if(this.addrs=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)e[t[n]]!=null&&(this[t[n]]=e[t[n]])}return r.prototype.addrs=G.emptyArray,r.prototype.certifiedRecord=null,r.encode=function(t,n){if(n||(n=Rf.create()),t.addrs!=null&&t.addrs.length)for(var i=0;i<t.addrs.length;++i)pe.Addresses.Address.encode(t.addrs[i],n.uint32(10).fork()).ldelim();return t.certifiedRecord!=null&&Object.hasOwnProperty.call(t,"certifiedRecord")&&pe.Addresses.CertifiedRecord.encode(t.certifiedRecord,n.uint32(18).fork()).ldelim(),n},r.decode=function(t,n){t instanceof vi||(t=vi.create(t));for(var i=n===void 0?t.len:t.pos+n,o=new pe.Addresses;t.pos<i;){var s=t.uint32();switch(s>>>3){case 1:o.addrs&&o.addrs.length||(o.addrs=[]),o.addrs.push(pe.Addresses.Address.decode(t,t.uint32()));break;case 2:o.certifiedRecord=pe.Addresses.CertifiedRecord.decode(t,t.uint32());break;default:t.skipType(s&7);break}}return o},r.fromObject=function(t){if(t instanceof pe.Addresses)return t;var n=new pe.Addresses;if(t.addrs){if(!Array.isArray(t.addrs))throw TypeError(".Addresses.addrs: array expected");n.addrs=[];for(var i=0;i<t.addrs.length;++i){if(typeof t.addrs[i]!="object")throw TypeError(".Addresses.addrs: object expected");n.addrs[i]=pe.Addresses.Address.fromObject(t.addrs[i])}}if(t.certifiedRecord!=null){if(typeof t.certifiedRecord!="object")throw TypeError(".Addresses.certifiedRecord: object expected");n.certifiedRecord=pe.Addresses.CertifiedRecord.fromObject(t.certifiedRecord)}return n},r.toObject=function(t,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.addrs=[]),n.defaults&&(i.certifiedRecord=null),t.addrs&&t.addrs.length){i.addrs=[];for(var o=0;o<t.addrs.length;++o)i.addrs[o]=pe.Addresses.Address.toObject(t.addrs[o],n)}return t.certifiedRecord!=null&&t.hasOwnProperty("certifiedRecord")&&(i.certifiedRecord=pe.Addresses.CertifiedRecord.toObject(t.certifiedRecord,n)),i},r.prototype.toJSON=function(){return this.constructor.toObject(this,or.default.util.toJSONOptions)},r.Address=function(){function e(n){if(n)for(var i=Object.keys(n),o=0;o<i.length;++o)n[i[o]]!=null&&(this[i[o]]=n[i[o]])}e.prototype.multiaddr=G.newBuffer([]),e.prototype.isCertified=null;let t;return Object.defineProperty(e.prototype,"_isCertified",{get:G.oneOfGetter(t=["isCertified"]),set:G.oneOfSetter(t)}),e.encode=function(i,o){return o||(o=Rf.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&o.uint32(10).bytes(i.multiaddr),i.isCertified!=null&&Object.hasOwnProperty.call(i,"isCertified")&&o.uint32(16).bool(i.isCertified),o},e.decode=function(i,o){i instanceof vi||(i=vi.create(i));for(var s=o===void 0?i.len:i.pos+o,c=new pe.Addresses.Address;i.pos<s;){var u=i.uint32();switch(u>>>3){case 1:c.multiaddr=i.bytes();break;case 2:c.isCertified=i.bool();break;default:i.skipType(u&7);break}}return c},e.fromObject=function(i){if(i instanceof pe.Addresses.Address)return i;var o=new pe.Addresses.Address;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?G.base64.decode(i.multiaddr,o.multiaddr=G.newBuffer(G.base64.length(i.multiaddr)),0):i.multiaddr.length&&(o.multiaddr=i.multiaddr)),i.isCertified!=null&&(o.isCertified=Boolean(i.isCertified)),o},e.toObject=function(i,o){o||(o={});var s={};return o.defaults&&(o.bytes===String?s.multiaddr="":(s.multiaddr=[],o.bytes!==Array&&(s.multiaddr=G.newBuffer(s.multiaddr)))),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=o.bytes===String?G.base64.encode(i.multiaddr,0,i.multiaddr.length):o.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),i.isCertified!=null&&i.hasOwnProperty("isCertified")&&(s.isCertified=i.isCertified,o.oneofs&&(s._isCertified="isCertified")),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,or.default.util.toJSONOptions)},e}(),r.CertifiedRecord=function(){function e(t){if(t)for(var n=Object.keys(t),i=0;i<n.length;++i)t[n[i]]!=null&&(this[n[i]]=t[n[i]])}return e.prototype.seq=G.Long?G.Long.fromBits(0,0,!0):0,e.prototype.raw=G.newBuffer([]),e.encode=function(n,i){return i||(i=Rf.create()),n.seq!=null&&Object.hasOwnProperty.call(n,"seq")&&i.uint32(8).uint64(n.seq),n.raw!=null&&Object.hasOwnProperty.call(n,"raw")&&i.uint32(18).bytes(n.raw),i},e.decode=function(n,i){n instanceof vi||(n=vi.create(n));for(var o=i===void 0?n.len:n.pos+i,s=new pe.Addresses.CertifiedRecord;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:s.seq=n.uint64();break;case 2:s.raw=n.bytes();break;default:n.skipType(c&7);break}}return s},e.fromObject=function(n){if(n instanceof pe.Addresses.CertifiedRecord)return n;var i=new pe.Addresses.CertifiedRecord;return n.seq!=null&&(G.Long?(i.seq=G.Long.fromValue(n.seq)).unsigned=!0:typeof n.seq=="string"?i.seq=parseInt(n.seq,10):typeof n.seq=="number"?i.seq=n.seq:typeof n.seq=="object"&&(i.seq=new G.LongBits(n.seq.low>>>0,n.seq.high>>>0).toNumber(!0))),n.raw!=null&&(typeof n.raw=="string"?G.base64.decode(n.raw,i.raw=G.newBuffer(G.base64.length(n.raw)),0):n.raw.length&&(i.raw=n.raw)),i},e.toObject=function(n,i){i||(i={});var o={};if(i.defaults){if(G.Long){var s=new G.Long(0,0,!0);o.seq=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else o.seq=i.longs===String?"0":0;i.bytes===String?o.raw="":(o.raw=[],i.bytes!==Array&&(o.raw=G.newBuffer(o.raw)))}return n.seq!=null&&n.hasOwnProperty("seq")&&(typeof n.seq=="number"?o.seq=i.longs===String?String(n.seq):n.seq:o.seq=i.longs===String?G.Long.prototype.toString.call(n.seq):i.longs===Number?new G.LongBits(n.seq.low>>>0,n.seq.high>>>0).toNumber(!0):n.seq),n.raw!=null&&n.hasOwnProperty("raw")&&(o.raw=i.bytes===String?G.base64.encode(n.raw,0,n.raw.length):i.bytes===Array?Array.prototype.slice.call(n.raw):n.raw),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,or.default.util.toJSONOptions)},e}(),r})();a();var sr=x(kr(),1),_i=sr.default.Reader,Pf=sr.default.Writer,j=sr.default.util,se=sr.default.roots.default||(sr.default.roots.default={}),Ff=se.Peer=(()=>{function r(t){if(this.addresses=[],this.protocols=[],this.metadata=[],t)for(var n=Object.keys(t),i=0;i<n.length;++i)t[n[i]]!=null&&(this[n[i]]=t[n[i]])}r.prototype.addresses=j.emptyArray,r.prototype.protocols=j.emptyArray,r.prototype.metadata=j.emptyArray,r.prototype.pubKey=null,r.prototype.peerRecordEnvelope=null;let e;return Object.defineProperty(r.prototype,"_pubKey",{get:j.oneOfGetter(e=["pubKey"]),set:j.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_peerRecordEnvelope",{get:j.oneOfGetter(e=["peerRecordEnvelope"]),set:j.oneOfSetter(e)}),r.encode=function(n,i){if(i||(i=Pf.create()),n.addresses!=null&&n.addresses.length)for(var o=0;o<n.addresses.length;++o)se.Address.encode(n.addresses[o],i.uint32(10).fork()).ldelim();if(n.protocols!=null&&n.protocols.length)for(var o=0;o<n.protocols.length;++o)i.uint32(18).string(n.protocols[o]);if(n.metadata!=null&&n.metadata.length)for(var o=0;o<n.metadata.length;++o)se.Metadata.encode(n.metadata[o],i.uint32(26).fork()).ldelim();return n.pubKey!=null&&Object.hasOwnProperty.call(n,"pubKey")&&i.uint32(34).bytes(n.pubKey),n.peerRecordEnvelope!=null&&Object.hasOwnProperty.call(n,"peerRecordEnvelope")&&i.uint32(42).bytes(n.peerRecordEnvelope),i},r.decode=function(n,i){n instanceof _i||(n=_i.create(n));for(var o=i===void 0?n.len:n.pos+i,s=new se.Peer;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:s.addresses&&s.addresses.length||(s.addresses=[]),s.addresses.push(se.Address.decode(n,n.uint32()));break;case 2:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(n.string());break;case 3:s.metadata&&s.metadata.length||(s.metadata=[]),s.metadata.push(se.Metadata.decode(n,n.uint32()));break;case 4:s.pubKey=n.bytes();break;case 5:s.peerRecordEnvelope=n.bytes();break;default:n.skipType(c&7);break}}return s},r.fromObject=function(n){if(n instanceof se.Peer)return n;var i=new se.Peer;if(n.addresses){if(!Array.isArray(n.addresses))throw TypeError(".Peer.addresses: array expected");i.addresses=[];for(var o=0;o<n.addresses.length;++o){if(typeof n.addresses[o]!="object")throw TypeError(".Peer.addresses: object expected");i.addresses[o]=se.Address.fromObject(n.addresses[o])}}if(n.protocols){if(!Array.isArray(n.protocols))throw TypeError(".Peer.protocols: array expected");i.protocols=[];for(var o=0;o<n.protocols.length;++o)i.protocols[o]=String(n.protocols[o])}if(n.metadata){if(!Array.isArray(n.metadata))throw TypeError(".Peer.metadata: array expected");i.metadata=[];for(var o=0;o<n.metadata.length;++o){if(typeof n.metadata[o]!="object")throw TypeError(".Peer.metadata: object expected");i.metadata[o]=se.Metadata.fromObject(n.metadata[o])}}return n.pubKey!=null&&(typeof n.pubKey=="string"?j.base64.decode(n.pubKey,i.pubKey=j.newBuffer(j.base64.length(n.pubKey)),0):n.pubKey.length&&(i.pubKey=n.pubKey)),n.peerRecordEnvelope!=null&&(typeof n.peerRecordEnvelope=="string"?j.base64.decode(n.peerRecordEnvelope,i.peerRecordEnvelope=j.newBuffer(j.base64.length(n.peerRecordEnvelope)),0):n.peerRecordEnvelope.length&&(i.peerRecordEnvelope=n.peerRecordEnvelope)),i},r.toObject=function(n,i){i||(i={});var o={};if((i.arrays||i.defaults)&&(o.addresses=[],o.protocols=[],o.metadata=[]),n.addresses&&n.addresses.length){o.addresses=[];for(var s=0;s<n.addresses.length;++s)o.addresses[s]=se.Address.toObject(n.addresses[s],i)}if(n.protocols&&n.protocols.length){o.protocols=[];for(var s=0;s<n.protocols.length;++s)o.protocols[s]=n.protocols[s]}if(n.metadata&&n.metadata.length){o.metadata=[];for(var s=0;s<n.metadata.length;++s)o.metadata[s]=se.Metadata.toObject(n.metadata[s],i)}return n.pubKey!=null&&n.hasOwnProperty("pubKey")&&(o.pubKey=i.bytes===String?j.base64.encode(n.pubKey,0,n.pubKey.length):i.bytes===Array?Array.prototype.slice.call(n.pubKey):n.pubKey,i.oneofs&&(o._pubKey="pubKey")),n.peerRecordEnvelope!=null&&n.hasOwnProperty("peerRecordEnvelope")&&(o.peerRecordEnvelope=i.bytes===String?j.base64.encode(n.peerRecordEnvelope,0,n.peerRecordEnvelope.length):i.bytes===Array?Array.prototype.slice.call(n.peerRecordEnvelope):n.peerRecordEnvelope,i.oneofs&&(o._peerRecordEnvelope="peerRecordEnvelope")),o},r.prototype.toJSON=function(){return this.constructor.toObject(this,sr.default.util.toJSONOptions)},r})(),IO=se.Address=(()=>{function r(t){if(t)for(var n=Object.keys(t),i=0;i<n.length;++i)t[n[i]]!=null&&(this[n[i]]=t[n[i]])}r.prototype.multiaddr=j.newBuffer([]),r.prototype.isCertified=null;let e;return Object.defineProperty(r.prototype,"_isCertified",{get:j.oneOfGetter(e=["isCertified"]),set:j.oneOfSetter(e)}),r.encode=function(n,i){return i||(i=Pf.create()),n.multiaddr!=null&&Object.hasOwnProperty.call(n,"multiaddr")&&i.uint32(10).bytes(n.multiaddr),n.isCertified!=null&&Object.hasOwnProperty.call(n,"isCertified")&&i.uint32(16).bool(n.isCertified),i},r.decode=function(n,i){n instanceof _i||(n=_i.create(n));for(var o=i===void 0?n.len:n.pos+i,s=new se.Address;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:s.multiaddr=n.bytes();break;case 2:s.isCertified=n.bool();break;default:n.skipType(c&7);break}}return s},r.fromObject=function(n){if(n instanceof se.Address)return n;var i=new se.Address;return n.multiaddr!=null&&(typeof n.multiaddr=="string"?j.base64.decode(n.multiaddr,i.multiaddr=j.newBuffer(j.base64.length(n.multiaddr)),0):n.multiaddr.length&&(i.multiaddr=n.multiaddr)),n.isCertified!=null&&(i.isCertified=Boolean(n.isCertified)),i},r.toObject=function(n,i){i||(i={});var o={};return i.defaults&&(i.bytes===String?o.multiaddr="":(o.multiaddr=[],i.bytes!==Array&&(o.multiaddr=j.newBuffer(o.multiaddr)))),n.multiaddr!=null&&n.hasOwnProperty("multiaddr")&&(o.multiaddr=i.bytes===String?j.base64.encode(n.multiaddr,0,n.multiaddr.length):i.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),n.isCertified!=null&&n.hasOwnProperty("isCertified")&&(o.isCertified=n.isCertified,i.oneofs&&(o._isCertified="isCertified")),o},r.prototype.toJSON=function(){return this.constructor.toObject(this,sr.default.util.toJSONOptions)},r})(),OO=se.Metadata=(()=>{function r(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)e[t[n]]!=null&&(this[t[n]]=e[t[n]])}return r.prototype.key="",r.prototype.value=j.newBuffer([]),r.encode=function(t,n){return n||(n=Pf.create()),t.key!=null&&Object.hasOwnProperty.call(t,"key")&&n.uint32(10).string(t.key),t.value!=null&&Object.hasOwnProperty.call(t,"value")&&n.uint32(18).bytes(t.value),n},r.decode=function(t,n){t instanceof _i||(t=_i.create(t));for(var i=n===void 0?t.len:t.pos+n,o=new se.Metadata;t.pos<i;){var s=t.uint32();switch(s>>>3){case 1:o.key=t.string();break;case 2:o.value=t.bytes();break;default:t.skipType(s&7);break}}return o},r.fromObject=function(t){if(t instanceof se.Metadata)return t;var n=new se.Metadata;return t.key!=null&&(n.key=String(t.key)),t.value!=null&&(typeof t.value=="string"?j.base64.decode(t.value,n.value=j.newBuffer(j.base64.length(t.value)),0):t.value.length&&(n.value=t.value)),n},r.toObject=function(t,n){n||(n={});var i={};return n.defaults&&(i.key="",n.bytes===String?i.value="":(i.value=[],n.bytes!==Array&&(i.value=j.newBuffer(i.value)))),t.key!=null&&t.hasOwnProperty("key")&&(i.key=t.key),t.value!=null&&t.hasOwnProperty("value")&&(i.value=n.bytes===String?j.base64.encode(t.value,0,t.value.length):n.bytes===Array?Array.prototype.slice.call(t.value):t.value),i},r.prototype.toJSON=function(){return this.constructor.toObject(this,sr.default.util.toJSONOptions)},r})();a();var Sn=x(kr(),1),bg=Sn.default.Reader,c_=Sn.default.Writer,J=Sn.default.util,xa=Sn.default.roots.default||(Sn.default.roots.default={}),Eg=xa.Envelope=(()=>{function r(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)e[t[n]]!=null&&(this[t[n]]=e[t[n]])}return r.prototype.publicKey=J.newBuffer([]),r.prototype.payloadType=J.newBuffer([]),r.prototype.payload=J.newBuffer([]),r.prototype.signature=J.newBuffer([]),r.encode=function(t,n){return n||(n=c_.create()),t.publicKey!=null&&Object.hasOwnProperty.call(t,"publicKey")&&n.uint32(10).bytes(t.publicKey),t.payloadType!=null&&Object.hasOwnProperty.call(t,"payloadType")&&n.uint32(18).bytes(t.payloadType),t.payload!=null&&Object.hasOwnProperty.call(t,"payload")&&n.uint32(26).bytes(t.payload),t.signature!=null&&Object.hasOwnProperty.call(t,"signature")&&n.uint32(42).bytes(t.signature),n},r.decode=function(t,n){t instanceof bg||(t=bg.create(t));for(var i=n===void 0?t.len:t.pos+n,o=new xa.Envelope;t.pos<i;){var s=t.uint32();switch(s>>>3){case 1:o.publicKey=t.bytes();break;case 2:o.payloadType=t.bytes();break;case 3:o.payload=t.bytes();break;case 5:o.signature=t.bytes();break;default:t.skipType(s&7);break}}return o},r.fromObject=function(t){if(t instanceof xa.Envelope)return t;var n=new xa.Envelope;return t.publicKey!=null&&(typeof t.publicKey=="string"?J.base64.decode(t.publicKey,n.publicKey=J.newBuffer(J.base64.length(t.publicKey)),0):t.publicKey.length&&(n.publicKey=t.publicKey)),t.payloadType!=null&&(typeof t.payloadType=="string"?J.base64.decode(t.payloadType,n.payloadType=J.newBuffer(J.base64.length(t.payloadType)),0):t.payloadType.length&&(n.payloadType=t.payloadType)),t.payload!=null&&(typeof t.payload=="string"?J.base64.decode(t.payload,n.payload=J.newBuffer(J.base64.length(t.payload)),0):t.payload.length&&(n.payload=t.payload)),t.signature!=null&&(typeof t.signature=="string"?J.base64.decode(t.signature,n.signature=J.newBuffer(J.base64.length(t.signature)),0):t.signature.length&&(n.signature=t.signature)),n},r.toObject=function(t,n){n||(n={});var i={};return n.defaults&&(n.bytes===String?i.publicKey="":(i.publicKey=[],n.bytes!==Array&&(i.publicKey=J.newBuffer(i.publicKey))),n.bytes===String?i.payloadType="":(i.payloadType=[],n.bytes!==Array&&(i.payloadType=J.newBuffer(i.payloadType))),n.bytes===String?i.payload="":(i.payload=[],n.bytes!==Array&&(i.payload=J.newBuffer(i.payload))),n.bytes===String?i.signature="":(i.signature=[],n.bytes!==Array&&(i.signature=J.newBuffer(i.signature)))),t.publicKey!=null&&t.hasOwnProperty("publicKey")&&(i.publicKey=n.bytes===String?J.base64.encode(t.publicKey,0,t.publicKey.length):n.bytes===Array?Array.prototype.slice.call(t.publicKey):t.publicKey),t.payloadType!=null&&t.hasOwnProperty("payloadType")&&(i.payloadType=n.bytes===String?J.base64.encode(t.payloadType,0,t.payloadType.length):n.bytes===Array?Array.prototype.slice.call(t.payloadType):t.payloadType),t.payload!=null&&t.hasOwnProperty("payload")&&(i.payload=n.bytes===String?J.base64.encode(t.payload,0,t.payload.length):n.bytes===Array?Array.prototype.slice.call(t.payload):t.payload),t.signature!=null&&t.hasOwnProperty("signature")&&(i.signature=n.bytes===String?J.base64.encode(t.signature,0,t.signature.length):n.bytes===Array?Array.prototype.slice.call(t.signature):t.signature),i},r.prototype.toJSON=function(){return this.constructor.toObject(this,Sn.default.util.toJSONOptions)},r})();a();var Nr=x(kr(),1),va=Nr.default.Reader,xg=Nr.default.Writer,Z=Nr.default.util,_t=Nr.default.roots.default||(Nr.default.roots.default={}),vg=_t.PeerRecord=(()=>{function r(e){if(this.addresses=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)e[t[n]]!=null&&(this[t[n]]=e[t[n]])}return r.prototype.peerId=Z.newBuffer([]),r.prototype.seq=Z.Long?Z.Long.fromBits(0,0,!0):0,r.prototype.addresses=Z.emptyArray,r.encode=function(t,n){if(n||(n=xg.create()),t.peerId!=null&&Object.hasOwnProperty.call(t,"peerId")&&n.uint32(10).bytes(t.peerId),t.seq!=null&&Object.hasOwnProperty.call(t,"seq")&&n.uint32(16).uint64(t.seq),t.addresses!=null&&t.addresses.length)for(var i=0;i<t.addresses.length;++i)_t.PeerRecord.AddressInfo.encode(t.addresses[i],n.uint32(26).fork()).ldelim();return n},r.decode=function(t,n){t instanceof va||(t=va.create(t));for(var i=n===void 0?t.len:t.pos+n,o=new _t.PeerRecord;t.pos<i;){var s=t.uint32();switch(s>>>3){case 1:o.peerId=t.bytes();break;case 2:o.seq=t.uint64();break;case 3:o.addresses&&o.addresses.length||(o.addresses=[]),o.addresses.push(_t.PeerRecord.AddressInfo.decode(t,t.uint32()));break;default:t.skipType(s&7);break}}return o},r.fromObject=function(t){if(t instanceof _t.PeerRecord)return t;var n=new _t.PeerRecord;if(t.peerId!=null&&(typeof t.peerId=="string"?Z.base64.decode(t.peerId,n.peerId=Z.newBuffer(Z.base64.length(t.peerId)),0):t.peerId.length&&(n.peerId=t.peerId)),t.seq!=null&&(Z.Long?(n.seq=Z.Long.fromValue(t.seq)).unsigned=!0:typeof t.seq=="string"?n.seq=parseInt(t.seq,10):typeof t.seq=="number"?n.seq=t.seq:typeof t.seq=="object"&&(n.seq=new Z.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0))),t.addresses){if(!Array.isArray(t.addresses))throw TypeError(".PeerRecord.addresses: array expected");n.addresses=[];for(var i=0;i<t.addresses.length;++i){if(typeof t.addresses[i]!="object")throw TypeError(".PeerRecord.addresses: object expected");n.addresses[i]=_t.PeerRecord.AddressInfo.fromObject(t.addresses[i])}}return n},r.toObject=function(t,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.addresses=[]),n.defaults)if(n.bytes===String?i.peerId="":(i.peerId=[],n.bytes!==Array&&(i.peerId=Z.newBuffer(i.peerId))),Z.Long){var o=new Z.Long(0,0,!0);i.seq=n.longs===String?o.toString():n.longs===Number?o.toNumber():o}else i.seq=n.longs===String?"0":0;if(t.peerId!=null&&t.hasOwnProperty("peerId")&&(i.peerId=n.bytes===String?Z.base64.encode(t.peerId,0,t.peerId.length):n.bytes===Array?Array.prototype.slice.call(t.peerId):t.peerId),t.seq!=null&&t.hasOwnProperty("seq")&&(typeof t.seq=="number"?i.seq=n.longs===String?String(t.seq):t.seq:i.seq=n.longs===String?Z.Long.prototype.toString.call(t.seq):n.longs===Number?new Z.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0):t.seq),t.addresses&&t.addresses.length){i.addresses=[];for(var s=0;s<t.addresses.length;++s)i.addresses[s]=_t.PeerRecord.AddressInfo.toObject(t.addresses[s],n)}return i},r.prototype.toJSON=function(){return this.constructor.toObject(this,Nr.default.util.toJSONOptions)},r.AddressInfo=function(){function e(t){if(t)for(var n=Object.keys(t),i=0;i<n.length;++i)t[n[i]]!=null&&(this[n[i]]=t[n[i]])}return e.prototype.multiaddr=Z.newBuffer([]),e.encode=function(n,i){return i||(i=xg.create()),n.multiaddr!=null&&Object.hasOwnProperty.call(n,"multiaddr")&&i.uint32(10).bytes(n.multiaddr),i},e.decode=function(n,i){n instanceof va||(n=va.create(n));for(var o=i===void 0?n.len:n.pos+i,s=new _t.PeerRecord.AddressInfo;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:s.multiaddr=n.bytes();break;default:n.skipType(c&7);break}}return s},e.fromObject=function(n){if(n instanceof _t.PeerRecord.AddressInfo)return n;var i=new _t.PeerRecord.AddressInfo;return n.multiaddr!=null&&(typeof n.multiaddr=="string"?Z.base64.decode(n.multiaddr,i.multiaddr=Z.newBuffer(Z.base64.length(n.multiaddr)),0):n.multiaddr.length&&(i.multiaddr=n.multiaddr)),i},e.toObject=function(n,i){i||(i={});var o={};return i.defaults&&(i.bytes===String?o.multiaddr="":(o.multiaddr=[],i.bytes!==Array&&(o.multiaddr=Z.newBuffer(o.multiaddr)))),n.multiaddr!=null&&n.hasOwnProperty("multiaddr")&&(o.multiaddr=i.bytes===String?Z.base64.encode(n.multiaddr,0,n.multiaddr.length):i.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,Nr.default.util.toJSONOptions)},e}(),r})();var Gf=x(ow(),1);Jf.default.util.Long=void 0;Jf.default.configure();async function R_(r,e=()=>{}){e(0,"Storing each peerstore key under a single datastore key"),await r.datastore.open();let t={},n=[];for await(let{key:i,value:o}of r.datastore.query({prefix:"/peers"})){n.push(i);let s=i.toString(),[c,u,f,l,h]=s.split("/");if(u==="peers"&&!!["protos","addrs","metadata","keys"].includes(f)&&!!l)if(t[l]=t[l]||{addresses:[],protocols:[],metadata:[]},f==="protos"){let d=Lf.decode(o);t[l].protocols=d.protocols.sort()}else if(f==="addrs"){let d=Nf.decode(o);t[l].addresses=d.addrs.sort((w,g)=>new Gf.Multiaddr(w.multiaddr).toString().localeCompare(new Gf.Multiaddr(g.multiaddr).toString())),d.certifiedRecord&&d.certifiedRecord.raw&&(t[l].peerRecordEnvelope=d.certifiedRecord.raw)}else f==="metadata"?t[l].metadata.push({key:h,value:o}):f==="keys"&&(t[l].pubKey=o)}e(33,"Read peer data from store");for(let i of n)await r.datastore.delete(i);e(66,"Removed existing peer data from store");for(let i of Object.keys(t)){let o=t[i];o.metadata=o.metadata.sort((c,u)=>c.key.localeCompare(u.key));let s=Ff.encode(o).finish();await r.datastore.put(new M(`/peers/${i}`),s)}await r.datastore.close(),e(100,"Stored each peerstore key under a single datastore key")}async function N_(r,e=()=>{}){e(0,"Storing each peerstore key under a multiple datastore keys"),await r.datastore.open();let t={},n=[];for await(let{key:i,value:o}of r.datastore.query({prefix:"/peers"})){n.push(i);let s=i.toString(),[c,u,f]=s.split("/");t[f]=Ff.decode(o)}e(33,"Read peer data from store");for(let i of n)await r.datastore.delete(i);e(66,"Removed existing peer data from store");for(let[i,o]of Object.entries(t)){if(o.protocols&&o.protocols.length>0&&await r.datastore.put(new M(`/peers/protos/${i}`),Lf.encode({protocols:o.protocols}).finish()),o.addresses&&o.addresses.length>0){let s=o.peerRecordEnvelope,c;if(s){let u=Eg.decode(s),f=vg.decode(u.payload);c={raw:s,seq:f.seq}}await r.datastore.put(new M(`/peers/addrs/${i}`),Nf.encode({addrs:o.addresses,certifiedRecord:c}).finish())}if(o.metadata&&o.metadata.length>0)for(let{key:s,value:c}of o.metadata)await r.datastore.put(new M(`/peers/metadata/${i}/${s}`),c);o.pubKey&&await r.datastore.put(new M(`/peers/keys/${i}`),o.pubKey)}await r.datastore.close(),e(100,"Stored each peerstore key under multiple datastore keys")}var sw={version:12,description:"Store each peerstore peer under a single datastore key",migrate:R_,revert:N_};var An={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0},Ba=[Object.assign({version:1},An),Object.assign({version:2},An),Object.assign({version:3},An),Object.assign({version:4},An),Object.assign({version:5},An),Object.assign({version:6},An),Object.assign({version:7},An),$p,lg,yg,gg,sw];a();a();var aw=x(tt(),1);var Qf={};H(Qf,{InvalidValueError:()=>Ii,MissingRepoOptionsError:()=>jt,NonReversibleMigrationError:()=>Ti,NotInitializedRepoError:()=>Fr,RequiredParameterError:()=>Ci});a();var Ti=class extends Error{constructor(e){super(e),this.name="NonReversibleMigrationError",this.code=Ti.code,this.message=e}};Ti.code="ERR_NON_REVERSIBLE_MIGRATION";var Fr=class extends Error{constructor(e){super(e),this.name="NotInitializedRepoError",this.code=Fr.code,this.message=e}};Fr.code="ERR_NOT_INITIALIZED_REPO";var Ci=class extends Error{constructor(e){super(e),this.name="RequiredParameterError",this.code=Ci.code,this.message=e}};Ci.code="ERR_REQUIRED_PARAMETER";var Ii=class extends Error{constructor(e){super(e),this.name="InvalidValueError",this.code=Ii.code,this.message=e}};Ii.code="ERR_INVALID_VALUE";var jt=class extends Error{constructor(e){super(e),this.name="MissingRepoOptionsError",this.code=jt.code,this.message=e}};jt.code="ERR_MISSING_REPO_OPTIONS";var Yf=(0,aw.default)("ipfs:repo:migrator:repo:init");async function cw(r){if(!r)throw new jt("Please pass repo options when trying to open a repo");let e=r.root;try{await e.open();let t=await e.has(ko),n=await e.has(hg);return!t||!n?(Yf(`Version entry present: ${t}`),Yf(`Config entry present: ${n}`),!1):!0}catch(t){return Yf("While checking if repo is initialized error was thrown: "+t.message),!1}finally{if(e!==void 0)try{await e.close()}catch{}}}ge();W();async function Xf(r){if(!await cw(r))throw new Fr("Repo is not initialized!");let e=r.root;await e.open();try{return parseInt(A(await e.get(ko)))}finally{await e.close()}}async function Uo(r,e){if(!e)throw new jt("Please pass repo options when trying to open a repo");let t=e.root;await t.open(),await t.put(ko,N(String(r))),await t.close()}var uw=x(tt(),1),At=(0,uw.default)("ipfs:repo:migrator");function F_(r){return r=r||Ba,!Array.isArray(r)||r.length===0?0:r[r.length-1].version}async function fw(r,e,t,n,{ignoreLock:i=!1,onProgress:o,isDryRun:s=!1,migrations:c}){if(c=c||Ba,!r)throw new ft.RequiredParameterError("Path argument is required!");if(!t)throw new ft.RequiredParameterError("repoOptions argument is required!");if(!n)throw new ft.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(n)||n<=0)throw new ft.InvalidValueError("Version has to be positive integer!");e=kf(e);let u=await Xf(e);if(u===n){At("Nothing to migrate.");return}if(u>n)throw new ft.InvalidValueError(`Current repo's version (${u}) is higher then toVersion (${n}), you probably wanted to revert it?`);hw(c,u,n);let f;!s&&!i&&(f=await t.repoLock.lock(r));try{for(let l of c){if(n!==void 0&&l.version>n)break;if(!(l.version<=u)){At(`Migrating version ${l.version}`);try{if(!s){let h=()=>{};o&&(h=(d,w)=>o(l.version,d.toFixed(2),w)),await l.migrate(e,h)}}catch(h){let d=l.version-1;throw At(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${d}`),await Uo(d,e),new Error(`During migration to version ${l.version} exception was raised: ${h.stack||h.message||h}`)}At(`Migrating to version ${l.version} finished`)}}s||await Uo(n||F_(c),e),At("Repo successfully migrated",n!==void 0?`to version ${n}!`:"to latest version!")}finally{!s&&!i&&f&&await f.close()}}async function lw(r,e,t,n,{ignoreLock:i=!1,onProgress:o,isDryRun:s=!1,migrations:c}){if(c=c||Ba,!r)throw new ft.RequiredParameterError("Path argument is required!");if(!t)throw new ft.RequiredParameterError("repoOptions argument is required!");if(!n)throw new ft.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(n)||n<=0)throw new ft.InvalidValueError("Version has to be positive integer!");e=kf(e);let u=await Xf(e);if(u===n){At("Nothing to revert.");return}if(u<n)throw new ft.InvalidValueError(`Current repo's version (${u}) is lower then toVersion (${n}), you probably wanted to migrate it?`);hw(c,n,u,!0);let f;!s&&!i&&(f=await t.repoLock.lock(r)),At(`Reverting from version ${u} to ${n}`);try{let l=c.slice().reverse();for(let h of l){if(h.version<=n)break;if(!(h.version>u)){At(`Reverting migration version ${h.version}`);try{if(!s){let d=()=>{};o&&(d=(w,g)=>o(h.version,w.toFixed(2),g)),await h.revert(e,d)}}catch(d){let w=h.version;throw At(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${w}`),await Uo(w,e),d.message=`During reversion to version ${h.version} exception was raised: ${d.message}`,d}At(`Reverting to version ${h.version} finished`)}}s||await Uo(n,e),At(`All migrations successfully reverted to version ${n}!`)}finally{!s&&!i&&f&&await f.close()}}function hw(r,e,t,n=!1){let i=0;for(let o of r){if(o.version>t)break;if(o.version>e){if(n&&!o.revert)throw new ft.NonReversibleMigrationError(`It is not possible to revert to version ${e} because migration version ${o.version} is not reversible. Cancelling reversion.`);i++}}if(i!==t-e)throw new ft.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${e} to ${t}`)}var ft=Qf;var qb=x(yw(),1);a();var Dw=x(_w(),1),Sw=Dw.default;a();a();a();W();ge();var ar="/",Aw=new TextEncoder().encode(ar),Na=Aw[0],K=class{constructor(e,t){if(typeof e=="string")this._buf=N(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==Na)throw new Error("Invalid key")}toString(e="utf8"){return A(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new K(e.join(ar))}static random(){return new K(nt().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new K(e):typeof e.uint8Array=="function"?new K(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=Aw),this._buf[0]!==Na){let e=new Uint8Array(this._buf.byteLength+1);e.fill(Na,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===Na;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),n=e.list();for(let i=0;i<t.length;i++){if(n.length<i+1)return!1;let o=t[i],s=n[i];if(o<s)return!0;if(o>s)return!1}return t.length<n.length}reverse(){return K.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(ar).slice(1)}type(){return J_(this.baseNamespace())}name(){return Q_(this.baseNamespace())}instance(e){return new K(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(ar)||(e+=ar),e+=this.type(),new K(e)}parent(){let e=this.list();return e.length===1?new K(ar):new K(e.slice(0,-1).join(ar))}child(e){return this.toString()===ar?e:e.toString()===ar?this:new K(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return K.withNamespaces([...this.namespaces(),...Y_(e.map(t=>t.namespaces()))])}};function J_(r){let e=r.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function Q_(r){let e=r.split(":");return e[e.length-1]}function Y_(r){return[].concat(...r)}var Ow=x(tt(),1);W();ge();a();a();var Tn=class extends Error{constructor(e){super(e),this.name="LockExistsError",this.code=Tn.code}};Tn.code="ERR_LOCK_EXISTS";var Ke=class extends Error{constructor(e){super(e),this.name="NotFoundError",this.code=Ke.code}};Ke.code="ERR_NOT_FOUND";var Cn=class extends Error{constructor(e){super(e),this.name="InvalidRepoVersionError",this.code=Cn.code}};Cn.code="ERR_INVALID_REPO_VERSION";var $o="ERR_REPO_NOT_INITIALIZED",Tw="ERR_REPO_ALREADY_OPEN",Cw="ERR_REPO_ALREADY_CLOSED";async function Pa(r,e,t){let n=await e(r);if(n)return n;let i=Iw(t);return i?new Promise((o,s)=>{let c=i.store("readonly").get(r.toString());c.transaction.onabort=()=>{s(c.transaction.error)},c.transaction.oncomplete=()=>{o(Boolean(c.result))}}):!1}async function Fa(r,e,t,n){if(await t(r))return e(r);let i=Iw(n);if(!i)throw new Ke;return new Promise((o,s)=>{let c=i.store("readonly").get(r.toString());c.transaction.onabort=()=>{s(c.transaction.error)},c.transaction.oncomplete=()=>{if(c.result)return o(c.result);s(new Ke)}})}function Iw(r){let e=r;for(;e.db||e.child;)if(e=e.db||e.child,e.type==="level-js"||e.constructor.name==="Level")return e}var Z_=(0,Ow.default)("ipfs:repo:version"),el=new K("version");function Bw(r){return{async exists(){return Pa(el,r.has.bind(r),r)},async get(){let e=await Fa(el,r.get.bind(r),r.has.bind(r),r);return parseInt(A(e),10)},set(e){return r.put(el,N(String(e)))},async check(e){let t=await this.get();return Z_("comparing version: %s and %s",t,e),t===e||(t===6&&e===7||e===6&&t===7)}}}a();a();var zw=x(Lw(),1);a();var jo=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},rl=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},Rw=r=>globalThis.DOMException===void 0?new rl(r):new DOMException(r),Nw=r=>{let e=r.reason===void 0?Rw("This operation was aborted."):r.reason;return e instanceof Error?e:Rw(e)};function nl(r,e,t,n){let i,o=new Promise((s,c)=>{if(typeof e!="number"||Math.sign(e)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${e}\``);if(e===Number.POSITIVE_INFINITY){s(r);return}if(n={customTimers:{setTimeout,clearTimeout},...n},n.signal){let{signal:u}=n;u.aborted&&c(Nw(u)),u.addEventListener("abort",()=>{c(Nw(u))})}i=n.customTimers.setTimeout.call(void 0,()=>{if(typeof t=="function"){try{s(t())}catch(l){c(l)}return}let u=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,f=t instanceof Error?t:new jo(u);typeof r.cancel=="function"&&r.cancel(),c(f)},e),(async()=>{try{s(await r)}catch(u){c(u)}finally{n.customTimers.clearTimeout.call(void 0,i)}})()});return o.clear=()=>{clearTimeout(i),i=void 0},o}a();a();function il(r,e,t){let n=0,i=r.length;for(;i>0;){let o=Math.trunc(i/2),s=n+o;t(r[s],e)<=0?(n=++s,i-=o+1):i=o}return n}var In=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},cr,zo=class{constructor(){cr.set(this,[])}enqueue(e,t){t={priority:0,...t};let n={priority:t.priority,run:e};if(this.size&&In(this,cr,"f")[this.size-1].priority>=t.priority){In(this,cr,"f").push(n);return}let i=il(In(this,cr,"f"),n,(o,s)=>s.priority-o.priority);In(this,cr,"f").splice(i,0,n)}dequeue(){let e=In(this,cr,"f").shift();return e?.run}filter(e){return In(this,cr,"f").filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return In(this,cr,"f").length}};cr=new WeakMap;var Y=function(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t},D=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},ie,Vo,Ko,Mr,Va,Wo,$a,Tt,qo,We,Ma,He,Ho,$r,ja,Pw,Fw,jw,Uw,$w,Mw,za,ol,sl,Ka,qa,rD=new jo,al=class extends Error{},zt=class extends zw.default{constructor(e){var t,n,i,o;if(super(),ie.add(this),Vo.set(this,void 0),Ko.set(this,void 0),Mr.set(this,0),Va.set(this,void 0),Wo.set(this,void 0),$a.set(this,0),Tt.set(this,void 0),qo.set(this,void 0),We.set(this,void 0),Ma.set(this,void 0),He.set(this,0),Ho.set(this,void 0),$r.set(this,void 0),ja.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:zo,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(o=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""}\` (${typeof e.interval})`);Y(this,Vo,e.carryoverConcurrencyCount,"f"),Y(this,Ko,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),Y(this,Va,e.intervalCap,"f"),Y(this,Wo,e.interval,"f"),Y(this,We,new e.queueClass,"f"),Y(this,Ma,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,Y(this,ja,e.throwOnTimeout===!0,"f"),Y(this,$r,e.autoStart===!1,"f")}get concurrency(){return D(this,Ho,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);Y(this,Ho,e,"f"),D(this,ie,"m",Ka).call(this)}async add(e,t={}){return new Promise((n,i)=>{let o=async()=>{var s,c,u;Y(this,He,(c=D(this,He,"f"),c++,c),"f"),Y(this,Mr,(u=D(this,Mr,"f"),u++,u),"f");try{if(!((s=t.signal)===null||s===void 0)&&s.aborted){i(new al("The task was aborted."));return}let l=await(this.timeout===void 0&&t.timeout===void 0?e({signal:t.signal}):nl(Promise.resolve(e({signal:t.signal})),t.timeout===void 0?this.timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?D(this,ja,"f"):t.throwOnTimeout)&&i(rD)}));n(l),this.emit("completed",l)}catch(f){i(f),this.emit("error",f)}D(this,ie,"m",jw).call(this)};D(this,We,"f").enqueue(o,t),D(this,ie,"m",za).call(this),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async n=>this.add(n,t)))}start(){return D(this,$r,"f")?(Y(this,$r,!1,"f"),D(this,ie,"m",Ka).call(this),this):this}pause(){Y(this,$r,!0,"f")}clear(){Y(this,We,new(D(this,Ma,"f")),"f")}async onEmpty(){D(this,We,"f").size!==0&&await D(this,ie,"m",qa).call(this,"empty")}async onSizeLessThan(e){D(this,We,"f").size<e||await D(this,ie,"m",qa).call(this,"next",()=>D(this,We,"f").size<e)}async onIdle(){D(this,He,"f")===0&&D(this,We,"f").size===0||await D(this,ie,"m",qa).call(this,"idle")}get size(){return D(this,We,"f").size}sizeBy(e){return D(this,We,"f").filter(e).length}get pending(){return D(this,He,"f")}get isPaused(){return D(this,$r,"f")}};Vo=new WeakMap,Ko=new WeakMap,Mr=new WeakMap,Va=new WeakMap,Wo=new WeakMap,$a=new WeakMap,Tt=new WeakMap,qo=new WeakMap,We=new WeakMap,Ma=new WeakMap,He=new WeakMap,Ho=new WeakMap,$r=new WeakMap,ja=new WeakMap,ie=new WeakSet,Pw=function(){return D(this,Ko,"f")||D(this,Mr,"f")<D(this,Va,"f")},Fw=function(){return D(this,He,"f")<D(this,Ho,"f")},jw=function(){var e;Y(this,He,(e=D(this,He,"f"),e--,e),"f"),D(this,ie,"m",za).call(this),this.emit("next")},Uw=function(){this.emit("empty"),D(this,He,"f")===0&&this.emit("idle")},$w=function(){D(this,ie,"m",sl).call(this),D(this,ie,"m",ol).call(this),Y(this,qo,void 0,"f")},Mw=function(){let e=Date.now();if(D(this,Tt,"f")===void 0){let t=D(this,$a,"f")-e;if(t<0)Y(this,Mr,D(this,Vo,"f")?D(this,He,"f"):0,"f");else return D(this,qo,"f")===void 0&&Y(this,qo,setTimeout(()=>{D(this,ie,"m",$w).call(this)},t),"f"),!0}return!1},za=function(){if(D(this,We,"f").size===0)return D(this,Tt,"f")&&clearInterval(D(this,Tt,"f")),Y(this,Tt,void 0,"f"),D(this,ie,"m",Uw).call(this),!1;if(!D(this,$r,"f")){let e=!D(this,ie,"a",Mw);if(D(this,ie,"a",Pw)&&D(this,ie,"a",Fw)){let t=D(this,We,"f").dequeue();return t?(this.emit("active"),t(),e&&D(this,ie,"m",ol).call(this),!0):!1}}return!1},ol=function(){D(this,Ko,"f")||D(this,Tt,"f")!==void 0||(Y(this,Tt,setInterval(()=>{D(this,ie,"m",sl).call(this)},D(this,Wo,"f")),"f"),Y(this,$a,Date.now()+D(this,Wo,"f"),"f"))},sl=function(){D(this,Mr,"f")===0&&D(this,He,"f")===0&&D(this,Tt,"f")&&(clearInterval(D(this,Tt,"f")),Y(this,Tt,void 0,"f")),Y(this,Mr,D(this,Vo,"f")?D(this,He,"f"):0,"f"),D(this,ie,"m",Ka).call(this)},Ka=function(){for(;D(this,ie,"m",za).call(this););},qa=async function(e,t){return new Promise(n=>{let i=()=>{t&&!t()||(this.off(e,i),n())};this.on(e,i)})};a();var Vw=nD;function nD(r,e,t){var n,i;if(Array.isArray(e)&&(n=e.slice(0)),typeof e=="string"&&(n=e.split(".")),typeof e=="symbol"&&(n=[e]),!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");if(i=n.pop(),!i)return!1;qw(i);for(var o;o=n.shift();)if(qw(o),typeof r[o]>"u"&&(r[o]={}),r=r[o],!r||typeof r!="object")return!1;return r[i]=t,!0}function qw(r){if(r=="__proto__"||r=="constructor"||r=="prototype")throw new Error("setting of prototype values not supported")}var Wa=x(Se(),1);W();ge();var iD=zt.default?zt.default:zt,cl=new K("config");function Kw(r){let e=new iD({concurrency:1}),t={async getAll(o={}){let s=await Fa(cl,r.get.bind(r),r.has.bind(r),r);return JSON.parse(A(s))},async get(o,s={}){if(o==null)throw new Ke(`Key ${o} does not exist in config`);let c=await this.getAll(s),u=ao(c,o);if(u===void 0)throw new Ke(`Key ${o} does not exist in config`);return u},set(o,s,c={}){if(typeof o!="string"&&!(o instanceof String))throw(0,Wa.default)(new Error("Invalid key type: "+typeof o),"ERR_INVALID_KEY");if(s===void 0||s instanceof Uint8Array)throw(0,Wa.default)(new Error("Invalid value type: "+typeof s),"ERR_INVALID_VALUE");return e.add(()=>n({key:o,value:s},c.signal))},replace(o,s={}){if(!o||o instanceof Uint8Array)throw(0,Wa.default)(new Error("Invalid value type: "+typeof o),"ERR_INVALID_VALUE");return e.add(()=>n({key:void 0,value:o},s.signal))},async exists(){return Pa(cl,r.has.bind(r),r)}};return t;async function n(o,s){if(s&&s.aborted)return;let c=o.key,u=o.value;if(c){let f=await t.getAll();return typeof f=="object"&&f!==null&&Vw(f,c,u),i(f)}return i(u)}function i(o){let s=N(JSON.stringify(o,null,2));return r.put(cl,s)}}a();a();a();a();function Go(r){if(typeof r!="object"||r===null)return!1;let e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)}function ul(r,e={}){if(!Go(r)&&!Array.isArray(r))throw new TypeError("Expected a plain object or array");let{deep:t,compare:n}=e,i=[],o=[],s=u=>{let f=i.indexOf(u);if(f!==-1)return o[f];let l=[];return i.push(u),o.push(l),l.push(...u.map(h=>Array.isArray(h)?s(h):Go(h)?c(h):h)),l},c=u=>{let f=i.indexOf(u);if(f!==-1)return o[f];let l={},h=Object.keys(u).sort(n);i.push(u),o.push(l);for(let d of h){let w=u[d],g;t&&Array.isArray(w)?g=s(w):g=t&&Go(w)?c(w):w,Object.defineProperty(l,d,{...Object.getOwnPropertyDescriptor(u,d),value:g})}return l};return Array.isArray(r)?t?s(r):r.slice():c(r)}W();ge();var fl=new K("datastore_spec");function Ww(r){return{exists(){return r.has(fl)},async get(){let e=await r.get(fl);return JSON.parse(A(e))},async set(e){return r.put(fl,N(JSON.stringify(ul(e,{deep:!0}))))}}}a();ge();var ll=new K("api");function Hw(r){return{async get(){let e=await r.get(ll);return e&&e.toString()},set(e){return r.put(ll,N(e.toString()))},delete(){return r.delete(ll)}}}a();var Yw=x(On(),1);a();a();var Ha=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},ki=class{constructor(e={}){this.hwm=e.splitLimit??16,this.head=new Ha(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return e?.byteLength!=null?e.byteLength:1}push(e){if(e?.value!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){let t=this.head;this.head=t.next=new Ha(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return e?.value!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}};function Jw(r={}){return sD(t=>{let n=t.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},r)}function sD(r,e){e=e??{};let t=e.onEnd,n=new ki,i,o,s,c=async()=>n.isEmpty()?s?{done:!0}:await new Promise((m,I)=>{o=U=>{o=null,n.push(U);try{m(r(n))}catch(ee){I(ee)}return i}}):r(n),u=m=>o!=null?o(m):(n.push(m),i),f=m=>(n=new ki,o!=null?o({error:m}):(n.push({error:m}),i)),l=m=>{if(s)return i;if(e?.objectMode!==!0&&m?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return u({done:!1,value:m})},h=m=>s?i:(s=!0,m!=null?f(m):u({done:!0})),d=()=>(n=new ki,h(),{done:!0}),w=m=>(h(m),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:c,return:d,throw:w,push:l,end:h,get readableLength(){return n.size}},t==null)return i;let g=i;return i={[Symbol.asyncIterator](){return this},next(){return g.next()},throw(m){return g.throw(m),t!=null&&(t(m),t=void 0),{done:!0}},return(){return g.return(),t!=null&&(t(),t=void 0),{done:!0}},push:l,end(m){return g.end(m),t!=null&&(t(m),t=void 0),i},get readableLength(){return g.readableLength}},i}var Xw=x(Bn(),1);V();var Zw=x(Se(),1);Hs();function eb(r){return{open(){return r.open()},close(){return r.close()},query(e,t){return r.query(e,t)},queryKeys(e,t){return r.queryKeys(e,t)},async get(e,t){let n=jr(e);return n.isIdentity?Promise.resolve(n.digest):r.get(e,t)},async*getMany(e,t){for await(let n of e)yield this.get(n,t)},async put(e,t,n){let{isIdentity:i}=jr(e);i||await r.put(e,t,n)},async*putMany(e,t){let n=Jw({objectMode:!0});(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)(async()=>{try{await(0,Xw.default)(r.putMany(async function*(){for await(let{key:o,value:s}of e)jr(o).isIdentity||(yield{key:o,value:s}),n.push({key:o,value:s})}())),n.end()}catch(o){n.end(o)}}),yield*n},has(e,t){let{isIdentity:n}=jr(e);return n?Promise.resolve(!0):r.has(e,t)},delete(e,t){let{isIdentity:n}=jr(e);return n?Promise.resolve():r.delete(e,t)},deleteMany(e,t){return r.deleteMany((0,Yw.default)(e,n=>!jr(n).isIdentity),t)},batch(){let e=r.batch();return{put(t,n){let{isIdentity:i}=jr(t);i||e.put(t,n)},delete(t){let{isIdentity:n}=jr(t);n||e.delete(t)},commit:t=>e.commit(t)}}}}function jr(r){let e=E.asCID(r);if(e==null)throw(0,Zw.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");return e.multihash.code!==li.code?{isIdentity:!1}:{isIdentity:!0,digest:e.multihash.digest}}a();a();var tb=x(tt(),1),rb=(0,tb.default)("ipfs:repo:lock:memory"),nb="repo.lock",Jo={};async function cD(r){let e=r+"/"+nb;if(rb("locking %s",e),Jo[e]===!0)throw new Tn(`Lock already being held for file: ${e}`);return Jo[e]=!0,{async close(){Jo[e]&&delete Jo[e]}}}async function uD(r){let e=r+"/"+nb;return rb(`checking lock: ${e}`),Boolean(Jo[e])}var Ga={lock:cD,locked:uD};var ib={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:Ga};a();var hl={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}};a();V();var ub=x(Se(),1),fb=x(tt(),1),wl=x(dl(),1);a();hi();var Ja=({enumerable:r=!0,configurable:e=!1}={})=>({enumerable:r,configurable:e,writable:!1}),pl=function*(r,e){if(r!=null&&!(r instanceof Uint8Array))for(let[t,n]of Object.entries(r)){let i=[...e,t];if(n!=null&&typeof n=="object")if(Array.isArray(n))for(let[o,s]of n.entries()){let c=[...i,o],u=E.asCID(s);u?yield[c.join("/"),u]:typeof s=="object"&&(yield*pl(s,c))}else{let o=E.asCID(n);o?yield[i.join("/"),o]:yield*pl(n,i)}}},yl=function*(r,e){if(r!=null)for(let[t,n]of Object.entries(r)){let i=[...e,t];if(yield i.join("/"),n!=null&&!(n instanceof Uint8Array)&&typeof n=="object"&&!E.asCID(n))if(Array.isArray(n))for(let[o,s]of n.entries()){let c=[...i,o];yield c.join("/"),typeof s=="object"&&!E.asCID(s)&&(yield*yl(s,c))}else yield*yl(n,i)}},lD=(r,e)=>{let t=r;for(let[n,i]of e.entries()){if(t=t[i],t==null)throw new Error(`Object has no property at ${e.slice(0,n+1).map(s=>`[${JSON.stringify(s)}]`).join("")}`);let o=E.asCID(t);if(o)return{value:o,remaining:e.slice(n+1).join("/")}}return{value:t}},Qa=class{constructor({cid:e,bytes:t,value:n}){if(!e||!t||typeof n>"u")throw new Error("Missing required argument");this.cid=e,this.bytes=t,this.value=n,this.asBlock=this,Object.defineProperties(this,{cid:Ja(),bytes:Ja(),value:Ja(),asBlock:Ja()})}links(){return pl(this.value,[])}tree(){return yl(this.value,[])}get(e="/"){return lD(this.value,e.split("/").filter(Boolean))}},ml=async({value:r,codec:e,hasher:t})=>{if(typeof r>"u")throw new Error('Missing required argument "value"');if(!e||!t)throw new Error("Missing required argument: codec or hasher");let n=e.encode(r),i=await t.digest(n),o=E.create(1,e.code,i);return new Qa({value:r,bytes:n,cid:o})};var kn=({bytes:r,cid:e,value:t,codec:n})=>{let i=t!==void 0?t:n&&n.decode(r);if(i===void 0)throw new Error('Missing required argument, must either provide "value" or "codec"');return new Qa({cid:e,bytes:r,value:i})},sb=async({bytes:r,cid:e,hasher:t,codec:n})=>{if(!r)throw new Error('Missing required argument "bytes"');if(!t)throw new Error('Missing required argument "hasher"');let i=n.decode(r),o=await t.digest(r);if(!mn.equals(e.multihash.bytes,o.bytes))throw new Error("CID hash does not match bytes");return kn({bytes:r,cid:e,value:i,codec:n})};a();hi();Ar();var ab=x(Se(),1);Ce();Te();function Qo(r){let e=E.asCID(r);if(e==null)throw(0,ab.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");let t=k.encode(e.multihash.bytes);return new K("/"+t.slice(1).toUpperCase(),!1)}function gl(r){return re(k.decode(`b${r.toString().toLowerCase().substring(1)}`))}a();var cb=x(tt(),1);var dD=(0,cb.default)("ipfs:repo:utils:walk-dag");async function*Li(r,e,t,n){try{let i=await e.get(r,n),o=await t(r.code),s=kn({bytes:i,cid:r,codec:o});for(let[,c]of s.links())yield c,yield*Li(c,e,t,n)}catch(i){throw dD("Could not walk DAG for CID",r.toString(),i),i}}a();var Pe={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"};a();var Yo=class extends Map{constructor(e={}){if(super(),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if(typeof e.maxAge=="number"&&e.maxAge===0)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if(typeof this.onEviction=="function")for(let[t,n]of e)this.onEviction(t,n.value)}_deleteIfExpired(e,t){return typeof t.expiry=="number"&&t.expiry<=Date.now()?(typeof this.onEviction=="function"&&this.onEviction(e,t.value),this.delete(e)):!1}_getOrDeleteIfExpired(e,t){if(this._deleteIfExpired(e,t)===!1)return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){let n=t.get(e);return this._getItemValue(e,n)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(let e of this.oldCache){let[t,n]=e;this.cache.has(t)||this._deleteIfExpired(t,n)===!1&&(yield e)}for(let e of this.cache){let[t,n]=e;this._deleteIfExpired(t,n)===!1&&(yield e)}}get(e){if(this.cache.has(e)){let t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){let t=this.oldCache.get(e);if(this._deleteIfExpired(e,t)===!1)return this._moveToRecent(e,t),t.value}}set(e,t,{maxAge:n=this.maxAge}={}){let i=typeof n=="number"&&n!==Number.POSITIVE_INFINITY?Date.now()+n:void 0;this.cache.has(e)?this.cache.set(e,{value:t,expiry:i}):this._set(e,{value:t,expiry:i})}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):this.oldCache.has(e)?!this._deleteIfExpired(e,this.oldCache.get(e)):!1}peek(e){if(this.cache.has(e))return this._peek(e,this.cache);if(this.oldCache.has(e))return this._peek(e,this.oldCache)}delete(e){let t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");let t=[...this._entriesAscending()],n=t.length-e;n<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(n>0&&this._emitEvictions(t.slice(0,n)),this.oldCache=new Map(t.slice(n)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(let[e]of this)yield e}*values(){for(let[,e]of this)yield e}*[Symbol.iterator](){for(let e of this.cache){let[t,n]=e;this._deleteIfExpired(t,n)===!1&&(yield[t,n.value])}for(let e of this.oldCache){let[t,n]=e;this.cache.has(t)||this._deleteIfExpired(t,n)===!1&&(yield[t,n.value])}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){let n=e[t],[i,o]=n;this._deleteIfExpired(i,o)===!1&&(yield[i,o.value])}e=[...this.oldCache];for(let t=e.length-1;t>=0;--t){let n=e[t],[i,o]=n;this.cache.has(i)||this._deleteIfExpired(i,o)===!1&&(yield[i,o.value])}}*entriesAscending(){for(let[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(let t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}entries(){return this.entriesAscending()}forEach(e,t=this){for(let[n,i]of this.entriesAscending())e.call(t,i,n,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}};var pD=2048;function yD(r){let e=`Invalid type '${r}', must be one of {direct, indirect, recursive, all}`;return(0,ub.default)(new Error(e),"ERR_INVALID_PIN_TYPE")}var Ya=class{constructor({pinstore:e,blockstore:t,loadCodec:n}){this.pinstore=e,this.blockstore=t,this.loadCodec=n,this.log=(0,fb.default)("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(e,t={}){await this.blockstore.get(e,t);let n={depth:0};return e.version!==0&&(n.version=e.version),e.code!==wt&&(n.codec=e.code),t.metadata&&(n.metadata=t.metadata),this.pinstore.put(Qo(e),nr(n))}unpin(e,t){return this.pinstore.delete(Qo(e),t)}async pinRecursively(e,t={}){await this.fetchCompleteDag(e,t);let n={depth:1/0};e.version!==0&&(n.version=e.version),e.code!==wt&&(n.codec=e.code),t.metadata&&(n.metadata=t.metadata),await this.pinstore.put(Qo(e),nr(n))}async*directKeys(e){for await(let t of this.pinstore.query({filters:[n=>st(n.value).depth===0]})){let n=st(t.value),i=n.version||0,o=n.codec!=null?n.codec:wt,s=gl(t.key);yield{cid:E.create(i,o,s),metadata:n.metadata}}}async*recursiveKeys(e){for await(let t of this.pinstore.query({filters:[n=>st(n.value).depth===1/0]})){let n=st(t.value),i=n.version||0,o=n.codec!=null?n.codec:wt,s=gl(t.key);yield{cid:E.create(i,o,s),metadata:n.metadata}}}async*indirectKeys(e){for await(let{cid:t}of this.recursiveKeys())for await(let n of Li(t,this.blockstore,this.loadCodec,e)){let i=[Pe.recursive];(await this.isPinnedWithType(n,i)).pinned||(yield n)}}async isPinnedWithType(e,t,n){Array.isArray(t)||(t=[t]);let i=t.includes(Pe.all),o=t.includes(Pe.direct),s=t.includes(Pe.recursive),c=t.includes(Pe.indirect);if(s||o||i){let l=await(0,wl.default)(this.pinstore.query({prefix:Qo(e).toString(),filters:[h=>{if(i)return!0;let d=st(h.value);return t.includes(d.depth===0?Pe.direct:Pe.recursive)}],limit:1}));if(l){let h=st(l.value);return{cid:e,pinned:!0,reason:h.depth===0?Pe.direct:Pe.recursive,metadata:h.metadata}}}let u=this;async function*f(l,h){for await(let{cid:d}of h)for await(let w of Li(d,u.blockstore,u.loadCodec))if(w.equals(l)){yield d;return}}if(i||c){let l=await(0,wl.default)(f(e,this.recursiveKeys()));if(l)return{cid:e,pinned:!0,reason:Pe.indirect,parent:l}}return{cid:e,pinned:!1}}async fetchCompleteDag(e,t={}){let n=new Yo({maxSize:t.cidCacheMaxSize??pD}),i=async(o,s)=>{if(n.has(o.toString()))return;n.set(o.toString(),!0);let c=await this.blockstore.get(o,s),u=await this.loadCodec(o.code),f=kn({bytes:c,cid:o,codec:u});await Promise.all([...f.links()].map(([,l])=>i(l,s)))};await i(e,t)}static checkPinType(e){if(typeof e!="string"||!Object.keys(Pe).includes(e))throw yD(e);return!0}};a();var db=x(Ri(),1),pb=x(Se(),1);function yb(r,e){return{open(){return e.open()},close(){return e.close()},query(t,n){return e.query(t,n)},queryKeys(t,n){return e.queryKeys(t,n)},async get(t,n){return e.get(t,n)},async*getMany(t,n){yield*e.getMany(t,n)},async put(t,n,i){await e.put(t,n,i)},async*putMany(t,n){yield*e.putMany(t,n)},has(t,n){return e.has(t,n)},async delete(t,n){return await hb(t,r),e.delete(t,n)},deleteMany(t,n){return e.deleteMany((0,db.default)(t,async i=>(await hb(i,r),i)),n)},batch(){return e.batch()}}}async function hb(r,e){let{pinned:t,reason:n}=await e.isPinnedWithType(r,Pe.all);if(t)throw(0,pb.default)(new Error(`pinned: ${n}`),"ERR_BLOCK_PINNED")}a();a();var bl=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},El=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},mb=r=>globalThis.DOMException===void 0?new El(r):new DOMException(r),gb=r=>{let e=r.reason===void 0?mb("This operation was aborted."):r.reason;return e instanceof Error?e:mb(e)};function xl(r,e){let{milliseconds:t,fallback:n,message:i,customTimers:o={setTimeout,clearTimeout}}=e,s,c=new Promise((u,f)=>{if(typeof t!="number"||Math.sign(t)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t===Number.POSITIVE_INFINITY){u(r);return}if(e.signal){let{signal:l}=e;l.aborted&&f(gb(l)),l.addEventListener("abort",()=>{f(gb(l))})}s=o.setTimeout.call(void 0,()=>{if(n){try{u(n())}catch(d){f(d)}return}let l=typeof i=="string"?i:`Promise timed out after ${t} milliseconds`,h=i instanceof Error?i:new bl(l);typeof r.cancel=="function"&&r.cancel(),f(h)},t),(async()=>{try{u(await r)}catch(l){f(l)}finally{o.clearTimeout.call(void 0,s)}})()});return c.clear=()=>{o.clearTimeout.call(void 0,s),s=void 0},c}a();a();var wb=(r=21)=>crypto.getRandomValues(new Uint8Array(r)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");a();var vl="lock:worker:request-read",_l="lock:worker:release-read",Dl="lock:master:grant-read",Sl="lock:worker:request-write",Al="lock:worker:release-write",Tl="lock:master:grant-write";a();var zr={},Ni=r=>{r.addEventListener("message",e=>{Ni.dispatchEvent("message",r,e)}),r.port!=null&&r.port.addEventListener("message",e=>{Ni.dispatchEvent("message",r,e)})};Ni.addEventListener=(r,e)=>{zr[r]==null&&(zr[r]=[]),zr[r].push(e)};Ni.removeEventListener=(r,e)=>{zr[r]!=null&&(zr[r]=zr[r].filter(t=>t===e))};Ni.dispatchEvent=function(r,e,t){zr[r]!=null&&zr[r].forEach(n=>n(e,t))};var Cl=Ni;var bb=(r,e,t,n,i)=>(o,s)=>{if(s.data.type!==t)return;let c={type:s.data.type,name:s.data.name,identifier:s.data.identifier};r.dispatchEvent(new MessageEvent(e,{data:{name:c.name,handler:async()=>(o.postMessage({type:i,name:c.name,identifier:c.identifier}),await new Promise(u=>{let f=l=>{if(l==null||l.data==null)return;let h={type:l.data.type,name:l.data.name,identifier:l.data.identifier};h.type===n&&h.identifier===c.identifier&&(o.removeEventListener("message",f),u())};o.addEventListener("message",f)}))}}))},Eb=(r,e,t,n)=>async()=>{let i=wb();return globalThis.postMessage({type:e,identifier:i,name:r}),await new Promise(o=>{let s=c=>{if(c==null||c.data==null)return;let u={type:c.data.type,identifier:c.data.identifier};u.type===t&&u.identifier===i&&(globalThis.removeEventListener("message",s),o(()=>{globalThis.postMessage({type:n,identifier:i,name:r})}))};globalThis.addEventListener("message",s)})},gD={singleProcess:!1},xb=r=>{if(r=Object.assign({},gD,r),Boolean(globalThis.document)||r.singleProcess){let t=new EventTarget;return Cl.addEventListener("message",bb(t,"requestReadLock",vl,_l,Dl)),Cl.addEventListener("message",bb(t,"requestWriteLock",Sl,Al,Tl)),t}return{isWorker:!0,readLock:t=>Eb(t,vl,Dl,_l),writeLock:t=>Eb(t,Sl,Tl,Al)}};var Ln={},qr;async function Il(r,e){let t,n=new Promise(i=>{t=i});return r.add(async()=>await xl((async()=>await new Promise(i=>{t(()=>{i()})}))(),{milliseconds:e.timeout})),await n}var wD=(r,e)=>{if(qr.isWorker===!0)return{readLock:qr.readLock(r,e),writeLock:qr.writeLock(r,e)};let t=new zt({concurrency:1}),n;return{async readLock(){if(n!=null)return await Il(n,e);n=new zt({concurrency:e.concurrency,autoStart:!1});let i=n,o=Il(n,e);return t.add(async()=>(i.start(),await i.onIdle().then(()=>{n===i&&(n=null)}))),await o},async writeLock(){return n=null,await Il(t,e)}}},bD={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function Ol(r){let e=Object.assign({},bD,r);return qr==null&&(qr=xb(e),qr.isWorker!==!0&&(qr.addEventListener("requestReadLock",t=>{Ln[t.data.name]!=null&&Ln[t.data.name].readLock().then(async n=>await t.data.handler().finally(()=>n()))}),qr.addEventListener("requestWriteLock",async t=>{Ln[t.data.name]!=null&&Ln[t.data.name].writeLock().then(async n=>await t.data.handler().finally(()=>n()))}))),Ln[e.name]==null&&(Ln[e.name]=wD(e.name,e)),Ln[e.name]}a();V();var Fb=x(tt(),1);var Ub=x(Sb(),1);a();a();a();var Xa=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},Pi=class{constructor(e={}){this.hwm=e.splitLimit??16,this.head=new Xa(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return e?.byteLength!=null?e.byteLength:1}push(e){if(e?.value!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){let t=this.head;this.head=t.next=new Xa(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return e?.value!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}};function Ab(r={}){return _D(t=>{let n=t.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},r)}function _D(r,e){e=e??{};let t=e.onEnd,n=new Pi,i,o,s,c=async()=>n.isEmpty()?s?{done:!0}:await new Promise((m,I)=>{o=U=>{o=null,n.push(U);try{m(r(n))}catch(ee){I(ee)}return i}}):r(n),u=m=>o!=null?o(m):(n.push(m),i),f=m=>(n=new Pi,o!=null?o({error:m}):(n.push({error:m}),i)),l=m=>{if(s)return i;if(e?.objectMode!==!0&&m?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return u({done:!1,value:m})},h=m=>s?i:(s=!0,m!=null?f(m):u({done:!0})),d=()=>(n=new Pi,h(),{done:!0}),w=m=>(h(m),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:c,return:d,throw:w,push:l,end:h,get readableLength(){return n.size}},t==null)return i;let g=i;return i={[Symbol.asyncIterator](){return this},next(){return g.next()},throw(m){return g.throw(m),t!=null&&(t(m),t=void 0),{done:!0}},return(){return g.return(),t!=null&&(t(),t=void 0),{done:!0}},push:l,end(m){return g.end(m),t!=null&&(t(m),t=void 0),i},get readableLength(){return g.readableLength}},i}var Nb=x(Za(),1),AD=(...r)=>{let e;for(;r.length>0;)e=r.shift()(e);return e},Pb=r=>r!=null&&(typeof r[Symbol.asyncIterator]=="function"||typeof r[Symbol.iterator]=="function"||typeof r.next=="function"),kl=r=>r!=null&&typeof r.sink=="function"&&Pb(r.source),TD=r=>e=>{let t=r.sink(e);if(t.then!=null){let n=Ab({objectMode:!0});return t.then(()=>{n.end()},o=>{n.end(o)}),(0,Nb.default)(n,async function*(){yield*r.source,n.end()}())}return r.source};function Ll(r,...e){if(kl(r)){let n=r;r=()=>n.source}else if(Pb(r)){let n=r;r=()=>n}let t=[r,...e];if(t.length>1&&kl(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink),t.length>2)for(let n=1;n<t.length-1;n++)kl(t[n])&&(t[n]=TD(t[n]));return AD(...t)}var Rl=x(Za(),1),ec=x(Ri(),1),$b=x(On(),1);Ce();var Xo=(0,Fb.default)("ipfs:repo:gc"),CD=ir().code,ID=256,OD=new K("/local/filesroot");function Mb({gcLock:r,pins:e,blockstore:t,root:n,loadCodec:i}){async function*o(){let s=Date.now();Xo("Creating set of marked blocks");let c=await r.writeLock();try{let u=await BD({pins:e,blockstore:t,root:n,loadCodec:i}),f=t.queryKeys({});yield*kD({blockstore:t},u,f),Xo(`Complete (${Date.now()-s}ms)`)}finally{c()}}return o}async function BD({pins:r,blockstore:e,loadCodec:t,root:n}){let i=async function*(){let c;try{c=await n.get(OD)}catch(f){if(f.code===CD){Xo("No blocks in MFS");return}throw f}let u=E.decode(c);yield u,yield*Li(u,e,t)}(),o=(0,Rl.default)((0,ec.default)(r.recursiveKeys(),({cid:c})=>c),r.indirectKeys(),(0,ec.default)(r.directKeys(),({cid:c})=>c),i),s=new Set;for await(let c of(0,Rl.default)(o,i))s.add(k.encode(c.multihash.bytes));return s}async function*kD({blockstore:r},e,t){let n=0,i=0;yield*Ll((0,Ub.default)((0,ec.default)(t,async s=>async function(){n++;try{let u=k.encode(s.multihash.bytes);if(e.has(u))return null;try{await r.delete(s),i++}catch(f){return{err:new Error(`Could not delete block with CID ${s}: ${f.message}`)}}return{cid:s}}catch(u){let f=`Could delete block with CID ${s}`;return Xo(f,u),{err:new Error(f+`: ${u.message}`)}}}),ID),s=>(0,$b.default)(s,Boolean)),Xo(`Marked set has ${e.size} unique blocks. Blockstore has ${n} blocks. Deleted ${i} blocks.`)}var Fe=(0,zb.default)("ipfs:repo"),LD=Number.MAX_SAFE_INTEGER,RD="repoAutoMigrate",Pl=class{constructor(e,t,n,i){if(typeof e!="string")throw new Error("missing repo path");if(typeof t!="function")throw new Error("missing codec loader");this.options=Sw(ib,i),this.closed=!0,this.path=e,this.root=n.root,this.datastore=n.datastore,this.keys=n.keys;let o=n.blocks,s=n.pins;this.pins=new Ya({pinstore:s,blockstore:o,loadCodec:t});let c=yb(this.pins,o);this.blocks=eb(c),this.version=Bw(this.root),this.config=Kw(this.root),this.spec=Ww(this.root),this.apiAddr=Hw(this.root),this.gcLock=Ol({name:e,singleProcess:this.options.repoOwner!==!1}),this.gc=Mb({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:t})}async init(e){Fe("initializing at: %s",this.path),await this._openRoot(),await this.config.replace(ND(e)),await this.spec.set(PD(e)),await this.version.set(12)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch{return!1}}async open(){if(!this.closed)throw(0,Rn.default)(new Error("repo is already open"),Tw);Fe("opening at: %s",this.path);try{if(await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),Fe("acquired repo.lock"),!await this.version.check(12))if(await this._isAutoMigrationEnabled())await this._migrate(12,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys});else throw new Cn("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");Fe("creating datastore"),await this.datastore.open(),Fe("creating blocks"),await this.blocks.open(),Fe("creating keystore"),await this.keys.open(),Fe("creating pins"),await this.pins.pinstore.open(),this.closed=!1,Fe("all opened")}catch(e){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch(t){Fe("error removing lock",t)}throw e}}async _openRoot(){try{await this.root.open()}catch(e){if(e.message!=="Already open")throw e}}async _openLock(){let e=await this.options.repoLock.lock(this.path);if(typeof e.close!="function")throw(0,Rn.default)(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return e}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){Fe("init check");let e;try{[e]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(t){throw t.code==="ERR_NOT_FOUND"?(0,Rn.default)(new Error("repo is not initialized yet"),$o,{path:this.path}):t}if(!e)throw(0,Rn.default)(new Error("repo is not initialized yet"),$o,{path:this.path})}async close(){if(this.closed)throw(0,Rn.default)(new Error("repo is already closed"),Cw);Fe("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(e){if(e.code!==$o&&!e.message.startsWith("ENOENT"))throw e}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map(e=>e&&e.close())),Fe("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){let[e,t,n,i,o]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),jb(this.datastore),jb(this.keys)]),s=t.size+i+o;return{repoPath:this.path,storageMax:e,version:n,numObjects:t.count,repoSize:s}}throw(0,Rn.default)(new Error("repo is not initialized yet"),$o,{path:this.path})}async _isAutoMigrationEnabled(){if(this.options.autoMigrate!==void 0)return this.options.autoMigrate;let e;try{e=await this.config.get(RD)}catch(t){if(t.code===Ke.code)e=!0;else throw t}return e}async _migrate(e,t){return await this.version.get()>e?(Fe(`reverting to version ${e}`),lw(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(Fe(`migrating to version ${e}`),fw(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{let e=await this.config.get("Datastore.StorageMax");return BigInt((0,qb.default)(e))}catch{return BigInt(LD)}}async _blockStat(){let e=BigInt(0),t=BigInt(0);if(this.blocks)for await(let{key:n,value:i}of this.blocks.query({}))e+=BigInt(1),t+=BigInt(i.byteLength),t+=BigInt(n.bytes.byteLength);return{count:e,size:t}}};async function jb(r){let e=BigInt(0);for await(let t of r.query({}))e+=BigInt(t.value.byteLength),e+=BigInt(t.key.uint8Array().byteLength);return e}function Vb(r,e,t,n){return new Pl(r,e,t,n)}function ND(r){return r.Datastore=Object.assign({},hl,ao(r,"datastore")),r}function PD(r){let e={...hl.Spec,...ao(r,"Datastore.Spec")};return{type:e.type,mounts:e.mounts.map(t=>({mountpoint:t.mountpoint,type:t.child.type,path:t.child.path,shardFunc:t.child.shardFunc}))}}a();a();a();W();ge();var ur="/",Kb=new TextEncoder().encode(ur),tc=Kb[0],ye=class{constructor(e,t){if(typeof e=="string")this._buf=N(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==tc)throw new Error("Invalid key")}toString(e="utf8"){return A(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new ye(e.join(ur))}static random(){return new ye(nt().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new ye(e):typeof e.uint8Array=="function"?new ye(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=Kb),this._buf[0]!==tc){let e=new Uint8Array(this._buf.byteLength+1);e.fill(tc,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===tc;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),n=e.list();for(let i=0;i<t.length;i++){if(n.length<i+1)return!1;let o=t[i],s=n[i];if(o<s)return!0;if(o>s)return!1}return t.length<n.length}reverse(){return ye.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(ur).slice(1)}type(){return FD(this.baseNamespace())}name(){return UD(this.baseNamespace())}instance(e){return new ye(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(ur)||(e+=ur),e+=this.type(),new ye(e)}parent(){let e=this.list();return e.length===1?new ye(ur):new ye(e.slice(0,-1).join(ur))}child(e){return this.toString()===ur?e:e.toString()===ur?this:new ye(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return ye.withNamespaces([...this.namespaces(),...$D(e.map(t=>t.namespaces()))])}};function FD(r){let e=r.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function UD(r){let e=r.split(":");return e[e.length-1]}function $D(r){return[].concat(...r)}a();a();a();W();ge();var fr="/",Wb=new TextEncoder().encode(fr),rc=Wb[0],oe=class{constructor(e,t){if(typeof e=="string")this._buf=N(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==rc)throw new Error("Invalid key")}toString(e="utf8"){return A(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new oe(e.join(fr))}static random(){return new oe(nt().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new oe(e):typeof e.uint8Array=="function"?new oe(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=Wb),this._buf[0]!==rc){let e=new Uint8Array(this._buf.byteLength+1);e.fill(rc,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===rc;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),n=e.list();for(let i=0;i<t.length;i++){if(n.length<i+1)return!1;let o=t[i],s=n[i];if(o<s)return!0;if(o>s)return!1}return t.length<n.length}reverse(){return oe.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(fr).slice(1)}type(){return MD(this.baseNamespace())}name(){return jD(this.baseNamespace())}instance(e){return new oe(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(fr)||(e+=fr),e+=this.type(),new oe(e)}parent(){let e=this.list();return e.length===1?new oe(fr):new oe(e.slice(0,-1).join(fr))}child(e){return this.toString()===fr?e:e.toString()===fr?this:new oe(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return oe.withNamespaces([...this.namespaces(),...zD(e.map(t=>t.namespaces()))])}};function MD(r){let e=r.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function jD(r){let e=r.split(":");return e[e.length-1]}function zD(r){return[].concat(...r)}a();var Hb="SHARDING",Gb="_README";a();a();var Qb=x(Zo(),1),nc=(r,e)=>async function*(){yield*(await(0,Qb.default)(r)).sort(e)}();var Fl=x(Bn(),1),Nn=x(On(),1),Ul=x(es(),1),qt=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,n){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(let{key:n,value:i}of e)await this.put(n,i,t),yield{key:n,value:i}}async*getMany(e,t={}){for await(let n of e)yield this.get(n,t)}async*deleteMany(e,t={}){for await(let n of e)await this.delete(n,t),yield n}batch(){let e=[],t=[];return{put(n,i){e.push({key:n,value:i})},delete(n){t.push(n)},commit:async n=>{await(0,Fl.default)(this.putMany(e,n)),e=[],await(0,Fl.default)(this.deleteMany(t,n)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let n=this._all(e,t);if(e.prefix!=null&&(n=(0,Nn.default)(n,i=>i.key.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(n=e.filters.reduce((i,o)=>(0,Nn.default)(i,o),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((i,o)=>nc(i,o),n)),e.offset!=null){let i=0;n=(0,Nn.default)(n,()=>i++>=e.offset)}return e.limit!=null&&(n=(0,Ul.default)(n,e.limit)),n}queryKeys(e,t){let n=this._allKeys(e,t);if(e.prefix!=null&&(n=(0,Nn.default)(n,i=>i.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(n=e.filters.reduce((i,o)=>(0,Nn.default)(i,o),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((i,o)=>nc(i,o),n)),e.offset!=null){let i=0;n=(0,Nn.default)(n,()=>i++>=e.offset)}return e.limit!=null&&(n=(0,Ul.default)(n,e.limit)),n}};a();a();var HD=x(Ri(),1);a();a();var PN=new oe(Hb),FN=new oe(Gb);a();var GD=x(On(),1),JD=x(es(),1),QD=x(Za(),1);a();a();var Vt=x(tt(),1);ke();Ce();po();Vt.default.formatters.b=r=>r==null?"undefined":z.baseEncode(r);Vt.default.formatters.t=r=>r==null?"undefined":k.baseEncode(r);Vt.default.formatters.m=r=>r==null?"undefined":ho.baseEncode(r);Vt.default.formatters.p=r=>r==null?"undefined":r.toString();Vt.default.formatters.c=r=>r==null?"undefined":r.toString();Vt.default.formatters.k=r=>r==null?"undefined":r.toString();function Zb(r){return Object.assign((0,Vt.default)(r),{error:(0,Vt.default)(`${r}:error`),trace:(0,Vt.default)(`${r}:trace`)})}a();a();var YD=x(Bn(),1),oP=Zb("datastore:core:tiered");a();var xs=x(On(),1),mE=x(Ri(),1),Oh=x(es(),1),Bh=x(t0(),1),gE=x(yE(),1),Zr=class extends qt{constructor(e,t={}){super(),this.db=typeof e=="string"?new gE.Level(e,{...t,keyEncoding:"utf8",valueEncoding:"view"}):e,this.opts={createIfMissing:!0,compression:!1,...t}}async open(){try{await this.db.open(this.opts)}catch(e){throw ct.dbOpenFailedError(e)}}async put(e,t){try{await this.db.put(e.toString(),t)}catch(n){throw ct.dbWriteFailedError(n)}}async get(e){let t;try{t=await this.db.get(e.toString())}catch(n){throw n.notFound?ct.notFoundError(n):ct.dbWriteFailedError(n)}return t}async has(e){try{await this.db.get(e.toString())}catch(t){if(t.notFound)return!1;throw t}return!0}async delete(e){try{await this.db.del(e.toString())}catch(t){throw ct.dbDeleteFailedError(t)}}close(){return this.db&&this.db.close()}batch(){let e=[];return{put:(t,n)=>{e.push({type:"put",key:t.toString(),value:n})},delete:t=>{e.push({type:"del",key:t.toString()})},commit:()=>this.db.batch(e)}}query(e){let t=this._query({values:!0,prefix:e.prefix});Array.isArray(e.filters)&&(t=e.filters.reduce((o,s)=>(0,xs.default)(o,s),t)),Array.isArray(e.orders)&&(t=e.orders.reduce((o,s)=>(0,Bh.default)(o,s),t));let{offset:n,limit:i}=e;if(n){let o=0;t=(0,xs.default)(t,()=>o++>=n)}return i&&(t=(0,Oh.default)(t,i)),t}queryKeys(e){let t=(0,mE.default)(this._query({values:!1,prefix:e.prefix}),({key:o})=>o);Array.isArray(e.filters)&&(t=e.filters.reduce((o,s)=>(0,xs.default)(o,s),t)),Array.isArray(e.orders)&&(t=e.orders.reduce((o,s)=>(0,Bh.default)(o,s),t));let{offset:n,limit:i}=e;if(n){let o=0;t=(0,xs.default)(t,()=>o++>=n)}return i&&(t=(0,Oh.default)(t,i)),t}_query(e){let t={keys:!0,keyEncoding:"buffer",values:e.values};if(e.prefix!=null){let i=e.prefix.toString();t.gte=i,t.lt=i+"\xFF"}let n=this.db.iterator(t);if(n[Symbol.asyncIterator])return o3(n);if(n.next!=null&&n.end!=null)return s3(n);throw new Error("Level returned incompatible iterator")}};async function*o3(r){for await(let[e,t]of r)yield{key:new ye(e,!1),value:t};await r.close()}function s3(r){return{[Symbol.asyncIterator](){return{next:()=>new Promise((e,t)=>{r.next((n,i,o)=>{if(n)return t(n);if(i==null)return r.end(s=>{if(s)return t(s);e({done:!0,value:void 0})});e({done:!1,value:{key:new ye(i,!1),value:o}})})}),return:()=>new Promise((e,t)=>{r.end(n=>{if(n)return t(n);e({done:!0,value:void 0})})})}}}}a();var Nh=x(Bn(),1);a();a();var Bc=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},Gi=class{constructor(e={}){this.hwm=e.splitLimit??16,this.head=new Bc(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return e?.byteLength!=null?e.byteLength:1}push(e){if(e?.value!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){let t=this.head;this.head=t.next=new Bc(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return e?.value!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}};function kh(r={}){return a3(t=>{let n=t.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},r)}function a3(r,e){e=e??{};let t=e.onEnd,n=new Gi,i,o,s,c=async()=>n.isEmpty()?s?{done:!0}:await new Promise((m,I)=>{o=U=>{o=null,n.push(U);try{m(r(n))}catch(ee){I(ee)}return i}}):r(n),u=m=>o!=null?o(m):(n.push(m),i),f=m=>(n=new Gi,o!=null?o({error:m}):(n.push({error:m}),i)),l=m=>{if(s)return i;if(e?.objectMode!==!0&&m?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return u({done:!1,value:m})},h=m=>s?i:(s=!0,m!=null?f(m):u({done:!0})),d=()=>(n=new Gi,h(),{done:!0}),w=m=>(h(m),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:c,return:d,throw:w,push:l,end:h,get readableLength(){return n.size}},t==null)return i;let g=i;return i={[Symbol.asyncIterator](){return this},next(){return g.next()},throw(m){return g.throw(m),t!=null&&(t(m),t=void 0),{done:!0}},return(){return g.return(),t!=null&&(t(),t=void 0),{done:!0}},push:l,end(m){return g.end(m),t!=null&&(t(m),t=void 0),i},get readableLength(){return g.readableLength}},i}a();W();ge();var wr="/",wE=new TextEncoder().encode(wr),kc=wE[0],ve=class{constructor(e,t){if(typeof e=="string")this._buf=N(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==kc)throw new Error("Invalid key")}toString(e="utf8"){return A(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new ve(e.join(wr))}static random(){return new ve(nt().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new ve(e):typeof e.uint8Array=="function"?new ve(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=wE),this._buf[0]!==kc){let e=new Uint8Array(this._buf.byteLength+1);e.fill(kc,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===kc;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),n=e.list();for(let i=0;i<t.length;i++){if(n.length<i+1)return!1;let o=t[i],s=n[i];if(o<s)return!0;if(o>s)return!1}return t.length<n.length}reverse(){return ve.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(wr).slice(1)}type(){return c3(this.baseNamespace())}name(){return u3(this.baseNamespace())}instance(e){return new ve(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(wr)||(e+=wr),e+=this.type(),new ve(e)}parent(){let e=this.list();return e.length===1?new ve(wr):new ve(e.slice(0,-1).join(wr))}child(e){return this.toString()===wr?e:e.toString()===wr?this:new ve(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return ve.withNamespaces([...this.namespaces(),...f3(e.map(t=>t.namespaces()))])}};function c3(r){let e=r.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function u3(r){let e=r.split(":");return e[e.length-1]}function f3(r){return[].concat(...r)}V();Ar();Te();Ce();ke();var xE=x(Se(),1);a();var Lh=x(Bn(),1),Qn=x(On(),1),Rh=x(es(),1),EE=x(Zo(),1),bE=(r,e)=>async function*(){yield*(await(0,EE.default)(r)).sort(e)}(),Lc=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,n){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(let{key:n,value:i}of e)await this.put(n,i,t),yield{key:n,value:i}}async*getMany(e,t={}){for await(let n of e)yield this.get(n,t)}async*deleteMany(e,t={}){for await(let n of e)await this.delete(n,t),yield n}batch(){let e=[],t=[];return{put(n,i){e.push({key:n,value:i})},delete(n){t.push(n)},commit:async n=>{await(0,Lh.default)(this.putMany(e,n)),e=[],await(0,Lh.default)(this.deleteMany(t,n)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let n=this._all(e,t);if(e.prefix!=null&&(n=(0,Qn.default)(n,i=>i.key.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(n=e.filters.reduce((i,o)=>(0,Qn.default)(i,o),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((i,o)=>bE(i,o),n)),e.offset!=null){let i=0;n=(0,Qn.default)(n,()=>i++>=(e.offset||0))}return e.limit!=null&&(n=(0,Rh.default)(n,e.limit)),n}queryKeys(e,t){let n=this._allKeys(e,t);if(e.prefix!=null&&(n=(0,Qn.default)(n,i=>i.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(n=e.filters.reduce((i,o)=>(0,Qn.default)(i,o),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((i,o)=>bE(i,o),n)),e.offset!=null){let i=0;n=(0,Qn.default)(n,()=>i++>=e.offset)}return e.limit!=null&&(n=(0,Rh.default)(n,e.limit)),n}};function Ji(r){let e=E.asCID(r);if(!e)throw(0,xE.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");return new ve("/"+k.encode(e.multihash.bytes).slice(1).toUpperCase(),!1)}function en(r){return E.createV1(er,re(k.decode("b"+r.toString().slice(1).toLowerCase())))}function Ph(r){let e=r.substring(0,1);if(e==="/")return Ph(r.substring(1));let t;e.toLowerCase()==="b"?t=o=>k.decode(o.toLowerCase()).subarray(2):e.toLowerCase()==="c"?t=o=>Iu.decode(o.toLowerCase()).subarray(2):e==="z"?t=o=>z.decode(o).subarray(2):e==="Q"?t=o=>z.decode("z"+o):t=o=>k.decode("b"+o.toLowerCase()).subarray(2);let n;for(let o=1;o<r.length;o++)try{n=t(r.substring(0,o))}catch(s){if(s.message!=="Unexpected end of data")throw s}let i="/C";return n&&(i=`/${k.encode(n).slice(1,-1).toUpperCase()||"C"}`),i}function l3(r){return{...r,prefix:r.prefix?Ph(r.prefix):void 0,filters:r.filters?r.filters.map(e=>t=>e({key:en(t.key),value:t.value})):void 0,orders:r.orders?r.orders.map(e=>(t,n)=>e({key:en(t.key),value:t.value},{key:en(n.key),value:n.value})):void 0}}function h3(r){return{...r,prefix:r.prefix?Ph(r.prefix):void 0,filters:r.filters?r.filters.map(e=>t=>e(en(t))):void 0,orders:r.orders?r.orders.map(e=>(t,n)=>e(en(t),en(n))):void 0}}var Rc=class extends Lc{constructor(e){super(),this.child=e}open(){return this.child.open()}close(){return this.child.close()}async*query(e,t){for await(let{key:n,value:i}of this.child.query(l3(e),t))yield{key:en(n),value:i}}async*queryKeys(e,t){for await(let n of this.child.queryKeys(h3(e),t))yield en(n)}async get(e,t){return this.child.get(Ji(e),t)}async*getMany(e,t){for await(let n of e)yield this.get(n,t)}async put(e,t,n){await this.child.put(Ji(e),t,n)}async*putMany(e,t){let n=kh({objectMode:!0});(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)(async()=>{try{let o=this.child;await(0,Nh.default)(this.child.putMany(async function*(){for await(let s of e){let c=Ji(s.key);await o.has(c,t)||(yield{key:c,value:s.value}),n.push(s)}}())),n.end()}catch(o){n.end(o)}}),yield*n}has(e,t){return this.child.has(Ji(e),t)}delete(e,t){return this.child.delete(Ji(e),t)}deleteMany(e,t){let n=kh({objectMode:!0});return(0,Nh.default)(this.child.deleteMany(async function*(){for await(let i of e)yield Ji(i),n.push(i);n.end()}(),t)).catch(i=>{n.end(i)}),n}};function vE(r,e,t){let n=t.path||"ipfs";return Vb(n,i=>e.getCodec(i),{root:new Zr(n,{prefix:"",version:2}),blocks:new Rc(new Zr(`${n}/blocks`,{prefix:"",version:2})),datastore:new Zr(`${n}/datastore`,{prefix:"",version:2}),keys:new Zr(`${n}/keys`,{prefix:"",version:2}),pins:new Zr(`${n}/pins`,{prefix:"",version:2})},{autoMigrate:t.autoMigrate,onMigrationProgress:t.onMigrationProgress||r,repoLock:Ga})}a();a();V();a();V();a();var Fh=x(Re(),1);var tn={};H(tn,{code:()=>b3,decode:()=>vs,encode:()=>Yn,name:()=>w3});a();V();var _E=42;function d3(r){if(r.asCID!==r)return null;let e=E.asCID(r);if(!e)return null;let t=new Uint8Array(e.bytes.byteLength+1);return t.set(e.bytes,1),[new v(p.tag,_E),new v(p.bytes,t)]}function p3(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function y3(r){if(Number.isNaN(r))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(r===1/0||r===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}var m3={float64:!0,typeEncoders:{Object:d3,undefined:p3,number:y3}};function g3(r){if(r[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return E.decode(r.subarray(1))}var DE={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};DE.tags[_E]=g3;var w3="dag-cbor",b3=113,Yn=r=>nr(r,m3),vs=r=>st(r,DE);function Uh(r){let e=Yn({version:1,roots:r}),t=Fh.default.encode(e.length),n=new Uint8Array(t.length+e.length);return n.set(t,0),n.set(e,t.length),n}function SE(r){return{async setRoots(e){let t=Uh(e);await r.write(t)},async writeBlock(e){let{cid:t,bytes:n}=e;await r.write(new Uint8Array(Fh.default.encode(t.bytes.length+n.length))),await r.write(t.bytes),n.length&&await r.write(n)},async close(){await r.end()}}}a();function Nc(){}function AE(){let r=[],e=null,t=Nc,n=!1,i=null,o=Nc,s=()=>(e||(e=new Promise(f=>{t=()=>{e=null,t=Nc,f()}})),e),c={write(f){r.push(f);let l=s();return o(),l},async end(){n=!0;let f=s();o(),await f}},u={async next(){let f=r.shift();return f?(r.length===0&&t(),{done:!1,value:f}):n?(t(),{done:!0,value:void 0}):(i||(i=new Promise(l=>{o=()=>(i=null,o=Nc,l(u.next()))})),i)}};return{writer:c,iterator:u}}a();var nn=x(Re(),1);V();Te();a();var rn={Null:r=>r===null,Int:r=>Number.isInteger(r),Float:r=>typeof r=="number"&&Number.isFinite(r),String:r=>typeof r=="string",Bool:r=>typeof r=="boolean",Bytes:r=>r instanceof Uint8Array,Link:r=>!rn.Null(r)&&typeof r=="object"&&r.asCID===r,List:r=>Array.isArray(r),Map:r=>!rn.Null(r)&&typeof r=="object"&&r.asCID!==r&&!rn.List(r)&&!rn.Bytes(r)},Qi={Int:rn.Int,"CarHeader > version":r=>Qi.Int(r),"CarHeader > roots (anon) > valueType (anon)":rn.Link,"CarHeader > roots (anon)":r=>rn.List(r)&&Array.prototype.every.call(r,Qi["CarHeader > roots (anon) > valueType (anon)"]),"CarHeader > roots":r=>Qi["CarHeader > roots (anon)"](r),CarHeader:r=>{let e=r&&Object.keys(r);return rn.Map(r)&&["version"].every(t=>e.includes(t))&&Object.entries(r).every(([t,n])=>Qi["CarHeader > "+t]&&Qi["CarHeader > "+t](n))}},TE=Qi.CarHeader;var $h={SHA2_256:18,LENGTH:32,DAG_PB:112},CE=16+8+8+8;async function Pc(r){let e=await r.upTo(8);if(!e.length)throw new Error("Unexpected end of data");let t=nn.default.decode(e);return r.seek(nn.default.decode.bytes),t}async function E3(r){let e=await r.exactly(CE),t=new DataView(e.buffer,e.byteOffset,e.byteLength),n=0,i={version:2,characteristics:[t.getBigUint64(n,!0),t.getBigUint64(n+=8,!0)],dataOffset:Number(t.getBigUint64(n+=8,!0)),dataSize:Number(t.getBigUint64(n+=8,!0)),indexOffset:Number(t.getBigUint64(n+=8,!0))};return r.seek(CE),i}async function Fc(r,e){let t=await Pc(r);if(t===0)throw new Error("Invalid CAR header (zero length)");let n=await r.exactly(t);r.seek(t);let i=vs(n);if(!TE(i))throw new Error("Invalid CAR header format");if(i.version!==1&&i.version!==2||e!==void 0&&i.version!==e)throw new Error(`Invalid CAR version: ${i.version}${e!==void 0?` (expected ${e})`:""}`);let o=Array.isArray(i.roots);if(i.version===1&&!o||i.version===2&&o)throw new Error("Invalid CAR header format");if(i.version===1)return i;let s=await E3(r);r.seek(s.dataOffset-r.pos);let c=await Fc(r,1);return Object.assign(c,s)}async function x3(r){let e=await r.upTo(8);nn.default.decode(e);let t=nn.default.decode.bytes,n=nn.default.decode(e.subarray(nn.default.decode.bytes)),i=nn.default.decode.bytes,o=t+i+n,s=await r.exactly(o);return r.seek(o),s}async function v3(r){let e=await r.exactly(2);if(e[0]===$h.SHA2_256&&e[1]===$h.LENGTH){let s=await r.exactly(34);r.seek(34);let c=re(s);return E.create(0,$h.DAG_PB,c)}let t=await Pc(r);if(t!==1)throw new Error(`Unexpected CID version (${t})`);let n=await Pc(r),i=await x3(r),o=re(i);return E.create(t,n,o)}async function IE(r){let e=r.pos,t=await Pc(r);if(t===0)throw new Error("Invalid CAR section (zero length)");t+=r.pos-e;let n=await v3(r),i=t-Number(r.pos-e);return{cid:n,length:t,blockLength:i}}async function _3(r){let{cid:e,blockLength:t}=await IE(r),n=await r.exactly(t);return r.seek(t),{bytes:n,cid:e}}async function D3(r){let e=r.pos,{cid:t,length:n,blockLength:i}=await IE(r),o={cid:t,length:n,blockLength:i,offset:e,blockOffset:r.pos};return r.seek(o.blockLength),o}function Yi(r){let e=(async()=>{let t=await Fc(r);if(t.version===2){let n=r.pos-t.dataOffset;r=A3(r,t.dataSize-n)}return t})();return{header:()=>e,async*blocks(){for(await e;(await r.upTo(8)).length>0;)yield await _3(r)},async*blocksIndex(){for(await e;(await r.upTo(8)).length>0;)yield await D3(r)}}}function on(r){let e=0;return{async upTo(t){return r.subarray(e,e+Math.min(t,r.length-e))},async exactly(t){if(t>r.length-e)throw new Error("Unexpected end of data");return r.subarray(e,e+t)},seek(t){e+=t},get pos(){return e}}}function S3(r){let e=0,t=0,n=0,i=new Uint8Array(0),o=async s=>{t=i.length-n;let c=[i.subarray(n)];for(;t<s;){let f=await r();if(f==null)break;t<0?f.length>t&&c.push(f.subarray(-t)):c.push(f),t+=f.length}i=new Uint8Array(c.reduce((f,l)=>f+l.length,0));let u=0;for(let f of c)i.set(f,u),u+=f.length;n=0};return{async upTo(s){return i.length-n<s&&await o(s),i.subarray(n,n+Math.min(i.length-n,s))},async exactly(s){if(i.length-n<s&&await o(s),i.length-n<s)throw new Error("Unexpected end of data");return i.subarray(n,n+s)},seek(s){e+=s,n+=s},get pos(){return e}}}function Xi(r){let e=r[Symbol.asyncIterator]();async function t(){let n=await e.next();return n.done?null:n.value}return S3(t)}function A3(r,e){let t=0;return{async upTo(n){let i=await r.upTo(n);return i.length+t>e&&(i=i.subarray(0,e-t)),i},async exactly(n){let i=await r.exactly(n);if(i.length+t>e)throw new Error("Unexpected end of data");return i},seek(n){t+=n,r.seek(n)},get pos(){return r.pos}}}var sn=class{constructor(e,t){this._encoder=t,this._mutex=t.setRoots(e),this._ended=!1}async put(e){if(!(e.bytes instanceof Uint8Array)||!e.cid)throw new TypeError("Can only write {cid, bytes} objects");if(this._ended)throw new Error("Already closed");let t=E.asCID(e.cid);if(!t)throw new TypeError("Can only write {cid, bytes} objects");return this._mutex=this._mutex.then(()=>this._encoder.writeBlock({cid:t,bytes:e.bytes})),this._mutex}async close(){if(this._ended)throw new Error("Already closed");return await this._mutex,this._ended=!0,this._encoder.close()}static create(e){e=T3(e);let{encoder:t,iterator:n}=OE(),i=new sn(e,t),o=new Uc(n);return{writer:i,out:o}}static createAppender(){let{encoder:e,iterator:t}=OE();e.setRoots=()=>Promise.resolve();let n=new sn([],e),i=new Uc(t);return{writer:n,out:i}}static async updateRootsInBytes(e,t){let n=on(e);await Fc(n);let i=Uh(t);if(Number(n.pos)!==i.length)throw new Error(`updateRoots() can only overwrite a header of the same length (old header is ${n.pos} bytes, new header is ${i.length} bytes)`);return e.set(i,0),e}},Uc=class{constructor(e){this._iterator=e}[Symbol.asyncIterator](){if(this._iterating)throw new Error("Multiple iterator not supported");return this._iterating=!0,this._iterator}};function OE(){let r=AE(),{writer:e,iterator:t}=r;return{encoder:SE(e),iterator:t}}function T3(r){if(r===void 0)return[];if(!Array.isArray(r)){let t=E.asCID(r);if(!t)throw new TypeError("roots must be a single CID or an array of CIDs");return[t]}let e=[];for(let t of r){let n=E.asCID(t);if(!n)throw new TypeError("roots must be a single CID or an array of CIDs");e.push(n)}return e}a();var zE=x(FE(),1),qE=x($E(),1);a();var O3=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/uig;L.nanosecond=L.ns=1/1e6;L.\u00B5s=L.\u03BCs=L.us=L.microsecond=1/1e3;L.millisecond=L.ms=L[""]=1;L.second=L.sec=L.s=L.ms*1e3;L.minute=L.min=L.m=L.s*60;L.hour=L.hr=L.h=L.m*60;L.day=L.d=L.h*24;L.week=L.wk=L.w=L.d*7;L.month=L.b=L.d*(365.25/12);L.year=L.yr=L.y=L.d*365.25;function L(r="",e="ms"){var t=null;return r=(r+"").replace(/(\d)[,_](\d)/g,"$1$2"),r.replace(O3,function(n,i,o){o=ME(o),o&&(t=(t||0)+parseFloat(i,10)*o)}),t&&t/(ME(e)||1)}function ME(r){return L[r]||L[r.toLowerCase().replace(/s$/,"")]}var jE=L;a();var br=class extends Error{constructor(e="request timed out"){super(e),this.name="TimeoutError",this.code=br.code}};br.code="ERR_TIMEOUT";function dt(r,e){return(...t)=>{let n=t[e??t.length-1];if(!n||!n.timeout)return r(...t);let i=typeof n.timeout=="string"?jE(n.timeout):n.timeout,o=new zE.TimeoutController(i);n.signal=(0,qE.anySignal)([n.signal,o.signal]);let s=r(...t),c=new Promise((l,h)=>{o.signal.addEventListener("abort",()=>{h(new br)})}),u=Date.now(),f=()=>{if(o.signal.aborted)throw new br;if(Date.now()-u>i)throw o.abort(),new br};return s[Symbol.asyncIterator]?async function*(){let l=s[Symbol.asyncIterator]();try{for(;;){let{value:h,done:d}=await Promise.race([l.next(),c]);if(d)break;f(),yield h}}catch(h){throw f(),h}finally{o.clear(),l.return&&l.return()}}():(async()=>{try{let l=await Promise.race([s,c]);return f(),l}catch(l){throw f(),l}finally{o.clear()}})()}}a();var Gt=x(tt(),1);ke();Ce();po();Gt.default.formatters.b=r=>r==null?"undefined":z.baseEncode(r);Gt.default.formatters.t=r=>r==null?"undefined":k.baseEncode(r);Gt.default.formatters.m=r=>r==null?"undefined":ho.baseEncode(r);Gt.default.formatters.p=r=>r==null?"undefined":r.toString();Gt.default.formatters.c=r=>r==null?"undefined":r.toString();Gt.default.formatters.k=r=>r==null?"undefined":r.toString();function Mc(r){return Object.assign((0,Gt.default)(r),{error:(0,Gt.default)(`${r}:error`),trace:(0,Gt.default)(`${r}:trace`)})}Ar();Ku();a();ke();var zh=async({cid:r,load:e,seen:t})=>{t=t||new Set;let n=r.toString(z);if(t.has(n))return;let i=await e(r);if(t.add(n),i!==null)for(let[,o]of i.links())await zh({cid:o,load:e,seen:t})};var VE=Mc("ipfs:components:dag:import"),B3=[er,Vu];function KE({repo:r,preload:e,codecs:t}){async function*n(i,o={}){o.preload!==!1&&e(i);let s=E.asCID(i);if(!s)throw new Error(`Unexpected error converting CID type: ${i}`);VE(`Exporting ${s} as car`);let{writer:c,out:u}=await sn.create([s]),f=null;(async()=>{try{let l=k3(r,c,{signal:o.signal,timeout:o.timeout},t);await zh({cid:s,load:l})}catch(l){f=l}finally{c.close()}})();for await(let l of u){if(f)break;yield l}if(f)throw f}return dt(n)}function k3(r,e,t,n){return async i=>{let o=await n.getCodec(i.code);if(!o)throw new Error(`Can't decode links in block with codec 0x${i.code.toString(16)} to form complete DAG`);let s=await r.blocks.get(i,t);return VE(`Adding block ${i} to car`),await e.put({cid:i,bytes:s}),B3.includes(i.code)?null:kn({bytes:s,cid:i,codec:o})}}a();var Mx=x(dl(),1),jx=x(HE(),1);a();a();ke();Ce();Te();a();a();a();a();a();a();var GE="[a-fA-F\\d:]",an=r=>r&&r.includeBoundaries?`(?:(?<=\\s|^)(?=${GE})|(?<=${GE})(?=\\s|$))`:"",Bt="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",ce="[a-fA-F\\d]{1,4}",jc=`
(?:
(?:${ce}:){7}(?:${ce}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${ce}:){6}(?:${Bt}|:${ce}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${ce}:){5}(?::${Bt}|(?::${ce}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${ce}:){4}(?:(?::${ce}){0,1}:${Bt}|(?::${ce}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${ce}:){3}(?:(?::${ce}){0,2}:${Bt}|(?::${ce}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${ce}:){2}(?:(?::${ce}){0,3}:${Bt}|(?::${ce}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${ce}:){1}(?:(?::${ce}){0,4}:${Bt}|(?::${ce}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${ce}){0,5}:${Bt}|(?::${ce}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),R3=new RegExp(`(?:^${Bt}$)|(?:^${jc}$)`),N3=new RegExp(`^${Bt}$`),P3=new RegExp(`^${jc}$`),qh=r=>r&&r.exact?R3:new RegExp(`(?:${an(r)}${Bt}${an(r)})|(?:${an(r)}${jc}${an(r)})`,"g");qh.v4=r=>r&&r.exact?N3:new RegExp(`${an(r)}${Bt}${an(r)}`,"g");qh.v6=r=>r&&r.exact?P3:new RegExp(`${an(r)}${jc}${an(r)}`,"g");var zc=qh;a();a();function Vh(r){let e=(...t)=>r(...t);return Object.defineProperty(e,"name",{value:`functionTimeout(${r.name||"<anonymous>"})`,configurable:!0}),e}function JE(){return!1}a();a();a();var{toString:F3}=Object.prototype;function Kh(r){return F3.call(r)==="[object RegExp]"}var QE={global:"g",ignoreCase:"i",multiline:"m",dotAll:"s",sticky:"y",unicode:"u"};function Wh(r,e={}){if(!Kh(r))throw new TypeError("Expected a RegExp instance");let t=Object.keys(QE).map(i=>(typeof e[i]=="boolean"?e[i]:r[i])?QE[i]:"").join(""),n=new RegExp(e.source||r.source,t);return n.lastIndex=typeof e.lastIndex=="number"?e.lastIndex:r.lastIndex,n}function qc(r,e,{timeout:t}={}){try{return Vh(()=>Wh(r).test(e),{timeout:t})()}catch(n){if(JE(n))return!1;throw n}}var U3=15,YE=45,Hh={timeout:400};function cn(r){return qc(zc({exact:!0}),r.slice(0,YE),Hh)}function Vc(r){return qc(zc.v6({exact:!0}),r.slice(0,YE),Hh)}function Kc(r){return qc(zc.v4({exact:!0}),r.slice(0,U3),Hh)}W();var XE=Kc,$3=Vc,Gh=function(r){let e=0;if(r=r.toString().trim(),XE(r)){let t=new Uint8Array(e+4);return r.split(/\./g).forEach(n=>{t[e++]=parseInt(n,10)&255}),t}if($3(r)){let t=r.split(":",8),n;for(n=0;n<t.length;n++){let o=XE(t[n]),s;o&&(s=Gh(t[n]),t[n]=A(s.slice(0,2),"base16")),s!=null&&++n<8&&t.splice(n,0,A(s.slice(2,4),"base16"))}if(t[0]==="")for(;t.length<8;)t.unshift("0");else if(t[t.length-1]==="")for(;t.length<8;)t.push("0");else if(t.length<8){for(n=0;n<t.length&&t[n]!=="";n++);let o=[n,1];for(n=9-t.length;n>0;n--)o.push("0");t.splice.apply(t,o)}let i=new Uint8Array(e+16);for(n=0;n<t.length;n++){let o=parseInt(t[n],16);i[e++]=o>>8&255,i[e++]=o&255}return i}throw new Error("invalid ip address")},ZE=function(r,e=0,t){e=~~e,t=t??r.length-e;let n=new DataView(r.buffer);if(t===4){let i=[];for(let o=0;o<t;o++)i.push(r[e+o]);return i.join(".")}if(t===16){let i=[];for(let o=0;o<t;o+=2)i.push(n.getUint16(e+o).toString(16));return i.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};a();var Ds={},Jh={},j3=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[460,0,"quic"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];j3.forEach(r=>{let e=z3(...r);Jh[e.code]=e,Ds[e.name]=e});function z3(r,e,t,n,i){return{code:r,size:e,name:t,resolvable:Boolean(n),path:Boolean(i)}}function ue(r){if(typeof r=="number"){if(Jh[r]!=null)return Jh[r];throw new Error(`no protocol with code: ${r}`)}else if(typeof r=="string"){if(Ds[r]!=null)return Ds[r];throw new Error(`no protocol with name: ${r}`)}throw new Error(`invalid protocol id type: ${typeof r}`)}V();Ce();ke();yo();Te();var Jt=x(Re(),1);W();ge();Lr();function rx(r,e){switch(ue(r).code){case 4:case 41:return V3(e);case 6:case 273:case 33:case 132:return ix(e).toString();case 53:case 54:case 55:case 56:case 400:case 777:return W3(e);case 421:return Q3(e);case 444:return tx(e);case 445:return tx(e);case 466:return J3(e);default:return A(e,"base16")}}function nx(r,e){switch(ue(r).code){case 4:return ex(e);case 41:return ex(e);case 6:case 273:case 33:case 132:return Yh(parseInt(e,10));case 53:case 54:case 55:case 56:case 400:case 777:return K3(e);case 421:return H3(e);case 444:return Y3(e);case 445:return X3(e);case 466:return G3(e);default:return N(e,"base16")}}var Qh=Object.values(wn).map(r=>r.decoder),q3=function(){let r=Qh[0].or(Qh[1]);return Qh.slice(2).forEach(e=>r=r.or(e)),r}();function ex(r){if(!cn(r))throw new Error("invalid ip address");return Gh(r)}function V3(r){let e=ZE(r,0,r.length);if(e==null)throw new Error("ipBuff is required");if(!cn(e))throw new Error("invalid ip address");return e}function Yh(r){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,r),new Uint8Array(e)}function ix(r){return new DataView(r.buffer).getUint16(r.byteOffset)}function K3(r){let e=N(r),t=Uint8Array.from(Jt.default.encode(e.length));return Q([t,e],t.length+e.length)}function W3(r){let e=Jt.default.decode(r);if(r=r.slice(Jt.default.decode.bytes),r.length!==e)throw new Error("inconsistent lengths");return A(r)}function H3(r){let e;r[0]==="Q"||r[0]==="1"?e=re(z.decode(`z${r}`)).bytes:e=E.parse(r).multihash.bytes;let t=Uint8Array.from(Jt.default.encode(e.length));return Q([t,e],t.length+e.length)}function G3(r){let e=q3.decode(r),t=Uint8Array.from(Jt.default.encode(e.length));return Q([t,e],t.length+e.length)}function J3(r){let e=Jt.default.decode(r),t=r.slice(Jt.default.decode.bytes);if(t.length!==e)throw new Error("inconsistent lengths");return"u"+A(t,"base64url")}function Q3(r){let e=Jt.default.decode(r),t=r.slice(Jt.default.decode.bytes);if(t.length!==e)throw new Error("inconsistent lengths");return A(t,"base58btc")}function Y3(r){let e=r.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==16)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);let t=k.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=Yh(n);return Q([t,i],t.length+i.length)}function X3(r){let e=r.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==56)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);let t=k.decode(`b${e[0]}`),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=Yh(n);return Q([t,i],t.length+i.length)}function tx(r){let e=r.slice(0,r.length-2),t=r.slice(r.length-2),n=A(e,"base32"),i=ix(t);return`${n}:${i}`}var Zi=x(Re(),1);Lr();W();function Z3(r){let e=[],t=r.split("/").slice(1);if(t.length===1&&t[0]==="")return[];for(let n=0;n<t.length;n++){let i=t[n],o=ue(i);if(o.size===0){e.push([i]);continue}if(n++,n>=t.length)throw sx("invalid address: "+r);if(o.path===!0){e.push([i,rd(t.slice(n).join("/"))]);break}e.push([i,t[n]])}return e}function eA(r){let e=[];return r.map(t=>{let n=Gc(t);return e.push(n.name),t.length>1&&t[1]!=null&&e.push(t[1]),null}),rd(e.join("/"))}function tA(r){return r.map(e=>{Array.isArray(e)||(e=[e]);let t=Gc(e);return e.length>1?[t.code,nx(t.code,e[1])]:[t.code]})}function Xh(r){return r.map(e=>{let t=Gc(e);return e[1]!=null?[t.code,rx(t.code,e[1])]:[t.code]})}function Zh(r){return Hc(Q(r.map(e=>{let t=Gc(e),n=Uint8Array.from(Zi.default.encode(t.code));return e.length>1&&e[1]!=null&&(n=Q([n,e[1]])),n})))}function ed(r,e){return r.size>0?r.size/8:r.size===0?0:Zi.default.decode(e)+Zi.default.decode.bytes}function Wc(r){let e=[],t=0;for(;t<r.length;){let n=Zi.default.decode(r,t),i=Zi.default.decode.bytes,o=ue(n),s=ed(o,r.slice(t+i));if(s===0){e.push([n]),t+=i;continue}let c=r.slice(t+i,t+i+s);if(t+=s+i,t>r.length)throw sx("Invalid address Uint8Array: "+A(r,"base16"));e.push([n,c])}return e}function td(r){let e=Wc(r),t=Xh(e);return eA(t)}function rA(r){r=rd(r);let e=Z3(r),t=tA(e);return Zh(t)}function ox(r){return rA(r)}function Hc(r){let e=nA(r);if(e!=null)throw e;return Uint8Array.from(r)}function nA(r){try{Wc(r)}catch(e){return e}}function rd(r){return"/"+r.trim().split("/").filter(e=>e).join("/")}function sx(r){return new Error("Error parsing address: "+r)}function Gc(r){return ue(r[0])}var nd=x(Re(),1);V();ke();var ux=x(Se(),1);W();Ia();var ax,oA=Symbol.for("nodejs.util.inspect.custom"),cx=[ue("dns").code,ue("dns4").code,ue("dns6").code,ue("dnsaddr").code],sA=[ue("p2p").code,ue("ipfs").code],aA=new Map,fx=Symbol.for("@multiformats/js-multiaddr/multiaddr");function cA(r){return Boolean(r?.[fx])}var un=class{constructor(e){if(this[ax]=!0,e==null&&(e=""),e instanceof Uint8Array)this.bytes=Hc(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=ox(e)}else if(cA(e))this.bytes=Hc(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return this._string==null&&(this._string=td(this.bytes)),this._string}toJSON(){return this.toString()}toOptions(){let e=this.protoCodes(),t=this.toString().split("/").slice(1),n,i;if(t.length>2)cx.includes(e[0])&&sA.includes(e[1])?(n=ue("tcp").name,i=443):(n=ue(t[2]).name,i=parseInt(t[3]));else if(cx.includes(e[0]))n=ue("tcp").name,i=443;else throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e[0]===41||e[0]===55?6:4,host:t[1],transport:n,port:i}}protos(){return this.protoCodes().map(e=>Object.assign({},ue(e)))}protoCodes(){let e=[],t=this.bytes,n=0;for(;n<t.length;){let i=nd.default.decode(t,n),o=nd.default.decode.bytes,s=ue(i);n+=ed(s,t.slice(n+o))+o,e.push(i)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return this._tuples==null&&(this._tuples=Wc(this.bytes)),this._tuples}stringTuples(){return this._stringTuples==null&&(this._stringTuples=Xh(this.tuples())),this._stringTuples}encapsulate(e){return e=new un(e),new un(this.toString()+e.toString())}decapsulate(e){let t=e.toString(),n=this.toString(),i=n.lastIndexOf(t);if(i<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new un(n.slice(0,i))}decapsulateCode(e){let t=this.tuples();for(let n=t.length-1;n>=0;n--)if(t[n][0]===e)return new un(Zh(t.slice(0,n)));return this}getPeerId(){try{let t=this.stringTuples().filter(n=>n[0]===Ds.ipfs.code).pop();if(t?.[1]!=null){let n=t[1];return n[0]==="Q"||n[0]==="1"?A(z.decode(`z${n}`),"base58btc"):A(E.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let e=null;try{e=this.stringTuples().filter(t=>ue(t[0]).path===!0)[0][1],e==null&&(e=null)}catch{e=null}return e}equals(e){return Fo(this.bytes,e.bytes)}async resolve(e){let t=this.protos().find(o=>o.resolvable);if(t==null)return[this];let n=aA.get(t.name);if(n==null)throw(0,ux.default)(new Error(`no available resolver for ${t.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map(o=>new un(o))}nodeAddress(){let e=this.toOptions();if(e.transport!=="tcp"&&e.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){let t=(e??this).protos();return!(t.length!==2||t[0].code!==4&&t[0].code!==41||t[1].code!==6&&t[1].code!==273)}[(ax=fx,oA)](){return this.inspect()}inspect(){return"<Multiaddr "+A(this.bytes,"base16")+" - "+td(this.bytes)+">"}};a();a();a();a();a();W();var lx=Kc,uA=Vc,id=function(r){let e=0;if(r=r.toString().trim(),lx(r)){let t=new Uint8Array(e+4);return r.split(/\./g).forEach(n=>{t[e++]=parseInt(n,10)&255}),t}if(uA(r)){let t=r.split(":",8),n;for(n=0;n<t.length;n++){let o=lx(t[n]),s;o&&(s=id(t[n]),t[n]=A(s.slice(0,2),"base16")),s!=null&&++n<8&&t.splice(n,0,A(s.slice(2,4),"base16"))}if(t[0]==="")for(;t.length<8;)t.unshift("0");else if(t[t.length-1]==="")for(;t.length<8;)t.push("0");else if(t.length<8){for(n=0;n<t.length&&t[n]!=="";n++);let o=[n,1];for(n=9-t.length;n>0;n--)o.push("0");t.splice.apply(t,o)}let i=new Uint8Array(e+16);for(n=0;n<t.length;n++){let o=parseInt(t[n],16);i[e++]=o>>8&255,i[e++]=o&255}return i}throw new Error("invalid ip address")},hx=function(r,e=0,t){e=~~e,t=t??r.length-e;let n=new DataView(r.buffer);if(t===4){let i=[];for(let o=0;o<t;o++)i.push(r[e+o]);return i.join(".")}if(t===16){let i=[];for(let o=0;o<t;o+=2)i.push(n.getUint16(e+o).toString(16));return i.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};a();var Ss={},od={},lA=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[460,0,"quic"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];lA.forEach(r=>{let e=hA(...r);od[e.code]=e,Ss[e.name]=e});function hA(r,e,t,n,i){return{code:r,size:e,name:t,resolvable:Boolean(n),path:Boolean(i)}}function fe(r){if(typeof r=="number"){if(od[r]!=null)return od[r];throw new Error(`no protocol with code: ${r}`)}else if(typeof r=="string"){if(Ss[r]!=null)return Ss[r];throw new Error(`no protocol with name: ${r}`)}throw new Error(`invalid protocol id type: ${typeof r}`)}V();Ce();ke();yo();Te();var Qt=x(Re(),1);W();ge();Lr();function yx(r,e){switch(fe(r).code){case 4:case 41:return pA(e);case 6:case 273:case 33:case 132:return gx(e).toString();case 53:case 54:case 55:case 56:case 400:case 777:return mA(e);case 421:return EA(e);case 444:return px(e);case 445:return px(e);case 466:return bA(e);default:return A(e,"base16")}}function mx(r,e){switch(fe(r).code){case 4:return dx(e);case 41:return dx(e);case 6:case 273:case 33:case 132:return ad(parseInt(e,10));case 53:case 54:case 55:case 56:case 400:case 777:return yA(e);case 421:return gA(e);case 444:return xA(e);case 445:return vA(e);case 466:return wA(e);default:return N(e,"base16")}}var sd=Object.values(wn).map(r=>r.decoder),dA=function(){let r=sd[0].or(sd[1]);return sd.slice(2).forEach(e=>r=r.or(e)),r}();function dx(r){if(!cn(r))throw new Error("invalid ip address");return id(r)}function pA(r){let e=hx(r,0,r.length);if(e==null)throw new Error("ipBuff is required");if(!cn(e))throw new Error("invalid ip address");return e}function ad(r){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,r),new Uint8Array(e)}function gx(r){return new DataView(r.buffer).getUint16(r.byteOffset)}function yA(r){let e=N(r),t=Uint8Array.from(Qt.default.encode(e.length));return Q([t,e],t.length+e.length)}function mA(r){let e=Qt.default.decode(r);if(r=r.slice(Qt.default.decode.bytes),r.length!==e)throw new Error("inconsistent lengths");return A(r)}function gA(r){let e;r[0]==="Q"||r[0]==="1"?e=re(z.decode(`z${r}`)).bytes:e=E.parse(r).multihash.bytes;let t=Uint8Array.from(Qt.default.encode(e.length));return Q([t,e],t.length+e.length)}function wA(r){let e=dA.decode(r),t=Uint8Array.from(Qt.default.encode(e.length));return Q([t,e],t.length+e.length)}function bA(r){let e=Qt.default.decode(r),t=r.slice(Qt.default.decode.bytes);if(t.length!==e)throw new Error("inconsistent lengths");return"u"+A(t,"base64url")}function EA(r){let e=Qt.default.decode(r),t=r.slice(Qt.default.decode.bytes);if(t.length!==e)throw new Error("inconsistent lengths");return A(t,"base58btc")}function xA(r){let e=r.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==16)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);let t=k.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=ad(n);return Q([t,i],t.length+i.length)}function vA(r){let e=r.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==56)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);let t=k.decode(`b${e[0]}`),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=ad(n);return Q([t,i],t.length+i.length)}function px(r){let e=r.slice(0,r.length-2),t=r.slice(r.length-2),n=A(e,"base32"),i=gx(t);return`${n}:${i}`}var eo=x(Re(),1);Lr();W();function _A(r){let e=[],t=r.split("/").slice(1);if(t.length===1&&t[0]==="")return[];for(let n=0;n<t.length;n++){let i=t[n],o=fe(i);if(o.size===0){e.push([i]);continue}if(n++,n>=t.length)throw bx("invalid address: "+r);if(o.path===!0){e.push([i,hd(t.slice(n).join("/"))]);break}e.push([i,t[n]])}return e}function DA(r){let e=[];return r.map(t=>{let n=Yc(t);return e.push(n.name),t.length>1&&t[1]!=null&&e.push(t[1]),null}),hd(e.join("/"))}function SA(r){return r.map(e=>{Array.isArray(e)||(e=[e]);let t=Yc(e);return e.length>1?[t.code,mx(t.code,e[1])]:[t.code]})}function cd(r){return r.map(e=>{let t=Yc(e);return e[1]!=null?[t.code,yx(t.code,e[1])]:[t.code]})}function ud(r){return Qc(Q(r.map(e=>{let t=Yc(e),n=Uint8Array.from(eo.default.encode(t.code));return e.length>1&&e[1]!=null&&(n=Q([n,e[1]])),n})))}function fd(r,e){return r.size>0?r.size/8:r.size===0?0:eo.default.decode(e)+eo.default.decode.bytes}function Jc(r){let e=[],t=0;for(;t<r.length;){let n=eo.default.decode(r,t),i=eo.default.decode.bytes,o=fe(n),s=fd(o,r.slice(t+i));if(s===0){e.push([n]),t+=i;continue}let c=r.slice(t+i,t+i+s);if(t+=s+i,t>r.length)throw bx("Invalid address Uint8Array: "+A(r,"base16"));e.push([n,c])}return e}function ld(r){let e=Jc(r),t=cd(e);return DA(t)}function AA(r){r=hd(r);let e=_A(r),t=SA(e);return ud(t)}function wx(r){return AA(r)}function Qc(r){let e=TA(r);if(e!=null)throw e;return Uint8Array.from(r)}function TA(r){try{Jc(r)}catch(e){return e}}function hd(r){return"/"+r.trim().split("/").filter(e=>e).join("/")}function bx(r){return new Error("Error parsing address: "+r)}function Yc(r){return fe(r[0])}var dd=x(Re(),1);V();ke();var vx=x(Se(),1);W();Ia();var Ex,IA=Symbol.for("nodejs.util.inspect.custom"),xx=[fe("dns").code,fe("dns4").code,fe("dns6").code,fe("dnsaddr").code],OA=[fe("p2p").code,fe("ipfs").code],BA=new Map,_x=Symbol.for("@multiformats/js-multiaddr/multiaddr");function kA(r){return Boolean(r?.[_x])}var Er=class{constructor(e){if(this[Ex]=!0,e==null&&(e=""),e instanceof Uint8Array)this.bytes=Qc(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=wx(e)}else if(kA(e))this.bytes=Qc(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return this._string==null&&(this._string=ld(this.bytes)),this._string}toJSON(){return this.toString()}toOptions(){let e=this.protoCodes(),t=this.toString().split("/").slice(1),n,i;if(t.length>2)xx.includes(e[0])&&OA.includes(e[1])?(n=fe("tcp").name,i=443):(n=fe(t[2]).name,i=parseInt(t[3]));else if(xx.includes(e[0]))n=fe("tcp").name,i=443;else throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e[0]===41||e[0]===55?6:4,host:t[1],transport:n,port:i}}protos(){return this.protoCodes().map(e=>Object.assign({},fe(e)))}protoCodes(){let e=[],t=this.bytes,n=0;for(;n<t.length;){let i=dd.default.decode(t,n),o=dd.default.decode.bytes,s=fe(i);n+=fd(s,t.slice(n+o))+o,e.push(i)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return this._tuples==null&&(this._tuples=Jc(this.bytes)),this._tuples}stringTuples(){return this._stringTuples==null&&(this._stringTuples=cd(this.tuples())),this._stringTuples}encapsulate(e){return e=new Er(e),new Er(this.toString()+e.toString())}decapsulate(e){let t=e.toString(),n=this.toString(),i=n.lastIndexOf(t);if(i<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new Er(n.slice(0,i))}decapsulateCode(e){let t=this.tuples();for(let n=t.length-1;n>=0;n--)if(t[n][0]===e)return new Er(ud(t.slice(0,n)));return this}getPeerId(){try{let t=this.stringTuples().filter(n=>n[0]===Ss.ipfs.code).pop();if(t?.[1]!=null){let n=t[1];return n[0]==="Q"||n[0]==="1"?A(z.decode(`z${n}`),"base58btc"):A(E.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let e=null;try{e=this.stringTuples().filter(t=>fe(t[0]).path===!0)[0][1],e==null&&(e=null)}catch{e=null}return e}equals(e){return Fo(this.bytes,e.bytes)}async resolve(e){let t=this.protos().find(o=>o.resolvable);if(t==null)return[this];let n=BA.get(t.name);if(n==null)throw(0,vx.default)(new Error(`no available resolver for ${t.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map(o=>new Er(o))}nodeAddress(){let e=this.toOptions();if(e.transport!=="tcp"&&e.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){let t=(e??this).protos();return!(t.length!==2||t[0].code!==4&&t[0].code!==41||t[1].code!==6&&t[1].code!==273)}[(Ex=_x,IA)](){return this.inspect()}inspect(){return"<Multiaddr "+A(this.bytes,"base16")+" - "+ld(this.bytes)+">"}};function pd(r){return new Er(r)}var LA=T("dns4"),RA=T("dns6"),NA=T("dnsaddr"),to=_e(T("dns"),NA,LA,RA),Xc=_e(T("ip4"),T("ip6")),Os=_e(B(Xc,T("tcp")),B(to,T("tcp"))),Sx=B(Xc,T("udp")),PA=B(Sx,T("utp")),FA=B(Sx,T("quic")),Ts=_e(B(Os,T("ws")),B(to,T("ws"))),Cs=_e(B(Os,T("wss")),B(to,T("wss"))),yd=_e(B(Os,T("http")),B(Xc,T("http")),B(to,T("http"))),md=_e(B(Os,T("https")),B(Xc,T("https")),B(to,T("https"))),Ax=_e(B(Ts,T("p2p-webrtc-star"),T("p2p")),B(Cs,T("p2p-webrtc-star"),T("p2p")),B(Ts,T("p2p-webrtc-star")),B(Cs,T("p2p-webrtc-star"))),N$=_e(B(Ts,T("p2p-websocket-star"),T("p2p")),B(Cs,T("p2p-websocket-star"),T("p2p")),B(Ts,T("p2p-websocket-star")),B(Cs,T("p2p-websocket-star"))),Tx=_e(B(yd,T("p2p-webrtc-direct"),T("p2p")),B(md,T("p2p-webrtc-direct"),T("p2p")),B(yd,T("p2p-webrtc-direct")),B(md,T("p2p-webrtc-direct"))),Is=_e(Ts,Cs,yd,md,Ax,Tx,Os,PA,FA,to),P$=_e(B(Is,T("p2p-stardust"),T("p2p")),B(Is,T("p2p-stardust"))),fn=_e(B(Is,T("p2p")),Ax,Tx,T("p2p")),Dx=_e(B(fn,T("p2p-circuit"),fn),B(fn,T("p2p-circuit")),B(T("p2p-circuit"),fn),B(Is,T("p2p-circuit")),B(T("p2p-circuit"),Is),T("p2p-circuit")),Cx=()=>_e(B(Dx,Cx),Dx),As=Cx(),UA=_e(B(As,fn,As),B(fn,As),B(As,fn),As,fn);function Ix(r){function e(t){let n;try{n=pd(t)}catch{return!1}let i=r(n.protoNames());return i===null?!1:i===!0||i===!1?i:i.length===0}return e}function B(...r){function e(t){if(t.length<r.length)return null;let n=t;return r.some(i=>(n=typeof i=="function"?i().partialMatch(t):i.partialMatch(t),Array.isArray(n)&&(t=n),n===null)),n}return{toString:function(){return"{ "+r.join(" ")+" }"},input:r,matches:Ix(e),partialMatch:e}}function _e(...r){function e(n){let i=null;return r.some(o=>{let s=typeof o=="function"?o().partialMatch(n):o.partialMatch(n);return s!=null?(i=s,!0):!1}),i}return{toString:function(){return"{ "+r.join(" ")+" }"},input:r,matches:Ix(e),partialMatch:e}}function T(r){let e=r;function t(i){let o;try{o=pd(i)}catch{return!1}let s=o.protoNames();return s.length===1&&s[0]===e}function n(i){return i.length===0?null:i[0]===e?i.slice(1):null}return{toString:function(){return e},matches:t,partialMatch:n}}V();var JA=x(Px(),1);W();V();a();W();ge();var xr="/",Fx=new TextEncoder().encode(xr),Zc=Fx[0],De=class{constructor(e,t){if(typeof e=="string")this._buf=N(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==Zc)throw new Error("Invalid key")}toString(e="utf8"){return A(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new De(e.join(xr))}static random(){return new De(nt().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new De(e):typeof e.uint8Array=="function"?new De(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=Fx),this._buf[0]!==Zc){let e=new Uint8Array(this._buf.byteLength+1);e.fill(Zc,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===Zc;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),n=e.list();for(let i=0;i<t.length;i++){if(n.length<i+1)return!1;let o=t[i],s=n[i];if(o<s)return!0;if(o>s)return!1}return t.length<n.length}reverse(){return De.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(xr).slice(1)}type(){return YA(this.baseNamespace())}name(){return XA(this.baseNamespace())}instance(e){return new De(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(xr)||(e+=xr),e+=this.type(),new De(e)}parent(){let e=this.list();return e.length===1?new De(xr):new De(e.slice(0,-1).join(xr))}child(e){return this.toString()===xr?e:e.toString()===xr?this:new De(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return De.withNamespaces([...this.namespaces(),...ZA(e.map(t=>t.namespaces()))])}};function YA(r){let e=r.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function XA(r){let e=r.split(":");return e[e.length-1]}function ZA(r){return[].concat(...r)}var Ed=x(Se(),1);a();V();var bd=x(Se(),1),Ux="/ipfs/";function eu(r){if(r instanceof Uint8Array)try{r=E.decode(r)}catch(i){throw(0,bd.default)(i,"ERR_INVALID_CID")}let e=E.asCID(r);if(e)return{cid:e,path:void 0};r=r.toString(),r.startsWith(Ux)&&(r=r.substring(Ux.length));let t=r.split("/"),n;try{e=E.parse(t.shift()||"")}catch(i){throw(0,bd.default)(i,"ERR_INVALID_CID")}return t.length&&(n=`/${t.join("/")}`),{cid:e,path:n}}var fM=new De("/local/filesroot");var $x=async function(r,e,t,n={}){let{cid:i,path:o}=eu(t);o&&(n.path=o);let s=i,c=n.path||"";if(c.startsWith("/")&&(c=c.substring(1)),n.path)try{for await(let{value:u,remainderPath:f}of tu(i,n.path,e,r,{signal:n.signal})){if(!E.asCID(u))break;c=f,s=u}}catch(u){throw u.message.startsWith("Object has no property")&&(u.message=`no link named "${c.split("/")[0]}" under ${s}`,u.code="ERR_NO_LINK"),u}return{cid:s,remainderPath:c||""}};var lM=dt(async(r,e)=>await r),tu=async function*(r,e,t,n,i){let o=async f=>{let l=await t.getCodec(f.code),h=await n.blocks.get(f,i);return l.decode(h)},s=e.split("/").filter(Boolean),c=await o(r),u=r;for(;s.length;){let f=s.shift();if(!f)throw(0,Ed.default)(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(r.code===wt&&Array.isArray(c.Links)){let l=c.Links.find(h=>h.Name===f);if(l){yield{value:l.Hash,remainderPath:s.join("/")},c=await o(l.Hash),u=l.Hash;continue}}if(Object.prototype.hasOwnProperty.call(c,f))c=c[f],yield{value:c,remainderPath:s.join("/")};else throw(0,Ed.default)(new Error(`no link named "${f}" under ${u}`),"ERR_NO_LINK");E.asCID(c)&&(u=c,c=await o(c))}yield{value:c,remainderPath:""}};var zx=x(Se(),1);function qx({codecs:r,repo:e,preload:t}){return dt(async function(o,s={}){if(s.preload!==!1&&t(o),s.path){let h=s.localResolve?await(0,Mx.default)(tu(o,s.path,r,e,s)):await(0,jx.default)(tu(o,s.path,r,e,s));if(!h)throw(0,zx.default)(new Error("Not found"),"ERR_NOT_FOUND");return h}let c=await r.getCodec(o.code),u=await e.blocks.get(o,s);return{value:c.decode(u),remainderPath:""}})}a();a();var ru=class{constructor(e,t,n){this._version=e,this._roots=t,this._iterable=n,this._decoded=!1}get version(){return this._version}async getRoots(){return this._roots}},ln=class extends ru{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");return this._decoded=!0,this._iterable[Symbol.asyncIterator]()}static async fromBytes(e){let{version:t,roots:n,iterator:i}=await Vx(e);return new ln(t,n,i)}static async fromIterable(e){let{version:t,roots:n,iterator:i}=await Kx(e);return new ln(t,n,i)}},ro=class extends ru{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");this._decoded=!0;let e=this._iterable[Symbol.asyncIterator]();return{async next(){let t=await e.next();return t.done?t:{done:!1,value:t.value.cid}}}}static async fromBytes(e){let{version:t,roots:n,iterator:i}=await Vx(e);return new ro(t,n,i)}static async fromIterable(e){let{version:t,roots:n,iterator:i}=await Kx(e);return new ro(t,n,i)}};async function Vx(r){if(!(r instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return Wx(on(r))}async function Kx(r){if(!r||typeof r[Symbol.asyncIterator]!="function")throw new TypeError("fromIterable() requires an async iterable");return Wx(Xi(r))}async function Wx(r){let e=Yi(r),{version:t,roots:n}=await e.header();return{version:t,roots:n,iterator:e.blocks()}}var Jx=x(Gx(),1),Qx=x(Bn(),1),Yx=x(Ri(),1);var Xx=Mc("ipfs:components:dag:import");function Zx({repo:r}){async function*e(t,n={}){let i=await r.gcLock.readLock();try{let o={signal:n.signal,timeout:n.timeout},s=(0,Jx.default)(t),{value:c,done:u}=await s.peek();if(u)return;c&&s.push(c);let f;c instanceof Uint8Array?f=[s]:f=s;for await(let l of f){let h=await tT(r,o,l);if(n.pinRoots!==!1)for(let d of h){let w="";try{await r.blocks.has(d)?(Xx(`Pinning root ${d}`),await r.pins.pinRecursively(d)):w="blockstore: block not found"}catch(g){w=g.message}yield{root:{cid:d,pinErrorMsg:w}}}}}finally{i()}}return dt(e)}async function tT(r,e,t){let n=await ln.fromIterable(t),i=await n.getRoots();return await(0,Qx.default)(r.blocks.putMany((0,Yx.default)(n,({cid:o,bytes:s})=>(Xx(`Import block ${o}`),{key:o,value:s})),{signal:e.signal})),i}a();V();function e1({repo:r,codecs:e,hashers:t,preload:n}){async function i(o,s={}){let c=s.pin?await r.gcLock.readLock():null;try{let u=await e.getCodec(s.storeCodec||"dag-cbor");if(!u)throw new Error(`Unknown storeCodec ${s.storeCodec}, please configure additional BlockCodecs for this IPFS instance`);if(s.inputCodec){if(!(o instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");let g=await e.getCodec(s.inputCodec);if(!g)throw new Error(`Unknown inputCodec ${s.inputCodec}, please configure additional BlockCodecs for this IPFS instance`);o=g.decode(o)}let f=s.version!=null?s.version:1,l=await t.getHasher(s.hashAlg||"sha2-256");if(!l)throw new Error(`Unknown hash algorithm ${s.hashAlg}, please configure additional MultihashHashers for this IPFS instance`);let h=u.encode(o),d=await l.digest(h),w=E.create(f,u.code,d);return await r.blocks.put(w,h,{signal:s.signal}),s.pin&&await r.pins.pinRecursively(w),s.preload!==!1&&n(w),w}finally{c&&c()}}return dt(i)}a();function t1({repo:r,codecs:e,preload:t}){async function n(i,o={}){let{cid:s}=eu(i);return o.preload!==!1&&t(s),$x(r,e,i,o)}return dt(n)}var nu=class{constructor({repo:e,codecs:t,hashers:n,preload:i}){this.export=KE({repo:e,preload:i,codecs:t}),this.get=qx({codecs:t,repo:e,preload:i}),this.import=Zx({repo:e}),this.resolve=t1({repo:e,codecs:t,preload:i}),this.put=e1({repo:e,codecs:t,hashers:n,preload:i})}};Ar();fi();Hs();yo();var xd={};H(xd,{code:()=>uT,decode:()=>dT,encode:()=>hT,name:()=>cT,toGeneral:()=>f1});a();a();a();po();function kt(r){return Ws.encode(r).slice(1)}function pt(r){return Ws.decode(`u${r}`)}V();function r1(r){let[e,t,n]=r;return{payload:t,signatures:[{protected:e,signature:n}],link:E.decode(pt(t))}}function rT(r){let e={signature:pt(r.signature)};return r.header&&(e.header=r.header),r.protected&&(e.protected=pt(r.protected)),e}function n1(r){let e=pt(r.payload);try{E.decode(e)}catch{throw new Error("Not a valid DagJWS")}return{payload:e,signatures:r.signatures.map(rT)}}function nT(r){let e={signature:kt(r.signature)};return r.header&&(e.header=r.header),r.protected&&(e.protected=kt(r.protected)),e}function i1(r){let e={payload:kt(r.payload),signatures:r.signatures.map(nT)};return e.link=E.decode(new Uint8Array(r.payload)),e}a();function o1(r){let[e,t,n,i,o]=r,s={ciphertext:i,iv:n,protected:e,tag:o};return t&&(s.recipients=[{encrypted_key:t}]),s}function oT(r){let e={};return r.encrypted_key&&(e.encrypted_key=pt(r.encrypted_key)),r.header&&(e.header=r.header),e}function s1(r){let e={ciphertext:pt(r.ciphertext),protected:pt(r.protected),iv:pt(r.iv),tag:pt(r.tag)};return r.aad&&(e.aad=pt(r.aad)),r.recipients&&(e.recipients=r.recipients.map(oT)),r.unprotected&&(e.unprotected=r.unprotected),e}function sT(r){let e={};return r.encrypted_key&&(e.encrypted_key=kt(r.encrypted_key)),r.header&&(e.header=r.header),e}function a1(r){let e={ciphertext:kt(r.ciphertext),protected:kt(r.protected),iv:kt(r.iv),tag:kt(r.tag)};return r.aad&&(e.aad=kt(r.aad)),r.recipients&&(e.recipients=r.recipients.map(sT)),r.unprotected&&(e.unprotected=r.unprotected),e}var cT="dag-jose",uT=133;function c1(r){return"payload"in r&&typeof r.payload=="string"&&"signatures"in r&&Array.isArray(r.signatures)}function fT(r){return"payload"in r&&r.payload instanceof Uint8Array&&"signatures"in r&&Array.isArray(r.signatures)}function lT(r){return"ciphertext"in r&&r.ciphertext instanceof Uint8Array&&"iv"in r&&r.iv instanceof Uint8Array&&"protected"in r&&r.protected instanceof Uint8Array&&"tag"in r&&r.tag instanceof Uint8Array}function u1(r){return"ciphertext"in r&&typeof r.ciphertext=="string"&&"iv"in r&&typeof r.iv=="string"&&"protected"in r&&typeof r.protected=="string"&&"tag"in r&&typeof r.tag=="string"}function f1(r){if(typeof r=="string"){let e=r.split(".");if(e.length===3)return r1(e);if(e.length===5)return o1(e);throw new Error("Not a valid JOSE string")}if(c1(r)||u1(r))return r;throw new Error("Not a valid unencoded JOSE object")}function hT(r){typeof r=="string"&&(r=f1(r));let e;if(c1(r))e=n1(r);else if(u1(r))e=s1(r);else throw new Error("Not a valid JOSE object");return new Uint8Array(Yn(e))}function dT(r){let e;try{e=vs(r)}catch{throw new Error("Not a valid DAG-JOSE object")}if(fT(e))return i1(e);if(lT(e))return a1(e);throw new Error("Not a valid DAG-JOSE object")}a();var pT=r=>Promise.reject(new Error(`No codec found for "${r}"`)),iu=class{constructor(e){this._codecsByName={},this._codecsByCode={},this._loadCodec=e.loadCodec||pT;for(let t of e.codecs)this.addCodec(t)}addCodec(e){if(this._codecsByName[e.name]||this._codecsByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._codecsByName[e.name]=e,this._codecsByCode[e.code]=e}removeCodec(e){delete this._codecsByName[e.name],delete this._codecsByCode[e.code]}async getCodec(e){let t=typeof e=="string"?this._codecsByName:this._codecsByCode;if(t[e])return t[e];let n=await this._loadCodec(e);return t[e]==null&&this.addCodec(n),n}listCodecs(){return Object.values(this._codecsByName)}};a();var yT=r=>Promise.reject(new Error(`No hasher found for "${r}"`)),ou=class{constructor(e){this._hashersByName={},this._hashersByCode={},this._loadHasher=e.loadHasher||yT;for(let t of e.hashers)this.addHasher(t)}addHasher(e){if(this._hashersByName[e.name]||this._hashersByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._hashersByName[e.name]=e,this._hashersByCode[e.code]=e}removeHasher(e){delete this._hashersByName[e.name],delete this._hashersByCode[e.code]}async getHasher(e){let t=typeof e=="string"?this._hashersByName:this._hashersByCode;if(t[e])return t[e];let n=await this._loadHasher(e);return t[e]==null&&this.addHasher(n),n}listHashers(){return Object.values(this._hashersByName)}};a();async function*l1(r){let e=0;for(;e<r.length;)yield r[e++]}var w1=x(Zo(),1);a();function su(r){return{all:r=r||new Map,on:function(e,t){var n=r.get(e);n?n.push(t):r.set(e,[t])},off:function(e,t){var n=r.get(e);n&&(t?n.splice(n.indexOf(t)>>>0,1):r.set(e,[]))},emit:function(e,t){var n=r.get(e);n&&n.slice().map(function(i){i(t)}),(n=r.get("*"))&&n.slice().map(function(i){i(e,t)})}}}hi();a();a();var ks=x(Re(),1);a();var mT=of(),gT={float64:!1,quickEncodeToken:ca};function vd(r,e=mT,t=gT){if(Array.isArray(r)){let n=0;for(let i of r)n+=vd(i,e,t);return n}else{let n=e[r.type.major];if(n.encodedSize===void 0||typeof n.encodedSize!="function")throw new Error(`Encoder for ${r.type.name} does not have an encodedSize()`);return n.encodedSize(r,t)}}var Dd=class{constructor(e,t){this.bytes=e,this.byteOffset=t,this.roots=[],this.headerSize=t}addRoot(e,t){return wT(this,e,t),this}write(e){return bT(this,e),this}close(e){return ET(this,e)}},wT=(r,e,t={})=>{let{resize:n=!1}=t,{bytes:i,headerSize:o,byteOffset:s,roots:c}=r;r.roots.push(e);let u=Ls(r);if(u>o)if(u-o+s<i.byteLength)if(n)d1(r,u);else throw c.pop(),new RangeError(`Header of size ${o} has no capacity for new root ${e}.
  However there is a space in the buffer and you could call addRoot(root, { resize: root }) to resize header to make a space for this root.`);else throw c.pop(),new RangeError(`Buffer has no capacity for a new root ${e}`)},Sd=({cid:r,bytes:e})=>{let t=r.bytes.byteLength+e.byteLength;return ks.default.encodingLength(t)+t},bT=(r,{cid:e,bytes:t})=>{let n=e.bytes.byteLength+t.byteLength,i=ks.default.encode(n);if(r.byteOffset+i.length+n>r.bytes.byteLength)throw new RangeError("Buffer has no capacity for this block");_d(r,i),_d(r,e.bytes),_d(r,t)},ET=(r,e={})=>{let{resize:t=!1}=e,{roots:n,bytes:i,byteOffset:o,headerSize:s}=r,c=Yn({version:1,roots:n}),u=ks.default.encode(c.length),f=u.length+c.byteLength;if(s-f===0)return h1(r,u,c),i.subarray(0,o);if(t)return d1(r,f),h1(r,u,c),i.subarray(0,r.byteOffset);throw new RangeError(`Header size was overestimated.
You can use close({ resize: true }) to resize header`)},d1=(r,e)=>{let{bytes:t,headerSize:n}=r;t.set(t.subarray(n,r.byteOffset),e),r.byteOffset+=e-n,r.headerSize=e},_d=(r,e)=>{r.bytes.set(e,r.byteOffset),r.byteOffset+=e.length},h1=({bytes:r},e,t)=>{r.set(e),r.set(t,e.length)},xT=[new v(p.map,2),new v(p.string,"version"),new v(p.uint,1),new v(p.string,"roots")],vT=new v(p.tag,42),_T=r=>{let e=[...xT];e.push(new v(p.array,r.length));for(let n of r)e.push(vT),e.push(new v(p.bytes,{length:n+1}));let t=vd(e);return ks.default.encodingLength(t)+t},Ls=({roots:r})=>_T(r.map(e=>e.bytes.byteLength));var p1=(r,e={})=>{let{roots:t=[],byteOffset:n=0,byteLength:i=r.byteLength,headerSize:o=Ls({roots:t})}=e,s=new Uint8Array(r,n,i),c=new Dd(s,o);for(let u of t)c.addRoot(u);return c};a();a();var no=class{constructor(e,t){this._header=e,this._blocks=t,this._keys=t.map(n=>n.cid.toString())}get version(){return this._header.version}async getRoots(){return this._header.roots}async has(e){return this._keys.indexOf(e.toString())>-1}async get(e){let t=this._keys.indexOf(e.toString());return t>-1?this._blocks[t]:void 0}async*blocks(){for(let e of this._blocks)yield e}async*cids(){for(let e of this._blocks)yield e.cid}static async fromBytes(e){if(!(e instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return y1(on(e))}static async fromIterable(e){if(!e||typeof e[Symbol.asyncIterator]!="function")throw new TypeError("fromIterable() requires an async iterable");return y1(Xi(e))}};async function y1(r){let e=Yi(r),t=await e.header(),n=[];for await(let i of e.blocks())n.push(i);return new no(t,n)}a();var au=class{constructor(e,t,n){this._version=e,this._roots=t,this._iterator=n}get version(){return this._version}async getRoots(){return this._roots}[Symbol.asyncIterator](){return this._iterator}static async fromBytes(e){if(!(e instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return m1(on(e))}static async fromIterable(e){if(!e||typeof e[Symbol.asyncIterator]!="function")throw new TypeError("fromIterable() requires an async iterable");return m1(Xi(e))}};async function m1(r){let e=Yi(r),{version:t,roots:n}=await e.header();return new au(t,n,e.blocksIndex())}a();hi();Te();Ar();fi();var{isBinary:ST}=mn,AT=r=>ST(r)?ml({value:r,hasher:Ft,codec:gt}):ml({value:r,hasher:Ft,codec:tn}),g1=({bytes:r,cid:e})=>{let t,n,{code:i}=e,o=e.multihash.code||re(e.multihash).code;if(o===18)t=Ft;else throw new Error("Unsupported hash function: "+o);if(i===113)n=tn;else if(i===85)n=gt;else throw new Error("Unsupported codec: "+i);return sb({bytes:r,cid:e,codec:n,hasher:t})},io=class{constructor(){Object.assign(this,su()),this.blocks=[]}static create(){return new this}static async load(e){let t=await no.fromBytes(e),[n]=await t.getRoots();return{root:n,get:o=>t.get(o).then(s=>g1(s)).then(({value:s})=>s)}}async add(e){let t=await AT(e);return this.last=t,this.blocks.push(t),this.emit("size",this.size),t.cid}async get(e){let{cid:t,bytes:n,value:i}=await g1(e);return{cid:t,bytes:n,value:i}}undo(){return this.blocks.pop()}async commit(){let e=this.last.cid,t=0,n=Ls({roots:[e]});t+=n;for(let s of this.blocks)t+=Sd(s);let i=new Uint8Array(t),o=await p1(i,{headerSize:n});o.addRoot(e);for(let s of this.blocks)o.write(s);return await o.close(),o.bytes}get size(){if(!this?.last)return 0;let e=this.last.cid,t=0;t+=Ls({roots:[e]});for(let i of this.blocks)t+=Sd(i);return t}};var Ad=class extends nu{constructor({repo:e,codecs:t,options:n}){let i=Object.values(Cp);(n.ipld&&n.ipld.hashers?n.ipld.hashers:[]).forEach(s=>i.push(s));let o=new ou({hashers:i,loadHasher:n.ipld&&n.ipld.loadHasher});super({repo:e,codecs:t,hashers:o,preload:s=>{}}),Object.assign(this,su()),this.repo=e,this.rootCID,this.tx={pending:io.create(),checkSize:async s=>{let c=io.create();return await c.add(s),c.size},getExistingTx:async()=>{let s={};try{let c=this.tx.pending.last;if(!c)return;s=(await this.tx.pending.get(c)).value}catch{}return s},addData:async s=>await this.tx.pending.add(s),addTag:async(s,c)=>await this.tx.add(s,c),add:async(s,c)=>{if(!c)return;c=Object.fromEntries(Object.entries(c).map(([w,g])=>g===void 0?[w,null]:[w,g]));let u=!1,f=await this.tx.getExistingTx();if(f&&f[s])u=f[s]?f[s]:!1;else if(this.rootCID)try{let w=(await this.get(this.rootCID)).value;u=w[s]?w[s]:!1}catch{}let l=await this.tx.pending.add(c),h=Object.assign({},f,{[s]:{obj:l,prev:u}}),d=await this.tx.pending.add(h);return this.emit("added",d),d},commit:async()=>{let s=await this.tx.getExistingTx(),c={};try{this.rootCID&&(c=(await this.get(this.rootCID)).value)}catch(l){console.log({error:l})}let u=Object.assign({},c,Object.fromEntries(Object.entries(s).filter(([l,h])=>h.obj&&h.hasOwnProperty("prev"))));this.rootCID=await this.tx.pending.add(u);let f=await this.tx.pending.commit();return await this.importBuffer(f),this.tx.pending=io.create(),f}}}async latest(e){return(await this.get(this.rootCID,{path:`/${e}/obj`})).value}async importBuffers(e){let t;for(let n of e)t=await this.importBuffer(n);return t}async importBuffer(e){return b1(this,e)}};async function b1(r,e){let t=await l1([e]),[{root:n}]=await(0,w1.default)(r.import(t));return n.cid}async function TT(r={}){let e={name:li.name,code:li.code,encode:u=>u,decode:u=>u},t=Object.values(Ip);[tn,xd,e].concat(r.ipld&&r.ipld.codecs||[]).forEach(u=>t.push(u));let n=new iu({codecs:t,loadCodec:r.ipld&&r.ipld.loadCodec}),i=r.path||"ipfs",o=vE(console.log,n,{path:i,autoMigrate:!0}),s={};try{await o.init(s),await o.open()}catch(u){throw u}let c=await o.config.getAll();return new Ad({repo:o,codecs:n,options:{...r,repoConfig:c}})}export{TT as createDagRepo,b1 as importBuffer};
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! run-parallel-limit. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
//# sourceMappingURL=repo.js.map
